/*!
 * ONNX Runtime Web v1.17.0
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */
"use strict";var ort=(()=>{var ft=Object.defineProperty;var Cn=Object.getOwnPropertyDescriptor;var Bn=Object.getOwnPropertyNames;var Dn=Object.prototype.hasOwnProperty;var R=(n,i)=>()=>(n&&(i=n(n=0)),i);var Un=(n,i)=>()=>(i||n((i={exports:{}}).exports,i),i.exports),Ge=(n,i)=>{for(var r in i)ft(n,r,{get:i[r],enumerable:!0})},Rn=(n,i,r,u)=>{if(i&&typeof i=="object"||typeof i=="function")for(let s of Bn(i))!Dn.call(n,s)&&s!==r&&ft(n,s,{get:()=>i[s],enumerable:!(u=Cn(i,s))||u.enumerable});return n};var Ye=n=>Rn(ft({},"__esModule",{value:!0}),n);var Ve,ge,we,Kt,ct=R(()=>{"use strict";Ve=new Map,ge=[],we=(n,i,r)=>{if(i&&typeof i.init=="function"&&typeof i.createInferenceSessionHandler=="function"){let u=Ve.get(n);if(u===void 0)Ve.set(n,{backend:i,priority:r});else{if(u.priority>r)return;if(u.priority===r&&u.backend!==i)throw new Error(`cannot register backend "${n}" using priority ${r}`)}if(r>=0){let s=ge.indexOf(n);s!==-1&&ge.splice(s,1);for(let h=0;h<ge.length;h++)if(Ve.get(ge[h]).priority<=r){ge.splice(h,0,n);return}ge.push(n)}return}throw new TypeError("not a valid backend")},Kt=async n=>{let i=n.length===0?ge:n,r=[];for(let u of i){let s=Ve.get(u);if(s){if(s.initialized)return s.backend;if(s.aborted)continue;let h=!!s.initPromise;try{return h||(s.initPromise=s.backend.init()),await s.initPromise,s.initialized=!0,s.backend}catch(c){h||r.push({name:u,err:c}),s.aborted=!0}finally{delete s.initPromise}}}throw new Error(`no available backend found. ERR: ${r.map(u=>`[${u.name}] ${u.err}`).join(", ")}`)}});var Qt=R(()=>{"use strict";ct()});var er,tr=R(()=>{"use strict";er="1.17.0"});var rr,lt,nr=R(()=>{"use strict";tr();rr="warning",lt={wasm:{},webgl:{},webgpu:{},versions:{common:er},set logLevel(n){if(n!==void 0){if(typeof n!="string"||["verbose","info","warning","error","fatal"].indexOf(n)===-1)throw new Error(`Unsupported logging level: ${n}`);rr=n}},get logLevel(){return rr}};Object.defineProperty(lt,"logLevel",{enumerable:!0})});var $,or=R(()=>{"use strict";nr();$=lt});var ir,ar,sr=R(()=>{"use strict";ir=(n,i)=>{let r=document.createElement("canvas");r.width=n.dims[3],r.height=n.dims[2];let u=r.getContext("2d");if(u!=null){let s,h;i?.tensorLayout!==void 0&&i.tensorLayout==="NHWC"?(s=n.dims[2],h=n.dims[3]):(s=n.dims[3],h=n.dims[2]);let c=i?.format!==void 0?i.format:"RGB",p=i?.norm,m,d;p===void 0||p.mean===void 0?m=[255,255,255,255]:typeof p.mean=="number"?m=[p.mean,p.mean,p.mean,p.mean]:(m=[p.mean[0],p.mean[1],p.mean[2],0],p.mean[3]!==void 0&&(m[3]=p.mean[3])),p===void 0||p.bias===void 0?d=[0,0,0,0]:typeof p.bias=="number"?d=[p.bias,p.bias,p.bias,p.bias]:(d=[p.bias[0],p.bias[1],p.bias[2],0],p.bias[3]!==void 0&&(d[3]=p.bias[3]));let y=h*s,b=0,w=y,S=y*2,x=-1;c==="RGBA"?(b=0,w=y,S=y*2,x=y*3):c==="RGB"?(b=0,w=y,S=y*2):c==="RBG"&&(b=0,S=y,w=y*2);for(let O=0;O<h;O++)for(let _=0;_<s;_++){let M=(n.data[b++]-d[0])*m[0],L=(n.data[w++]-d[1])*m[1],X=(n.data[S++]-d[2])*m[2],V=x===-1?255:(n.data[x++]-d[3])*m[3];u.fillStyle="rgba("+M+","+L+","+X+","+V+")",u.fillRect(_,O,1,1)}return r.toDataURL()}else throw new Error("Can not access image data")},ar=(n,i)=>{let r=document.createElement("canvas").getContext("2d"),u;if(r!=null){let s,h,c;i?.tensorLayout!==void 0&&i.tensorLayout==="NHWC"?(s=n.dims[2],h=n.dims[1],c=n.dims[3]):(s=n.dims[3],h=n.dims[2],c=n.dims[1]);let p=i!==void 0&&i.format!==void 0?i.format:"RGB",m=i?.norm,d,y;m===void 0||m.mean===void 0?d=[255,255,255,255]:typeof m.mean=="number"?d=[m.mean,m.mean,m.mean,m.mean]:(d=[m.mean[0],m.mean[1],m.mean[2],255],m.mean[3]!==void 0&&(d[3]=m.mean[3])),m===void 0||m.bias===void 0?y=[0,0,0,0]:typeof m.bias=="number"?y=[m.bias,m.bias,m.bias,m.bias]:(y=[m.bias[0],m.bias[1],m.bias[2],0],m.bias[3]!==void 0&&(y[3]=m.bias[3]));let b=h*s;if(i!==void 0&&(i.format!==void 0&&c===4&&i.format!=="RGBA"||c===3&&i.format!=="RGB"&&i.format!=="BGR"))throw new Error("Tensor format doesn't match input tensor dims");let w=4,S=0,x=1,O=2,_=3,M=0,L=b,X=b*2,V=-1;p==="RGBA"?(M=0,L=b,X=b*2,V=b*3):p==="RGB"?(M=0,L=b,X=b*2):p==="RBG"&&(M=0,X=b,L=b*2),u=r.createImageData(s,h);for(let A=0;A<h*s;S+=w,x+=w,O+=w,_+=w,A++)u.data[S]=(n.data[M++]-y[0])*d[0],u.data[x]=(n.data[L++]-y[1])*d[1],u.data[O]=(n.data[X++]-y[2])*d[2],u.data[_]=V===-1?255:(n.data[V++]-y[3])*d[3]}else throw new Error("Can not access image data");return u}});var dt,ur,fr,cr,lr,dr=R(()=>{"use strict";qe();dt=(n,i)=>{if(n===void 0)throw new Error("Image buffer must be defined");if(i.height===void 0||i.width===void 0)throw new Error("Image height and width must be defined");if(i.tensorLayout==="NHWC")throw new Error("NHWC Tensor layout is not supported yet");let{height:r,width:u}=i,s=i.norm??{mean:255,bias:0},h,c;typeof s.mean=="number"?h=[s.mean,s.mean,s.mean,s.mean]:h=[s.mean[0],s.mean[1],s.mean[2],s.mean[3]??255],typeof s.bias=="number"?c=[s.bias,s.bias,s.bias,s.bias]:c=[s.bias[0],s.bias[1],s.bias[2],s.bias[3]??0];let p=i.format!==void 0?i.format:"RGBA",m=i.tensorFormat!==void 0&&i.tensorFormat!==void 0?i.tensorFormat:"RGB",d=r*u,y=m==="RGBA"?new Float32Array(d*4):new Float32Array(d*3),b=4,w=0,S=1,x=2,O=3,_=0,M=d,L=d*2,X=-1;p==="RGB"&&(b=3,w=0,S=1,x=2,O=-1),m==="RGBA"?X=d*3:m==="RBG"?(_=0,L=d,M=d*2):m==="BGR"&&(L=0,M=d,_=d*2);for(let A=0;A<d;A++,w+=b,x+=b,S+=b,O+=b)y[_++]=(n[w]+c[0])/h[0],y[M++]=(n[S]+c[1])/h[1],y[L++]=(n[x]+c[2])/h[2],X!==-1&&O!==-1&&(y[X++]=(n[O]+c[3])/h[3]);return m==="RGBA"?new Y("float32",y,[1,4,r,u]):new Y("float32",y,[1,3,r,u])},ur=async(n,i)=>{let r=typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement,u=typeof ImageData<"u"&&n instanceof ImageData,s=typeof ImageBitmap<"u"&&n instanceof ImageBitmap,h=typeof n=="string",c,p=i??{};if(r){let m=document.createElement("canvas");m.width=n.width,m.height=n.height;let d=m.getContext("2d");if(d!=null){let y=n.height,b=n.width;if(i!==void 0&&i.resizedHeight!==void 0&&i.resizedWidth!==void 0&&(y=i.resizedHeight,b=i.resizedWidth),i!==void 0){if(p=i,i.tensorFormat!==void 0)throw new Error("Image input config format must be RGBA for HTMLImageElement");p.tensorFormat="RGBA",p.height=y,p.width=b}else p.tensorFormat="RGBA",p.height=y,p.width=b;d.drawImage(n,0,0),c=d.getImageData(0,0,b,y).data}else throw new Error("Can not access image data")}else if(u){let m,d;if(i!==void 0&&i.resizedWidth!==void 0&&i.resizedHeight!==void 0?(m=i.resizedHeight,d=i.resizedWidth):(m=n.height,d=n.width),i!==void 0&&(p=i),p.format="RGBA",p.height=m,p.width=d,i!==void 0){let y=document.createElement("canvas");y.width=d,y.height=m;let b=y.getContext("2d");if(b!=null)b.putImageData(n,0,0),c=b.getImageData(0,0,d,m).data;else throw new Error("Can not access image data")}else c=n.data}else if(s){if(i===void 0)throw new Error("Please provide image config with format for Imagebitmap");let m=document.createElement("canvas");m.width=n.width,m.height=n.height;let d=m.getContext("2d");if(d!=null){let y=n.height,b=n.width;return d.drawImage(n,0,0,b,y),c=d.getImageData(0,0,b,y).data,p.height=y,p.width=b,dt(c,p)}else throw new Error("Can not access image data")}else{if(h)return new Promise((m,d)=>{let y=document.createElement("canvas"),b=y.getContext("2d");if(!n||!b)return d();let w=new Image;w.crossOrigin="Anonymous",w.src=n,w.onload=()=>{y.width=w.width,y.height=w.height,b.drawImage(w,0,0,y.width,y.height);let S=b.getImageData(0,0,y.width,y.height);p.height=y.height,p.width=y.width,m(dt(S.data,p))}});throw new Error("Input data provided is not supported - aborted tensor creation")}if(c!==void 0)return dt(c,p);throw new Error("Input data provided is not supported - aborted tensor creation")},fr=(n,i)=>{let{width:r,height:u,download:s,dispose:h}=i,c=[1,u,r,4];return new Y({location:"texture",type:"float32",texture:n,dims:c,download:s,dispose:h})},cr=(n,i)=>{let{dataType:r,dims:u,download:s,dispose:h}=i;return new Y({location:"gpu-buffer",type:r??"float32",gpuBuffer:n,dims:u,download:s,dispose:h})},lr=(n,i,r)=>new Y({location:"cpu-pinned",type:n,data:i,dims:r??[i.length]})});var De,Xe,pr,mr,hr=R(()=>{"use strict";De=new Map([["float32",Float32Array],["uint8",Uint8Array],["int8",Int8Array],["uint16",Uint16Array],["float16",Uint16Array],["int16",Int16Array],["int32",Int32Array],["bool",Uint8Array],["float64",Float64Array],["uint32",Uint32Array]]),Xe=new Map([[Float32Array,"float32"],[Uint8Array,"uint8"],[Int8Array,"int8"],[Uint16Array,"uint16"],[Int16Array,"int16"],[Int32Array,"int32"],[Float64Array,"float64"],[Uint32Array,"uint32"]]),pr=!1,mr=()=>{if(!pr){pr=!0;let n=typeof BigInt64Array<"u"&&typeof BigInt64Array.from=="function",i=typeof BigUint64Array<"u"&&typeof BigUint64Array.from=="function";n&&(De.set("int64",BigInt64Array),Xe.set(BigInt64Array,"int64")),i&&(De.set("uint64",BigUint64Array),Xe.set(BigUint64Array,"uint64"))}}});var yr,gr,wr=R(()=>{"use strict";qe();yr=n=>{let i=1;for(let r=0;r<n.length;r++){let u=n[r];if(typeof u!="number"||!Number.isSafeInteger(u))throw new TypeError(`dims[${r}] must be an integer, got: ${u}`);if(u<0)throw new RangeError(`dims[${r}] must be a non-negative integer, got: ${u}`);i*=u}return i},gr=(n,i)=>{switch(n.location){case"cpu":return new Y(n.type,n.data,i);case"cpu-pinned":return new Y({location:"cpu-pinned",data:n.data,type:n.type,dims:i});case"texture":return new Y({location:"texture",texture:n.texture,type:n.type,dims:i});case"gpu-buffer":return new Y({location:"gpu-buffer",gpuBuffer:n.gpuBuffer,type:n.type,dims:i});default:throw new Error(`tensorReshape: tensor location ${n.location} is not supported`)}}});var Y,qe=R(()=>{"use strict";sr();dr();hr();wr();Y=class{constructor(i,r,u){mr();let s,h;if(typeof i=="object"&&"location"in i)switch(this.dataLocation=i.location,s=i.type,h=i.dims,i.location){case"cpu-pinned":{let p=De.get(s);if(!p)throw new TypeError(`unsupported type "${s}" to create tensor from pinned buffer`);if(!(i.data instanceof p))throw new TypeError(`buffer should be of type ${p.name}`);this.cpuData=i.data;break}case"texture":{if(s!=="float32")throw new TypeError(`unsupported type "${s}" to create tensor from texture`);this.gpuTextureData=i.texture,this.downloader=i.download,this.disposer=i.dispose;break}case"gpu-buffer":{if(s!=="float32"&&s!=="float16"&&s!=="int32"&&s!=="int64"&&s!=="uint32"&&s!=="bool")throw new TypeError(`unsupported type "${s}" to create tensor from gpu buffer`);this.gpuBufferData=i.gpuBuffer,this.downloader=i.download,this.disposer=i.dispose;break}default:throw new Error(`Tensor constructor: unsupported location '${this.dataLocation}'`)}else{let p,m;if(typeof i=="string")if(s=i,m=u,i==="string"){if(!Array.isArray(r))throw new TypeError("A string tensor's data must be a string array.");p=r}else{let d=De.get(i);if(d===void 0)throw new TypeError(`Unsupported tensor type: ${i}.`);if(Array.isArray(r)){if(i==="float16")throw new TypeError("Creating a float16 tensor from number array is not supported. Please use Uint16Array as data.");i==="uint64"||i==="int64"?p=d.from(r,BigInt):p=d.from(r)}else if(r instanceof d)p=r;else throw new TypeError(`A ${s} tensor's data must be type of ${d}`)}else if(m=r,Array.isArray(i)){if(i.length===0)throw new TypeError("Tensor type cannot be inferred from an empty array.");let d=typeof i[0];if(d==="string")s="string",p=i;else if(d==="boolean")s="bool",p=Uint8Array.from(i);else throw new TypeError(`Invalid element type of data array: ${d}.`)}else{let d=Xe.get(i.constructor);if(d===void 0)throw new TypeError(`Unsupported type for tensor data: ${i.constructor}.`);s=d,p=i}if(m===void 0)m=[p.length];else if(!Array.isArray(m))throw new TypeError("A tensor's dims must be a number array");h=m,this.cpuData=p,this.dataLocation="cpu"}let c=yr(h);if(this.cpuData&&c!==this.cpuData.length)throw new Error(`Tensor's size(${c}) does not match data length(${this.cpuData.length}).`);this.type=s,this.dims=h,this.size=c}static async fromImage(i,r){return ur(i,r)}static fromTexture(i,r){return fr(i,r)}static fromGpuBuffer(i,r){return cr(i,r)}static fromPinnedBuffer(i,r,u){return lr(i,r,u)}toDataURL(i){return ir(this,i)}toImageData(i){return ar(this,i)}get data(){if(this.ensureValid(),!this.cpuData)throw new Error("The data is not on CPU. Use `getData()` to download GPU data to CPU, or use `texture` or `gpuBuffer` property to access the GPU data directly.");return this.cpuData}get location(){return this.dataLocation}get texture(){if(this.ensureValid(),!this.gpuTextureData)throw new Error("The data is not stored as a WebGL texture.");return this.gpuTextureData}get gpuBuffer(){if(this.ensureValid(),!this.gpuBufferData)throw new Error("The data is not stored as a WebGPU buffer.");return this.gpuBufferData}async getData(i){switch(this.ensureValid(),this.dataLocation){case"cpu":case"cpu-pinned":return this.data;case"texture":case"gpu-buffer":{if(!this.downloader)throw new Error("The current tensor is not created with a specified data downloader.");if(this.isDownloading)throw new Error("The current tensor is being downloaded.");try{this.isDownloading=!0;let r=await this.downloader();return this.downloader=void 0,this.dataLocation="cpu",this.cpuData=r,i&&this.disposer&&(this.disposer(),this.disposer=void 0),r}finally{this.isDownloading=!1}}default:throw new Error(`cannot get data from location: ${this.dataLocation}`)}}dispose(){if(this.isDownloading)throw new Error("The current tensor is being downloaded.");this.disposer&&(this.disposer(),this.disposer=void 0),this.cpuData=void 0,this.gpuTextureData=void 0,this.gpuBufferData=void 0,this.downloader=void 0,this.isDownloading=void 0,this.dataLocation="none"}ensureValid(){if(this.dataLocation==="none")throw new Error("The tensor is disposed.")}reshape(i){if(this.ensureValid(),this.downloader||this.disposer)throw new Error("Cannot reshape a tensor that owns GPU resource.");return gr(this,i)}}});var oe,pt=R(()=>{"use strict";qe();oe=Y});var Je,br=R(()=>{"use strict";ct();pt();Je=class n{constructor(i){this.handler=i}async run(i,r,u){let s={},h={};if(typeof i!="object"||i===null||i instanceof oe||Array.isArray(i))throw new TypeError("'feeds' must be an object that use input names as keys and OnnxValue as corresponding values.");let c=!0;if(typeof r=="object"){if(r===null)throw new TypeError("Unexpected argument[1]: cannot be null.");if(r instanceof oe)throw new TypeError("'fetches' cannot be a Tensor");if(Array.isArray(r)){if(r.length===0)throw new TypeError("'fetches' cannot be an empty array.");c=!1;for(let d of r){if(typeof d!="string")throw new TypeError("'fetches' must be a string array or an object.");if(this.outputNames.indexOf(d)===-1)throw new RangeError(`'fetches' contains invalid output name: ${d}.`);s[d]=null}if(typeof u=="object"&&u!==null)h=u;else if(typeof u<"u")throw new TypeError("'options' must be an object.")}else{let d=!1,y=Object.getOwnPropertyNames(r);for(let b of this.outputNames)if(y.indexOf(b)!==-1){let w=r[b];(w===null||w instanceof oe)&&(d=!0,c=!1,s[b]=w)}if(d){if(typeof u=="object"&&u!==null)h=u;else if(typeof u<"u")throw new TypeError("'options' must be an object.")}else h=r}}else if(typeof r<"u")throw new TypeError("Unexpected argument[1]: must be 'fetches' or 'options'.");for(let d of this.inputNames)if(typeof i[d]>"u")throw new Error(`input '${d}' is missing in 'feeds'.`);if(c)for(let d of this.outputNames)s[d]=null;let p=await this.handler.run(i,s,h),m={};for(let d in p)if(Object.hasOwnProperty.call(p,d)){let y=p[d];y instanceof oe?m[d]=y:m[d]=new oe(y.type,y.data,y.dims)}return m}async release(){return this.handler.dispose()}static async create(i,r,u,s){let h,c={};if(typeof i=="string"){if(h=i,typeof r=="object"&&r!==null)c=r;else if(typeof r<"u")throw new TypeError("'options' must be an object.")}else if(i instanceof Uint8Array){if(h=i,typeof r=="object"&&r!==null)c=r;else if(typeof r<"u")throw new TypeError("'options' must be an object.")}else if(i instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&i instanceof SharedArrayBuffer){let b=i,w=0,S=i.byteLength;if(typeof r=="object"&&r!==null)c=r;else if(typeof r=="number"){if(w=r,!Number.isSafeInteger(w))throw new RangeError("'byteOffset' must be an integer.");if(w<0||w>=b.byteLength)throw new RangeError(`'byteOffset' is out of range [0, ${b.byteLength}).`);if(S=i.byteLength-w,typeof u=="number"){if(S=u,!Number.isSafeInteger(S))throw new RangeError("'byteLength' must be an integer.");if(S<=0||w+S>b.byteLength)throw new RangeError(`'byteLength' is out of range (0, ${b.byteLength-w}].`);if(typeof s=="object"&&s!==null)c=s;else if(typeof s<"u")throw new TypeError("'options' must be an object.")}else if(typeof u<"u")throw new TypeError("'byteLength' must be a number.")}else if(typeof r<"u")throw new TypeError("'options' must be an object.");h=new Uint8Array(b,w,S)}else throw new TypeError("Unexpected argument[0]: must be 'path' or 'buffer'.");let m=(c.executionProviders||[]).map(b=>typeof b=="string"?b:b.name),y=await(await Kt(m)).createInferenceSessionHandler(h,c);return new n(y)}startProfiling(){this.handler.startProfiling()}endProfiling(){this.handler.endProfiling()}get inputNames(){return this.handler.inputNames}get outputNames(){return this.handler.outputNames}}});var Mn,vr=R(()=>{"use strict";br();Mn=Je});var Er=R(()=>{"use strict"});var Ze,Sr=R(()=>{"use strict";Ze=class{constructor(i){this.handler=i}get inputNames(){return this.handler.inputNames}get outputNames(){return this.handler.outputNames}static async create(i,r){throw new Error("Method not implemented")}async loadParametersBuffer(i,r){throw new Error("Method not implemented.")}async getContiguousParameters(i){throw new Error("Method not implemented.")}async runTrainStep(i,r,u){throw new Error("Method not implemented.")}async release(){return this.handler.dispose()}}});var Ln,Tr=R(()=>{"use strict";Sr();Ln=Ze});var Ae=R(()=>{"use strict";Qt();or();vr();pt();Er();Tr()});var Or={};Ge(Or,{readFile:()=>kn});var kn,Pr=R(()=>{kn=void 0});var Ir={};Ge(Ir,{join:()=>Fn});var Fn,xr=R(()=>{Fn=void 0});var Br=Un((Cr,mt)=>{"use strict";var _r=(()=>{var n=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return typeof __filename<"u"&&(n=n||__filename),function(i={}){var r=i,u,s;r.ready=new Promise((e,t)=>{u=e,s=t});var h=Object.assign({},r),c="./this.program",p=typeof window=="object",m=typeof importScripts=="function",d=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",y="",b,w,S;if(d){var x=(Pr(),Ye(Or)),O=(xr(),Ye(Ir));y=m?O.dirname(y)+"/":__dirname+"/",b=(e,t)=>(e=e.startsWith("file://")?new URL(e):O.normalize(e),x.readFileSync(e,t?void 0:"utf8")),S=e=>(e=b(e,!0),e.buffer||(e=new Uint8Array(e)),e),w=(e,t,o,a=!0)=>{e=e.startsWith("file://")?new URL(e):O.normalize(e),x.readFile(e,a?void 0:"utf8",(f,g)=>{f?o(f):t(a?g.buffer:g)})},!r.thisProgram&&1<process.argv.length&&(c=process.argv[1].replace(/\\/g,"/")),process.argv.slice(2),r.inspect=()=>"[Emscripten Module object]"}else(p||m)&&(m?y=self.location.href:typeof document<"u"&&document.currentScript&&(y=document.currentScript.src),n&&(y=n),y.indexOf("blob:")!==0?y=y.substr(0,y.replace(/[?#].*/,"").lastIndexOf("/")+1):y="",b=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},m&&(S=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),w=(e,t,o)=>{var a=new XMLHttpRequest;a.open("GET",e,!0),a.responseType="arraybuffer",a.onload=()=>{a.status==200||a.status==0&&a.response?t(a.response):o()},a.onerror=o,a.send(null)});var _=r.print||console.log.bind(console),M=r.printErr||console.error.bind(console);Object.assign(r,h),h=null,r.thisProgram&&(c=r.thisProgram);var L;r.wasmBinary&&(L=r.wasmBinary);var X=r.noExitRuntime||!0;typeof WebAssembly!="object"&&Ie("no native wasm support detected");var V,A,be=!1,ie,D,fe,ve,T,U,ce,C,le,Pe;function ne(){var e=V.buffer;r.HEAP8=ie=new Int8Array(e),r.HEAP16=fe=new Int16Array(e),r.HEAP32=T=new Int32Array(e),r.HEAPU8=D=new Uint8Array(e),r.HEAPU16=ve=new Uint16Array(e),r.HEAPU32=U=new Uint32Array(e),r.HEAPF32=ce=new Float32Array(e),r.HEAPF64=Pe=new Float64Array(e),r.HEAP64=C=new BigInt64Array(e),r.HEAPU64=le=new BigUint64Array(e)}var me=[],j=[],Z=[];function Ot(){var e=r.preRun.shift();me.unshift(e)}var K=0,Ee=null,de=null;function Ie(e){throw r.onAbort&&r.onAbort(e),e="Aborted("+e+")",M(e),be=!0,e=new WebAssembly.RuntimeError(e+". Build with -sASSERTIONS for more info."),s(e),e}function pe(e){return e.startsWith("data:application/octet-stream;base64,")}var Q;if(Q="ort-wasm.wasm",!pe(Q)){var xe=Q;Q=r.locateFile?r.locateFile(xe,y):y+xe}function N(e){if(e==Q&&L)return new Uint8Array(L);if(S)return S(e);throw"both async and sync fetching of the wasm failed"}function G(e){if(!L&&(p||m)){if(typeof fetch=="function"&&!e.startsWith("file://"))return fetch(e,{credentials:"same-origin"}).then(t=>{if(!t.ok)throw"failed to load wasm binary file at '"+e+"'";return t.arrayBuffer()}).catch(()=>N(e));if(w)return new Promise((t,o)=>{w(e,a=>t(new Uint8Array(a)),o)})}return Promise.resolve().then(()=>N(e))}function Se(e,t,o){return G(e).then(a=>WebAssembly.instantiate(a,t)).then(a=>a).then(o,a=>{M("failed to asynchronously prepare wasm: "+a),Ie(a)})}function Me(e,t){var o=Q;return L||typeof WebAssembly.instantiateStreaming!="function"||pe(o)||o.startsWith("file://")||d||typeof fetch!="function"?Se(o,e,t):fetch(o,{credentials:"same-origin"}).then(a=>WebAssembly.instantiateStreaming(a,e).then(t,function(f){return M("wasm streaming compile failed: "+f),M("falling back to ArrayBuffer instantiation"),Se(o,e,t)}))}var _e=e=>{for(;0<e.length;)e.shift()(r)};function cn(e){this.Va=e-24,this.fb=function(t){U[this.Va+4>>2]=t},this.eb=function(t){U[this.Va+8>>2]=t},this.Za=function(t,o){this.$a(),this.fb(t),this.eb(o)},this.$a=function(){U[this.Va+16>>2]=0}}var Pt=0,ln=0,It=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,Ce=(e,t,o)=>{var a=t+o;for(o=t;e[o]&&!(o>=a);)++o;if(16<o-t&&e.buffer&&It)return It.decode(e.subarray(t,o));for(a="";t<o;){var f=e[t++];if(f&128){var g=e[t++]&63;if((f&224)==192)a+=String.fromCharCode((f&31)<<6|g);else{var E=e[t++]&63;f=(f&240)==224?(f&15)<<12|g<<6|E:(f&7)<<18|g<<12|E<<6|e[t++]&63,65536>f?a+=String.fromCharCode(f):(f-=65536,a+=String.fromCharCode(55296|f>>10,56320|f&1023))}}else a+=String.fromCharCode(f)}return a},Le=e=>{for(var t=0,o=0;o<e.length;++o){var a=e.charCodeAt(o);127>=a?t++:2047>=a?t+=2:55296<=a&&57343>=a?(t+=4,++o):t+=3}return t},ke=(e,t,o,a)=>{if(!(0<a))return 0;var f=o;a=o+a-1;for(var g=0;g<e.length;++g){var E=e.charCodeAt(g);if(55296<=E&&57343>=E){var v=e.charCodeAt(++g);E=65536+((E&1023)<<10)|v&1023}if(127>=E){if(o>=a)break;t[o++]=E}else{if(2047>=E){if(o+1>=a)break;t[o++]=192|E>>6}else{if(65535>=E){if(o+2>=a)break;t[o++]=224|E>>12}else{if(o+3>=a)break;t[o++]=240|E>>18,t[o++]=128|E>>12&63}t[o++]=128|E>>6&63}t[o++]=128|E&63}}return t[o]=0,o-f};function xt(e){if(e===null)return"null";var t=typeof e;return t==="object"||t==="array"||t==="function"?e.toString():""+e}var _t=void 0;function re(e){for(var t="";D[e];)t+=_t[D[e++]];return t}var nt={},ot={},dn={},Ct=void 0;function he(e){throw new Ct(e)}function pn(e,t,o={}){var a=t.name;if(e||he(`type "${a}" must have a positive integer typeid pointer`),ot.hasOwnProperty(e)){if(o.gb)return;he(`Cannot register type '${a}' twice`)}ot[e]=t,delete dn[e],nt.hasOwnProperty(e)&&(t=nt[e],delete nt[e],t.forEach(f=>f()))}function ae(e,t,o={}){if(!("argPackAdvance"in t))throw new TypeError("registerType registeredInstance requires argPackAdvance");pn(e,t,o)}function Bt(e,t,o){switch(t){case 0:return o?function(a){return ie[a]}:function(a){return D[a]};case 1:return o?function(a){return fe[a>>1]}:function(a){return ve[a>>1]};case 2:return o?function(a){return T[a>>2]}:function(a){return U[a>>2]};case 3:return o?function(a){return C[a>>3]}:function(a){return le[a>>3]};default:throw new TypeError("Unknown integer type: "+e)}}function Fe(e){switch(e){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw new TypeError(`Unknown type size: ${e}`)}}function Dt(){this.Sa=[void 0],this.bb=[]}var ee=new Dt;function it(e){e>=ee.Va&&--ee.get(e).cb===0&&ee.$a(e)}var q=e=>(e||he("Cannot use deleted val. handle = "+e),ee.get(e).value),te=e=>{switch(e){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:return ee.Za({cb:1,value:e})}};function at(e){return this.fromWireType(T[e>>2])}function mn(e,t){switch(t){case 2:return function(o){return this.fromWireType(ce[o>>2])};case 3:return function(o){return this.fromWireType(Pe[o>>3])};default:throw new TypeError("Unknown float type: "+e)}}var Ut=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0,hn=(e,t)=>{for(var o=e>>1,a=o+t/2;!(o>=a)&&ve[o];)++o;if(o<<=1,32<o-e&&Ut)return Ut.decode(D.subarray(e,o));for(o="",a=0;!(a>=t/2);++a){var f=fe[e+2*a>>1];if(f==0)break;o+=String.fromCharCode(f)}return o},yn=(e,t,o)=>{if(o===void 0&&(o=2147483647),2>o)return 0;o-=2;var a=t;o=o<2*e.length?o/2:e.length;for(var f=0;f<o;++f)fe[t>>1]=e.charCodeAt(f),t+=2;return fe[t>>1]=0,t-a},gn=e=>2*e.length,wn=(e,t)=>{for(var o=0,a="";!(o>=t/4);){var f=T[e+4*o>>2];if(f==0)break;++o,65536<=f?(f-=65536,a+=String.fromCharCode(55296|f>>10,56320|f&1023)):a+=String.fromCharCode(f)}return a},bn=(e,t,o)=>{if(o===void 0&&(o=2147483647),4>o)return 0;var a=t;o=a+o-4;for(var f=0;f<e.length;++f){var g=e.charCodeAt(f);if(55296<=g&&57343>=g){var E=e.charCodeAt(++f);g=65536+((g&1023)<<10)|E&1023}if(T[t>>2]=g,t+=4,t+4>o)break}return T[t>>2]=0,t-a},vn=e=>{for(var t=0,o=0;o<e.length;++o){var a=e.charCodeAt(o);55296<=a&&57343>=a&&++o,t+=4}return t};function We(e,t){var o=ot[e];if(o===void 0){e=Yt(e);var a=re(e);se(e),he(t+" has unknown type "+a)}return o}var En={};function ze(e){var t=En[e];return t===void 0?re(e):t}var $e=[];function Rt(){return typeof globalThis=="object"?globalThis:Function("return this")()}function Sn(e){var t=$e.length;return $e.push(e),t}function Tn(e,t){for(var o=Array(e),a=0;a<e;++a)o[a]=We(U[t+4*a>>2],"parameter "+a);return o}function Mt(e){if(e===void 0)return"_unknown";e=e.replace(/[^a-zA-Z0-9_]/g,"$");var t=e.charCodeAt(0);return 48<=t&&57>=t?`_${e}`:e}var Lt=[];function An(e,t){return e=Mt(e),{[e]:function(){return t.apply(this,arguments)}}[e]}function On(e){var t=Function;if(!(t instanceof Function))throw new TypeError(`new_ called with constructor type ${typeof t} which is not a function`);var o=An(t.name||"unknownFunctionName",function(){});return o.prototype=t.prototype,o=new o,e=t.apply(o,e),e instanceof Object?e:o}function Pn(e){for(var t="",o=0;o<e;++o)t+=(o!==0?", ":"")+"arg"+o;var a="return function emval_allocator_"+e+`(constructor, argTypes, args) {
  var HEAPU32 = getMemory();
`;for(o=0;o<e;++o)a+="var argType"+o+" = requireRegisteredType(HEAPU32[((argTypes)>>2)], 'parameter "+o+`');
var arg`+o+" = argType"+o+`.readValueFromPointer(args);
args += argType`+o+`['argPackAdvance'];
argTypes += 4;
`;return new Function("requireRegisteredType","Module","valueToHandle","getMemory",a+("var obj = new constructor("+t+`);
return valueToHandle(obj);
}
`))(We,r,te,()=>U)}var kt={};function Be(e){return-9007199254740992>e||9007199254740992<e?NaN:Number(e)}var Te=e=>e%4===0&&(e%100!==0||e%400===0),Ft=[0,31,60,91,121,152,182,213,244,274,305,335],Wt=[0,31,59,90,120,151,181,212,243,273,304,334],zt=e=>{var t=Le(e)+1,o=Ne(t);return o&&ke(e,D,o,t),o},st={},$t=()=>{if(!ut){var e={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:c||"./this.program"},t;for(t in st)st[t]===void 0?delete e[t]:e[t]=st[t];var o=[];for(t in e)o.push(`${t}=${e[t]}`);ut=o}return ut},ut,In=[null,[],[]],Ht=[31,29,31,30,31,30,31,31,30,31,30,31],Nt=[31,28,31,30,31,30,31,31,30,31,30,31];function xn(e){var t=Array(Le(e)+1);return ke(e,t,0,t.length),t}for(var jt=(e,t,o,a)=>{function f(l,B,F){for(l=typeof l=="number"?l.toString():l||"";l.length<B;)l=F[0]+l;return l}function g(l,B){return f(l,B,"0")}function E(l,B){function F(Zt){return 0>Zt?-1:0<Zt?1:0}var ye;return(ye=F(l.getFullYear()-B.getFullYear()))===0&&(ye=F(l.getMonth()-B.getMonth()))===0&&(ye=F(l.getDate()-B.getDate())),ye}function v(l){switch(l.getDay()){case 0:return new Date(l.getFullYear()-1,11,29);case 1:return l;case 2:return new Date(l.getFullYear(),0,3);case 3:return new Date(l.getFullYear(),0,2);case 4:return new Date(l.getFullYear(),0,1);case 5:return new Date(l.getFullYear()-1,11,31);case 6:return new Date(l.getFullYear()-1,11,30)}}function P(l){var B=l.Ta;for(l=new Date(new Date(l.Ua+1900,0,1).getTime());0<B;){var F=l.getMonth(),ye=(Te(l.getFullYear())?Ht:Nt)[F];if(B>ye-l.getDate())B-=ye-l.getDate()+1,l.setDate(1),11>F?l.setMonth(F+1):(l.setMonth(0),l.setFullYear(l.getFullYear()+1));else{l.setDate(l.getDate()+B);break}}return F=new Date(l.getFullYear()+1,0,4),B=v(new Date(l.getFullYear(),0,4)),F=v(F),0>=E(B,l)?0>=E(F,l)?l.getFullYear()+1:l.getFullYear():l.getFullYear()-1}var I=T[a+40>>2];a={kb:T[a>>2],jb:T[a+4>>2],Xa:T[a+8>>2],ab:T[a+12>>2],Ya:T[a+16>>2],Ua:T[a+20>>2],Oa:T[a+24>>2],Ta:T[a+28>>2],mb:T[a+32>>2],ib:T[a+36>>2],lb:I&&I?Ce(D,I):""},o=o?Ce(D,o):"",I={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"};for(var k in I)o=o.replace(new RegExp(k,"g"),I[k]);var J="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),ue="January February March April May June July August September October November December".split(" ");I={"%a":l=>J[l.Oa].substring(0,3),"%A":l=>J[l.Oa],"%b":l=>ue[l.Ya].substring(0,3),"%B":l=>ue[l.Ya],"%C":l=>g((l.Ua+1900)/100|0,2),"%d":l=>g(l.ab,2),"%e":l=>f(l.ab,2," "),"%g":l=>P(l).toString().substring(2),"%G":l=>P(l),"%H":l=>g(l.Xa,2),"%I":l=>(l=l.Xa,l==0?l=12:12<l&&(l-=12),g(l,2)),"%j":l=>{for(var B=0,F=0;F<=l.Ya-1;B+=(Te(l.Ua+1900)?Ht:Nt)[F++]);return g(l.ab+B,3)},"%m":l=>g(l.Ya+1,2),"%M":l=>g(l.jb,2),"%n":()=>`
`,"%p":l=>0<=l.Xa&&12>l.Xa?"AM":"PM","%S":l=>g(l.kb,2),"%t":()=>"	","%u":l=>l.Oa||7,"%U":l=>g(Math.floor((l.Ta+7-l.Oa)/7),2),"%V":l=>{var B=Math.floor((l.Ta+7-(l.Oa+6)%7)/7);if(2>=(l.Oa+371-l.Ta-2)%7&&B++,B)B==53&&(F=(l.Oa+371-l.Ta)%7,F==4||F==3&&Te(l.Ua)||(B=1));else{B=52;var F=(l.Oa+7-l.Ta-1)%7;(F==4||F==5&&Te(l.Ua%400-1))&&B++}return g(B,2)},"%w":l=>l.Oa,"%W":l=>g(Math.floor((l.Ta+7-(l.Oa+6)%7)/7),2),"%y":l=>(l.Ua+1900).toString().substring(2),"%Y":l=>l.Ua+1900,"%z":l=>{l=l.ib;var B=0<=l;return l=Math.abs(l)/60,(B?"+":"-")+("0000"+(l/60*100+l%60)).slice(-4)},"%Z":l=>l.lb,"%%":()=>"%"},o=o.replace(/%%/g,"\0\0");for(k in I)o.includes(k)&&(o=o.replace(new RegExp(k,"g"),I[k](a)));return o=o.replace(/\0\0/g,"%"),k=xn(o),k.length>t?0:(ie.set(k,e),k.length-1)},Gt=Array(256),He=0;256>He;++He)Gt[He]=String.fromCharCode(He);_t=Gt,Ct=r.BindingError=class extends Error{constructor(e){super(e),this.name="BindingError"}},r.InternalError=class extends Error{constructor(e){super(e),this.name="InternalError"}},Object.assign(Dt.prototype,{get(e){return this.Sa[e]},has(e){return this.Sa[e]!==void 0},Za(e){var t=this.bb.pop()||this.Sa.length;return this.Sa[t]=e,t},$a(e){this.Sa[e]=void 0,this.bb.push(e)}}),ee.Sa.push({value:void 0},{value:null},{value:!0},{value:!1}),ee.Va=ee.Sa.length,r.count_emval_handles=function(){for(var e=0,t=ee.Va;t<ee.Sa.length;++t)ee.Sa[t]!==void 0&&++e;return e};var _n={a:function(e,t,o){throw new cn(e).Za(t,o),Pt=e,ln++,Pt},v:function(){return 0},ba:()=>{},N:()=>{},P:()=>{},H:function(){return 0},$:()=>{},V:()=>{},_:()=>{},A:function(){},O:()=>{},L:()=>{},aa:()=>{},M:()=>{},D:function(e,t,o,a,f){t=re(t),o=Fe(o);var g=t.indexOf("u")!=-1;g&&(f=(1n<<64n)-1n),ae(e,{name:t,fromWireType:function(E){return E},toWireType:function(E,v){if(typeof v!="bigint"&&typeof v!="number")throw new TypeError(`Cannot convert "${xt(v)}" to ${this.name}`);if(v<a||v>f)throw new TypeError(`Passing a number "${xt(v)}" from JS side to C/C++ side to an argument of type "${t}", which is outside the valid range [${a}, ${f}]!`);return v},argPackAdvance:8,readValueFromPointer:Bt(t,o,!g),Wa:null})},ea:function(e,t,o,a,f){var g=Fe(o);t=re(t),ae(e,{name:t,fromWireType:function(E){return!!E},toWireType:function(E,v){return v?a:f},argPackAdvance:8,readValueFromPointer:function(E){if(o===1)var v=ie;else if(o===2)v=fe;else if(o===4)v=T;else throw new TypeError("Unknown boolean type size: "+t);return this.fromWireType(v[E>>g])},Wa:null})},da:function(e,t){t=re(t),ae(e,{name:t,fromWireType:function(o){var a=q(o);return it(o),a},toWireType:function(o,a){return te(a)},argPackAdvance:8,readValueFromPointer:at,Wa:null})},C:function(e,t,o){o=Fe(o),t=re(t),ae(e,{name:t,fromWireType:function(a){return a},toWireType:function(a,f){return f},argPackAdvance:8,readValueFromPointer:mn(t,o),Wa:null})},p:function(e,t,o,a,f){t=re(t),f===-1&&(f=4294967295),f=Fe(o);var g=v=>v;if(a===0){var E=32-8*o;g=v=>v<<E>>>E}o=t.includes("unsigned")?function(v,P){return P>>>0}:function(v,P){return P},ae(e,{name:t,fromWireType:g,toWireType:o,argPackAdvance:8,readValueFromPointer:Bt(t,f,a!==0),Wa:null})},l:function(e,t,o){function a(g){g>>=2;var E=U;return new f(E.buffer,E[g+1],E[g])}var f=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array,BigInt64Array,BigUint64Array][t];o=re(o),ae(e,{name:o,fromWireType:a,argPackAdvance:8,readValueFromPointer:a},{gb:!0})},E:function(e,t){t=re(t);var o=t==="std::string";ae(e,{name:t,fromWireType:function(a){var f=U[a>>2],g=a+4;if(o)for(var E=g,v=0;v<=f;++v){var P=g+v;if(v==f||D[P]==0){if(E=E?Ce(D,E,P-E):"",I===void 0)var I=E;else I+=String.fromCharCode(0),I+=E;E=P+1}}else{for(I=Array(f),v=0;v<f;++v)I[v]=String.fromCharCode(D[g+v]);I=I.join("")}return se(a),I},toWireType:function(a,f){f instanceof ArrayBuffer&&(f=new Uint8Array(f));var g=typeof f=="string";g||f instanceof Uint8Array||f instanceof Uint8ClampedArray||f instanceof Int8Array||he("Cannot pass non-string to std::string");var E=o&&g?Le(f):f.length,v=Ne(4+E+1),P=v+4;if(U[v>>2]=E,o&&g)ke(f,D,P,E+1);else if(g)for(g=0;g<E;++g){var I=f.charCodeAt(g);255<I&&(se(P),he("String has UTF-16 code units that do not fit in 8 bits")),D[P+g]=I}else for(g=0;g<E;++g)D[P+g]=f[g];return a!==null&&a.push(se,v),v},argPackAdvance:8,readValueFromPointer:at,Wa:function(a){se(a)}})},x:function(e,t,o){if(o=re(o),t===2)var a=hn,f=yn,g=gn,E=()=>ve,v=1;else t===4&&(a=wn,f=bn,g=vn,E=()=>U,v=2);ae(e,{name:o,fromWireType:function(P){for(var I=U[P>>2],k=E(),J,ue=P+4,l=0;l<=I;++l){var B=P+4+l*t;(l==I||k[B>>v]==0)&&(ue=a(ue,B-ue),J===void 0?J=ue:(J+=String.fromCharCode(0),J+=ue),ue=B+t)}return se(P),J},toWireType:function(P,I){typeof I!="string"&&he(`Cannot pass non-string to C++ string type ${o}`);var k=g(I),J=Ne(4+k+t);return U[J>>2]=k>>v,f(I,J+4,k+t),P!==null&&P.push(se,J),J},argPackAdvance:8,readValueFromPointer:at,Wa:function(P){se(P)}})},fa:function(e,t){t=re(t),ae(e,{hb:!0,name:t,argPackAdvance:0,fromWireType:function(){},toWireType:function(){}})},ca:()=>!0,o:function(e,t,o){e=q(e),t=We(t,"emval::as");var a=[],f=te(a);return U[o>>2]=f,t.toWireType(a,e)},h:function(e,t,o,a,f){e=$e[e],t=q(t),o=ze(o);var g=[];return U[a>>2]=te(g),e(t,o,g,f)},r:function(e,t,o,a){e=$e[e],t=q(t),o=ze(o),e(t,o,null,a)},b:it,F:function(e,t){return e=q(e),t=q(t),e==t},u:function(e){return e===0?te(Rt()):(e=ze(e),te(Rt()[e]))},g:function(e,t){var o=Tn(e,t),a=o[0];t=a.name+"_$"+o.slice(1).map(function(k){return k.name}).join("_")+"$";var f=Lt[t];if(f!==void 0)return f;f=["retType"];for(var g=[a],E="",v=0;v<e-1;++v)E+=(v!==0?", ":"")+"arg"+v,f.push("argType"+v),g.push(o[1+v]);var P="return function "+Mt("methodCaller_"+t)+`(handle, name, destructors, args) {
`,I=0;for(v=0;v<e-1;++v)P+="    var arg"+v+" = argType"+v+".readValueFromPointer(args"+(I?"+"+I:"")+`);
`,I+=o[v+1].argPackAdvance;for(P+="    var rv = handle[name]("+E+`);
`,v=0;v<e-1;++v)o[v+1].deleteObject&&(P+="    argType"+v+".deleteObject(arg"+v+`);
`);return a.hb||(P+=`    return retType.toWireType(destructors, rv);
`),f.push(P+`};
`),e=On(f).apply(null,g),f=Sn(e),Lt[t]=f},q:function(e,t){return e=q(e),t=q(t),te(e[t])},c:function(e){4<e&&(ee.get(e).cb+=1)},G:function(e,t,o,a){e=q(e);var f=kt[t];return f||(f=Pn(t),kt[t]=f),f(e,o,a)},s:function(){return te([])},k:function(e){e=q(e);for(var t=Array(e.length),o=0;o<e.length;o++)t[o]=e[o];return te(t)},d:function(e){return te(ze(e))},j:function(){return te({})},f:function(e){for(var t=q(e);t.length;){var o=t.pop();t.pop()(o)}it(e)},i:function(e,t,o){e=q(e),t=q(t),o=q(o),e[t]=o},e:function(e,t){return e=We(e,"_emval_take_value"),e=e.readValueFromPointer(t),te(e)},S:function(e,t){e=Be(e),t=Be(t),e=new Date(1e3*e),T[t>>2]=e.getUTCSeconds(),T[t+4>>2]=e.getUTCMinutes(),T[t+8>>2]=e.getUTCHours(),T[t+12>>2]=e.getUTCDate(),T[t+16>>2]=e.getUTCMonth(),T[t+20>>2]=e.getUTCFullYear()-1900,T[t+24>>2]=e.getUTCDay(),T[t+28>>2]=(e.getTime()-Date.UTC(e.getUTCFullYear(),0,1,0,0,0,0))/864e5|0},T:function(e,t){e=Be(e),t=Be(t),e=new Date(1e3*e),T[t>>2]=e.getSeconds(),T[t+4>>2]=e.getMinutes(),T[t+8>>2]=e.getHours(),T[t+12>>2]=e.getDate(),T[t+16>>2]=e.getMonth(),T[t+20>>2]=e.getFullYear()-1900,T[t+24>>2]=e.getDay(),T[t+28>>2]=(Te(e.getFullYear())?Ft:Wt)[e.getMonth()]+e.getDate()-1|0,T[t+36>>2]=-(60*e.getTimezoneOffset());var o=new Date(e.getFullYear(),6,1).getTimezoneOffset(),a=new Date(e.getFullYear(),0,1).getTimezoneOffset();T[t+32>>2]=(o!=a&&e.getTimezoneOffset()==Math.min(a,o))|0},U:function(e){e=Be(e);var t=new Date(T[e+20>>2]+1900,T[e+16>>2],T[e+12>>2],T[e+8>>2],T[e+4>>2],T[e>>2],0),o=T[e+32>>2],a=t.getTimezoneOffset(),f=new Date(t.getFullYear(),6,1).getTimezoneOffset(),g=new Date(t.getFullYear(),0,1).getTimezoneOffset(),E=Math.min(g,f);return 0>o?T[e+32>>2]=+(f!=g&&E==a):0<o!=(E==a)&&(f=Math.max(g,f),t.setTime(t.getTime()+6e4*((0<o?E:f)-a))),T[e+24>>2]=t.getDay(),T[e+28>>2]=(Te(t.getFullYear())?Ft:Wt)[t.getMonth()]+t.getDate()-1|0,T[e>>2]=t.getSeconds(),T[e+4>>2]=t.getMinutes(),T[e+8>>2]=t.getHours(),T[e+12>>2]=t.getDate(),T[e+16>>2]=t.getMonth(),T[e+20>>2]=t.getYear(),BigInt(t.getTime()/1e3)},Q:function(){return-52},R:function(){},J:(e,t,o)=>{function a(P){return(P=P.toTimeString().match(/\(([A-Za-z ]+)\)$/))?P[1]:"GMT"}var f=new Date().getFullYear(),g=new Date(f,0,1),E=new Date(f,6,1);f=g.getTimezoneOffset();var v=E.getTimezoneOffset();U[e>>2]=60*Math.max(f,v),T[t>>2]=+(f!=v),e=a(g),t=a(E),e=zt(e),t=zt(t),v<f?(U[o>>2]=e,U[o+4>>2]=t):(U[o>>2]=t,U[o+4>>2]=e)},t:()=>{Ie("")},B:function(){return Date.now()},K:()=>2147483648,n:()=>performance.now(),Z:(e,t,o)=>D.copyWithin(e,t,t+o),I:e=>{var t=D.length;if(e>>>=0,2147483648<e)return!1;for(var o=1;4>=o;o*=2){var a=t*(1+.2/o);a=Math.min(a,e+100663296);var f=Math;a=Math.max(e,a);e:{f=f.min.call(f,2147483648,a+(65536-a%65536)%65536)-V.buffer.byteLength+65535>>>16;try{V.grow(f),ne();var g=1;break e}catch{}g=void 0}if(g)return!0}return!1},X:(e,t)=>{var o=0;return $t().forEach(function(a,f){var g=t+o;for(f=U[e+4*f>>2]=g,g=0;g<a.length;++g)ie[f++>>0]=a.charCodeAt(g);ie[f>>0]=0,o+=a.length+1}),0},Y:(e,t)=>{var o=$t();U[e>>2]=o.length;var a=0;return o.forEach(function(f){a+=f.length+1}),U[t>>2]=a,0},w:()=>52,z:()=>52,W:function(){return 70},y:(e,t,o,a)=>{for(var f=0,g=0;g<o;g++){var E=U[t>>2],v=U[t+4>>2];t+=8;for(var P=0;P<v;P++){var I=D[E+P],k=In[e];I===0||I===10?((e===1?_:M)(Ce(k,0)),k.length=0):k.push(I)}f+=v}return U[a>>2]=f,0},ga:jt,m:(e,t,o,a)=>jt(e,t,o,a)};(function(){function e(o){if(A=o=o.exports,V=A.ha,ne(),j.unshift(A.ia),K--,r.monitorRunDependencies&&r.monitorRunDependencies(K),K==0&&(Ee!==null&&(clearInterval(Ee),Ee=null),de)){var a=de;de=null,a()}return o}var t={a:_n};if(K++,r.monitorRunDependencies&&r.monitorRunDependencies(K),r.instantiateWasm)try{return r.instantiateWasm(t,e)}catch(o){M("Module.instantiateWasm callback failed with error: "+o),s(o)}return Me(t,function(o){e(o.instance)}).catch(s),{}})(),r._OrtInit=(e,t)=>(r._OrtInit=A.ja)(e,t),r._OrtGetLastError=(e,t)=>(r._OrtGetLastError=A.ka)(e,t),r._OrtCreateSessionOptions=(e,t,o,a,f,g,E,v,P,I)=>(r._OrtCreateSessionOptions=A.la)(e,t,o,a,f,g,E,v,P,I),r._OrtAppendExecutionProvider=(e,t)=>(r._OrtAppendExecutionProvider=A.ma)(e,t),r._OrtAddFreeDimensionOverride=(e,t,o)=>(r._OrtAddFreeDimensionOverride=A.na)(e,t,o),r._OrtAddSessionConfigEntry=(e,t,o)=>(r._OrtAddSessionConfigEntry=A.oa)(e,t,o),r._OrtReleaseSessionOptions=e=>(r._OrtReleaseSessionOptions=A.pa)(e),r._OrtCreateSession=(e,t,o)=>(r._OrtCreateSession=A.qa)(e,t,o),r._OrtReleaseSession=e=>(r._OrtReleaseSession=A.ra)(e),r._OrtGetInputOutputCount=(e,t,o)=>(r._OrtGetInputOutputCount=A.sa)(e,t,o),r._OrtGetInputName=(e,t)=>(r._OrtGetInputName=A.ta)(e,t),r._OrtGetOutputName=(e,t)=>(r._OrtGetOutputName=A.ua)(e,t),r._OrtFree=e=>(r._OrtFree=A.va)(e),r._OrtCreateTensor=(e,t,o,a,f,g)=>(r._OrtCreateTensor=A.wa)(e,t,o,a,f,g),r._OrtGetTensorData=(e,t,o,a,f)=>(r._OrtGetTensorData=A.xa)(e,t,o,a,f),r._OrtReleaseTensor=e=>(r._OrtReleaseTensor=A.ya)(e),r._OrtCreateRunOptions=(e,t,o,a)=>(r._OrtCreateRunOptions=A.za)(e,t,o,a),r._OrtAddRunConfigEntry=(e,t,o)=>(r._OrtAddRunConfigEntry=A.Aa)(e,t,o),r._OrtReleaseRunOptions=e=>(r._OrtReleaseRunOptions=A.Ba)(e),r._OrtCreateBinding=e=>(r._OrtCreateBinding=A.Ca)(e),r._OrtBindInput=(e,t,o)=>(r._OrtBindInput=A.Da)(e,t,o),r._OrtBindOutput=(e,t,o,a)=>(r._OrtBindOutput=A.Ea)(e,t,o,a),r._OrtClearBoundOutputs=e=>(r._OrtClearBoundOutputs=A.Fa)(e),r._OrtReleaseBinding=e=>(r._OrtReleaseBinding=A.Ga)(e),r._OrtRunWithBinding=(e,t,o,a,f)=>(r._OrtRunWithBinding=A.Ha)(e,t,o,a,f),r._OrtRun=(e,t,o,a,f,g,E,v)=>(r._OrtRun=A.Ia)(e,t,o,a,f,g,E,v),r._OrtEndProfiling=e=>(r._OrtEndProfiling=A.Ja)(e);var Ne=r._malloc=e=>(Ne=r._malloc=A.Ka)(e),se=r._free=e=>(se=r._free=A.La)(e),Yt=e=>(Yt=A.Ma)(e);r.__embind_initialize_bindings=()=>(r.__embind_initialize_bindings=A.Na)();var Vt=()=>(Vt=A.Pa)(),qt=e=>(qt=A.Qa)(e),Xt=e=>(Xt=A.Ra)(e);r.stackAlloc=Xt,r.stackSave=Vt,r.stackRestore=qt,r.UTF8ToString=(e,t)=>e?Ce(D,e,t):"",r.stringToUTF8=(e,t,o)=>ke(e,D,t,o),r.lengthBytesUTF8=Le;var je;de=function e(){je||Jt(),je||(de=e)};function Jt(){function e(){if(!je&&(je=!0,r.calledRun=!0,!be)){if(_e(j),u(r),r.onRuntimeInitialized&&r.onRuntimeInitialized(),r.postRun)for(typeof r.postRun=="function"&&(r.postRun=[r.postRun]);r.postRun.length;){var t=r.postRun.shift();Z.unshift(t)}_e(Z)}}if(!(0<K)){if(r.preRun)for(typeof r.preRun=="function"&&(r.preRun=[r.preRun]);r.preRun.length;)Ot();_e(me),0<K||(r.setStatus?(r.setStatus("Running..."),setTimeout(function(){setTimeout(function(){r.setStatus("")},1),e()},1)):e())}}if(r.preInit)for(typeof r.preInit=="function"&&(r.preInit=[r.preInit]);0<r.preInit.length;)r.preInit.pop()();return Jt(),i.ready}})();typeof Cr=="object"&&typeof mt=="object"?mt.exports=_r:typeof define=="function"&&define.amd&&define([],()=>_r)});var Ur,Wn,ht,yt,Ke,Dr,zn,$n,Hn,Rr,z,Oe=R(()=>{"use strict";Ur=Br(),Wn=Ur,yt=!1,Ke=!1,Dr=!1,zn=()=>{try{return typeof SharedArrayBuffer>"u"?!1:(typeof MessageChannel<"u"&&new MessageChannel().port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11])))}catch{return!1}},$n=()=>{try{return WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,30,1,28,0,65,0,253,15,253,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,253,186,1,26,11]))}catch{return!1}},Hn=(n,i)=>i?n?"ort-wasm-simd-threaded.wasm":"ort-wasm-threaded.wasm":n?"ort-wasm-simd.wasm":"ort-wasm.wasm",Rr=async n=>{if(yt)return Promise.resolve();if(Ke)throw new Error("multiple calls to 'initializeWebAssembly()' detected.");if(Dr)throw new Error("previous call to 'initializeWebAssembly()' failed.");Ke=!0;let i=n.initTimeout,r=n.numThreads,u=n.simd,s=r>1&&zn(),h=u&&$n(),c=n.wasmPaths,p=typeof c=="string"?c:void 0,m=Hn(h,s),d=typeof c=="object"?c[m]:void 0,y=!1,b=[];if(i>0&&b.push(new Promise(w=>{setTimeout(()=>{y=!0,w()},i)})),b.push(new Promise((w,S)=>{(s?Wn:Ur)({locateFile:(_,M)=>_.endsWith(".wasm")?d||(p??M)+m:M+_}).then(_=>{Ke=!1,yt=!0,ht=_,w()},_=>{Ke=!1,Dr=!0,S(_)})})),await Promise.race(b),y)throw new Error(`WebAssembly backend initializing failed due to timeout: ${i}ms`)},z=()=>{if(yt&&ht)return ht;throw new Error("WebAssembly is not initialized yet.")}});var H,Ue,W,Qe=R(()=>{"use strict";Oe();H=(n,i)=>{let r=z(),u=r.lengthBytesUTF8(n)+1,s=r._malloc(u);return r.stringToUTF8(n,s,u),i.push(s),s},Ue=(n,i,r,u)=>{if(typeof n=="object"&&n!==null){if(r.has(n))throw new Error("Circular reference in options");r.add(n)}Object.entries(n).forEach(([s,h])=>{let c=i?i+s:s;if(typeof h=="object")Ue(h,c+".",r,u);else if(typeof h=="string"||typeof h=="number")u(c,h.toString());else if(typeof h=="boolean")u(c,h?"1":"0");else throw new Error(`Can't handle extra config type: ${typeof h}`)})},W=n=>{let i=z(),r=i.stackSave();try{let u=i.stackAlloc(8);i._OrtGetLastError(u,u+4);let s=i.HEAP32[u/4],h=i.HEAPU32[u/4+1],c=h?i.UTF8ToString(h):"";throw new Error(`${n} ERROR_CODE: ${s}, ERROR_MESSAGE: ${c}`)}finally{i.stackRestore(r)}}});var Mr,Lr=R(()=>{"use strict";Oe();Qe();Mr=n=>{let i=z(),r=0,u=[],s=n||{};try{if(n?.logSeverityLevel===void 0)s.logSeverityLevel=2;else if(typeof n.logSeverityLevel!="number"||!Number.isInteger(n.logSeverityLevel)||n.logSeverityLevel<0||n.logSeverityLevel>4)throw new Error(`log serverity level is not valid: ${n.logSeverityLevel}`);if(n?.logVerbosityLevel===void 0)s.logVerbosityLevel=0;else if(typeof n.logVerbosityLevel!="number"||!Number.isInteger(n.logVerbosityLevel))throw new Error(`log verbosity level is not valid: ${n.logVerbosityLevel}`);n?.terminate===void 0&&(s.terminate=!1);let h=0;return n?.tag!==void 0&&(h=H(n.tag,u)),r=i._OrtCreateRunOptions(s.logSeverityLevel,s.logVerbosityLevel,!!s.terminate,h),r===0&&W("Can't create run options."),n?.extra!==void 0&&Ue(n.extra,"",new WeakSet,(c,p)=>{let m=H(c,u),d=H(p,u);i._OrtAddRunConfigEntry(r,m,d)!==0&&W(`Can't set a run config entry: ${c} - ${p}.`)}),[r,u]}catch(h){throw r!==0&&i._OrtReleaseRunOptions(r),u.forEach(c=>i._free(c)),h}}});var Nn,jn,Gn,Yn,kr,Fr=R(()=>{"use strict";Oe();Qe();Nn=n=>{switch(n){case"disabled":return 0;case"basic":return 1;case"extended":return 2;case"all":return 99;default:throw new Error(`unsupported graph optimization level: ${n}`)}},jn=n=>{switch(n){case"sequential":return 0;case"parallel":return 1;default:throw new Error(`unsupported execution mode: ${n}`)}},Gn=n=>{n.extra||(n.extra={}),n.extra.session||(n.extra.session={});let i=n.extra.session;i.use_ort_model_bytes_directly||(i.use_ort_model_bytes_directly="1"),n.executionProviders&&n.executionProviders.some(r=>(typeof r=="string"?r:r.name)==="webgpu")&&(n.enableMemPattern=!1)},Yn=(n,i,r)=>{for(let u of i){let s=typeof u=="string"?u:u.name;switch(s){case"xnnpack":s="XNNPACK";break;case"webnn":if(s="WEBNN",typeof u!="string"){let c=u;if(c?.deviceType){let p=H("deviceType",r),m=H(c.deviceType,r);z()._OrtAddSessionConfigEntry(n,p,m)!==0&&W(`Can't set a session config entry: 'deviceType' - ${c.deviceType}.`)}if(c?.powerPreference){let p=H("powerPreference",r),m=H(c.powerPreference,r);z()._OrtAddSessionConfigEntry(n,p,m)!==0&&W(`Can't set a session config entry: 'powerPreference' - ${c.powerPreference}.`)}}break;case"webgpu":if(s="JS",typeof u!="string"){let c=u;if(c?.preferredLayout){if(c.preferredLayout!=="NCHW"&&c.preferredLayout!=="NHWC")throw new Error(`preferredLayout must be either 'NCHW' or 'NHWC': ${c.preferredLayout}`);let p=H("preferredLayout",r),m=H(c.preferredLayout,r);z()._OrtAddSessionConfigEntry(n,p,m)!==0&&W(`Can't set a session config entry: 'preferredLayout' - ${c.preferredLayout}.`)}}break;case"wasm":case"cpu":continue;default:throw new Error(`not supported execution provider: ${s}`)}let h=H(s,r);z()._OrtAppendExecutionProvider(n,h)!==0&&W(`Can't append execution provider: ${s}.`)}},kr=n=>{let i=z(),r=0,u=[],s=n||{};Gn(s);try{let h=Nn(s.graphOptimizationLevel??"all"),c=jn(s.executionMode??"sequential"),p=typeof s.logId=="string"?H(s.logId,u):0,m=s.logSeverityLevel??2;if(!Number.isInteger(m)||m<0||m>4)throw new Error(`log serverity level is not valid: ${m}`);let d=s.logVerbosityLevel??0;if(!Number.isInteger(d)||d<0||d>4)throw new Error(`log verbosity level is not valid: ${d}`);let y=typeof s.optimizedModelFilePath=="string"?H(s.optimizedModelFilePath,u):0;if(r=i._OrtCreateSessionOptions(h,!!s.enableCpuMemArena,!!s.enableMemPattern,c,!!s.enableProfiling,0,p,m,d,y),r===0&&W("Can't create session options."),s.executionProviders&&Yn(r,s.executionProviders,u),s.freeDimensionOverrides)for(let[b,w]of Object.entries(s.freeDimensionOverrides)){if(typeof b!="string")throw new Error(`free dimension override name must be a string: ${b}`);if(typeof w!="number"||!Number.isInteger(w)||w<0)throw new Error(`free dimension override value must be a non-negative integer: ${w}`);let S=H(b,u);i._OrtAddFreeDimensionOverride(r,S,w)!==0&&W(`Can't set a free dimension override: ${b} - ${w}.`)}return s.extra!==void 0&&Ue(s.extra,"",new WeakSet,(b,w)=>{let S=H(b,u),x=H(w,u);i._OrtAddSessionConfigEntry(r,S,x)!==0&&W(`Can't set a session config entry: ${b} - ${w}.`)}),[r,u]}catch(h){throw r!==0&&i._OrtReleaseSessionOptions(r),u.forEach(c=>i._free(c)),h}}});var gt,Wr,wt,zr,$r,et,Hr,bt=R(()=>{"use strict";gt=n=>{switch(n){case"int8":return 3;case"uint8":return 2;case"bool":return 9;case"int16":return 5;case"uint16":return 4;case"int32":return 6;case"uint32":return 12;case"float16":return 10;case"float32":return 1;case"float64":return 11;case"string":return 8;case"int64":return 7;case"uint64":return 13;default:throw new Error(`unsupported data type: ${n}`)}},Wr=n=>{switch(n){case 3:return"int8";case 2:return"uint8";case 9:return"bool";case 5:return"int16";case 4:return"uint16";case 6:return"int32";case 12:return"uint32";case 10:return"float16";case 1:return"float32";case 11:return"float64";case 8:return"string";case 7:return"int64";case 13:return"uint64";default:throw new Error(`unsupported data type: ${n}`)}},wt=n=>[void 0,4,1,1,2,2,4,8,void 0,1,2,8,4,8,void 0,void 0,void 0][n],zr=n=>{switch(n){case"float16":return Uint16Array;case"float32":return Float32Array;case"uint8":return Uint8Array;case"int8":return Int8Array;case"uint16":return Uint16Array;case"int16":return Int16Array;case"int32":return Int32Array;case"bool":return Uint8Array;case"float64":return Float64Array;case"uint32":return Uint32Array;case"int64":return BigInt64Array;case"uint64":return BigUint64Array;default:throw new Error(`unsupported type: ${n}`)}},$r=n=>{switch(n){case"verbose":return 0;case"info":return 1;case"warning":return 2;case"error":return 3;case"fatal":return 4;default:throw new Error(`unsupported logging level: ${n}`)}},et=n=>n==="float32"||n==="int32"||n==="int64"||n==="bool"||n==="float16"||n==="uint32",Hr=n=>{switch(n){case"none":return 0;case"cpu":return 1;case"cpu-pinned":return 2;case"texture":return 3;case"gpu-buffer":return 4;default:throw new Error(`unsupported data location: ${n}`)}}});var Vn,qn,jr,Re,vt,Et,Gr,Yr,Nr,Vr,qr,Xr=R(()=>{"use strict";Lr();Fr();bt();Oe();Qe();Vn=n=>{let i=z(),r=i.stackSave();try{let u=i.stackAlloc(8);return i._OrtGetInputOutputCount(n,u,u+4)!==0&&W("Can't get session input/output count."),[i.HEAP32[u/4],i.HEAP32[u/4+1]]}finally{i.stackRestore(r)}},qn=(n,i)=>{z()._OrtInit(n,i)!==0&&W("Can't initialize onnxruntime.")},jr=async n=>{qn(n.wasm.numThreads,$r(n.logLevel))},Re=new Map,vt=n=>{let i=z(),r=i._malloc(n.byteLength);if(r===0)throw new Error(`Can't create a session. failed to allocate a buffer of size ${n.byteLength}.`);return i.HEAPU8.set(n,r),[r,n.byteLength]},Et=(n,i)=>{let r=z(),u=0,s=0,h=0,c=[],p=[],m=[];try{[s,c]=kr(i),u=r._OrtCreateSession(n[0],n[1],s),u===0&&W("Can't create a session.");let[d,y]=Vn(u),b=[],w=[],S=[];for(let O=0;O<d;O++){let _=r._OrtGetInputName(u,O);_===0&&W("Can't get an input name."),p.push(_),b.push(r.UTF8ToString(_))}for(let O=0;O<y;O++){let _=r._OrtGetOutputName(u,O);_===0&&W("Can't get an output name."),m.push(_);let M=r.UTF8ToString(_);w.push(M)}let x=null;return Re.set(u,[u,p,m,x]),[u,b,w]}catch(d){throw p.forEach(y=>r._OrtFree(y)),m.forEach(y=>r._OrtFree(y)),h!==0&&r._OrtReleaseBinding(h),u!==0&&r._OrtReleaseSession(u),d}finally{r._free(n[0]),s!==0&&r._OrtReleaseSessionOptions(s),c.forEach(d=>r._free(d))}},Gr=(n,i)=>{let r=vt(n);return Et(r,i)},Yr=n=>{let i=z(),r=Re.get(n);if(!r)throw new Error(`cannot release session. invalid session id: ${n}`);let[u,s,h,c]=r;c&&i._OrtReleaseBinding(c.handle),i.jsepUnregisterBuffers?.(n),s.forEach(p=>i._OrtFree(p)),h.forEach(p=>i._OrtFree(p)),i._OrtReleaseSession(u),Re.delete(n)},Nr=(n,i,r,u,s)=>{if(!n){i.push(0);return}let h=z(),c=n[0],p=n[1],m=n[3],d,y;if(c==="string"&&m==="gpu-buffer")throw new Error("String tensor is not supported on GPU.");if(m==="gpu-buffer"){let S=n[2].gpuBuffer,x=wt(gt(c));y=p.reduce((O,_)=>O*_,1)*x,d=h.jsepRegisterBuffer(u,s,S,y)}else{let S=n[2];if(Array.isArray(S)){y=4*S.length,d=h._malloc(y),r.push(d);let x=d/4;for(let O=0;O<S.length;O++){if(typeof S[O]!="string")throw new TypeError(`tensor data at index ${O} is not a string`);h.HEAPU32[x++]=H(S[O],r)}}else y=S.byteLength,d=h._malloc(y),r.push(d),h.HEAPU8.set(new Uint8Array(S.buffer,S.byteOffset,y),d)}let b=h.stackSave(),w=h.stackAlloc(4*p.length);try{let S=w/4;p.forEach(O=>h.HEAP32[S++]=O);let x=h._OrtCreateTensor(gt(c),d,y,w,p.length,Hr(m));x===0&&W(`Can't create tensor for input/output. session=${u}, index=${s}.`),i.push(x)}finally{h.stackRestore(b)}},Vr=async(n,i,r,u,s,h)=>{let c=z(),p=Re.get(n);if(!p)throw new Error(`cannot run inference. invalid session id: ${n}`);let[m,d,y,b]=p,w=i.length,S=u.length,x=0,O=[],_=[],M=[],L=[],X=c.stackSave(),V=c.stackAlloc(w*4),A=c.stackAlloc(w*4),be=c.stackAlloc(S*4),ie=c.stackAlloc(S*4);try{[x,O]=Mr(h);for(let C=0;C<w;C++)Nr(r[C],_,L,n,i[C]);for(let C=0;C<S;C++)Nr(s[C],M,L,n,w+u[C]);let D=V/4,fe=A/4,ve=be/4,T=ie/4;for(let C=0;C<w;C++)c.HEAPU32[D++]=_[C],c.HEAPU32[fe++]=d[i[C]];for(let C=0;C<S;C++)c.HEAPU32[ve++]=M[C],c.HEAPU32[T++]=y[u[C]];let U;U=await c._OrtRun(m,A,V,w,ie,S,be,x),U!==0&&W("failed to call OrtRun().");let ce=[];for(let C=0;C<S;C++){let le=c.HEAPU32[be/4+C];if(le===M[C]){ce.push(s[C]);continue}let Pe=c.stackSave(),ne=c.stackAlloc(4*4),me=!1,j,Z=0;try{c._OrtGetTensorData(le,ne,ne+4,ne+8,ne+12)!==0&&W(`Can't access output tensor data on index ${C}.`);let K=ne/4,Ee=c.HEAPU32[K++];Z=c.HEAPU32[K++];let de=c.HEAPU32[K++],Ie=c.HEAPU32[K++],pe=[];for(let N=0;N<Ie;N++)pe.push(c.HEAPU32[de/4+N]);c._OrtFree(de);let Q=pe.reduce((N,G)=>N*G,1);j=Wr(Ee);let xe=b?.outputPreferredLocations[u[C]];if(j==="string"){if(xe==="gpu-buffer")throw new Error("String tensor is not supported on GPU.");let N=[],G=Z/4;for(let Se=0;Se<Q;Se++){let Me=c.HEAPU32[G++],_e=Se===Q-1?void 0:c.HEAPU32[G]-Me;N.push(c.UTF8ToString(Me,_e))}ce.push([j,pe,N,"cpu"])}else if(xe==="gpu-buffer"&&Q>0){let N=c.jsepGetBuffer(Z),G=wt(Ee);if(G===void 0||!et(j))throw new Error(`Unsupported data type: ${j}`);me=!0,ce.push([j,pe,{gpuBuffer:N,download:c.jsepCreateDownloader(N,Q*G,j),dispose:()=>{c._OrtReleaseTensor(le)}},"gpu-buffer"])}else{let N=zr(j),G=new N(Q);new Uint8Array(G.buffer,G.byteOffset,G.byteLength).set(c.HEAPU8.subarray(Z,Z+G.byteLength)),ce.push([j,pe,G,"cpu"])}}finally{c.stackRestore(Pe),j==="string"&&Z&&c._free(Z),me||c._OrtReleaseTensor(le)}}return b&&c._OrtClearBoundOutputs(b.handle),ce}finally{c.stackRestore(X),_.forEach(D=>c._OrtReleaseTensor(D)),M.forEach(D=>c._OrtReleaseTensor(D)),L.forEach(D=>c._free(D)),x!==0&&c._OrtReleaseRunOptions(x),O.forEach(D=>c._free(D))}},qr=n=>{let i=z(),r=Re.get(n);if(!r)throw new Error("invalid session id");let u=r[0],s=i._OrtEndProfiling(u);s===0&&W("Can't get an profile file name."),i._OrtFree(s)}});var ai,Jr,Zr,Kr,Qr,St,en,tn,rn,Tt=R(()=>{"use strict";Ae();Xr();Oe();ai=typeof document<"u"?document?.currentScript?.src:void 0,Jr=async()=>Rr($.wasm),Zr=async n=>{await jr(n)},Kr=async n=>vt(n),Qr=async(n,i)=>Et(n,i),St=async(n,i)=>Gr(n,i),en=async n=>{Yr(n)},tn=async(n,i,r,u,s,h)=>Vr(n,i,r,u,s,h),rn=async n=>{qr(n)}});var nn,tt,on,Jn,rt,an=R(()=>{"use strict";Ae();Tt();bt();on=(n,i)=>{switch(n.location){case"cpu":return[n.type,n.dims,n.data,"cpu"];case"gpu-buffer":return[n.type,n.dims,{gpuBuffer:n.gpuBuffer},"gpu-buffer"];default:throw new Error(`invalid data location: ${n.location} for ${i()}`)}},Jn=n=>{switch(n[3]){case"cpu":return new oe(n[0],n[2],n[1]);case"gpu-buffer":{let i=n[0];if(!et(i))throw new Error(`not supported data type: ${i} for deserializing GPU tensor`);let{gpuBuffer:r,download:u,dispose:s}=n[2];return oe.fromGpuBuffer(r,{dataType:i,dims:n[1],download:u,dispose:s})}default:throw new Error(`invalid data location: ${n[3]}`)}},rt=class{async createSessionAllocate(i){let r=await fetch(i);if(r.status!==200)throw new Error(`failed to load model: ${i}`);let u=await r.arrayBuffer();return Kr(new Uint8Array(u))}async loadModel(i,r){if(nn||(tt||(tt=Zr($)),await tt,tt=void 0,nn=!0),typeof i=="string")if(typeof process<"u"&&process.versions&&process.versions.node){let u=await(void 0)(i);[this.sessionId,this.inputNames,this.outputNames]=await St(u,r)}else{let u=await this.createSessionAllocate(i);[this.sessionId,this.inputNames,this.outputNames]=await Qr(u,r)}else[this.sessionId,this.inputNames,this.outputNames]=await St(i,r)}async dispose(){return en(this.sessionId)}async run(i,r,u){let s=[],h=[];Object.entries(i).forEach(w=>{let S=w[0],x=w[1],O=this.inputNames.indexOf(S);if(O===-1)throw new Error(`invalid input '${S}'`);s.push(x),h.push(O)});let c=[],p=[];Object.entries(r).forEach(w=>{let S=w[0],x=w[1],O=this.outputNames.indexOf(S);if(O===-1)throw new Error(`invalid output '${S}'`);c.push(x),p.push(O)});let m=s.map((w,S)=>on(w,()=>`input "${this.inputNames[h[S]]}"`)),d=c.map((w,S)=>w?on(w,()=>`output "${this.outputNames[p[S]]}"`):null),y=await tn(this.sessionId,h,m,p,d,u),b={};for(let w=0;w<y.length;w++)b[this.outputNames[p[w]]]=c[w]??Jn(y[w]);return b}startProfiling(){}endProfiling(){rn(this.sessionId)}}});var un={};Ge(un,{initializeFlags:()=>sn,wasmBackend:()=>Zn});var sn,At,Zn,fn=R(()=>{"use strict";Ae();Tt();an();sn=()=>{if((typeof $.wasm.initTimeout!="number"||$.wasm.initTimeout<0)&&($.wasm.initTimeout=0),typeof $.wasm.simd!="boolean"&&($.wasm.simd=!0),typeof $.wasm.proxy!="boolean"&&($.wasm.proxy=!1),typeof $.wasm.numThreads!="number"||!Number.isInteger($.wasm.numThreads)||$.wasm.numThreads<=0){let n=typeof navigator>"u"?(void 0)().length:navigator.hardwareConcurrency;$.wasm.numThreads=Math.min(4,Math.ceil((n||1)/2))}},At=class{async init(){sn(),await Jr()}async createInferenceSessionHandler(i,r){let u=new rt;return await u.loadModel(i,r),Promise.resolve(u)}},Zn=new At});var Kn={};Ge(Kn,{InferenceSession:()=>Mn,Tensor:()=>oe,TrainingSession:()=>Ln,env:()=>$,registerBackend:()=>we});Ae();Ae();var Ar="1.17.0";{let n=(fn(),Ye(un)).wasmBackend;we("cpu",n,10),we("wasm",n,10),we("xnnpack",n,9),we("webnn",n,9)}Object.defineProperty($.versions,"web",{value:Ar,enumerable:!0});return Ye(Kn);})();
//# sourceMappingURL=ort.wasm-core.min.js.map
