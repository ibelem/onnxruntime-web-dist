/*!
 * ONNX Runtime Web v1.17.0
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */
var ht=Object.defineProperty;var Mn=Object.getOwnPropertyDescriptor;var Fn=Object.getOwnPropertyNames;var kn=Object.prototype.hasOwnProperty;var D=(o,n)=>()=>(o&&(n=o(o=0)),n);var Wn=(o,n)=>()=>(n||o((n={exports:{}}).exports,n),n.exports),Ye=(o,n)=>{for(var r in n)ht(o,r,{get:n[r],enumerable:!0})},Nn=(o,n,r,u)=>{if(n&&typeof n=="object"||typeof n=="function")for(let a of Fn(n))!kn.call(o,a)&&a!==r&&ht(o,a,{get:()=>n[a],enumerable:!(u=Mn(n,a))||u.enumerable});return o};var yt=o=>Nn(ht({},"__esModule",{value:!0}),o);var Ve,we,Ue,qe,Xe=D(()=>{Ve=new Map,we=[],Ue=(o,n,r)=>{if(n&&typeof n.init=="function"&&typeof n.createInferenceSessionHandler=="function"){let u=Ve.get(o);if(u===void 0)Ve.set(o,{backend:n,priority:r});else{if(u.priority>r)return;if(u.priority===r&&u.backend!==n)throw new Error(`cannot register backend "${o}" using priority ${r}`)}if(r>=0){let a=we.indexOf(o);a!==-1&&we.splice(a,1);for(let l=0;l<we.length;l++)if(Ve.get(we[l]).priority<=r){we.splice(l,0,o);return}we.push(o)}return}throw new TypeError("not a valid backend")},qe=async o=>{let n=o.length===0?we:o,r=[];for(let u of n){let a=Ve.get(u);if(a){if(a.initialized)return a.backend;if(a.aborted)continue;let l=!!a.initPromise;try{return l||(a.initPromise=a.backend.init(u)),await a.initPromise,a.initialized=!0,a.backend}catch(f){l||r.push({name:u,err:f}),a.aborted=!0}finally{delete a.initPromise}}}throw new Error(`no available backend found. ERR: ${r.map(u=>`[${u.name}] ${u.err}`).join(", ")}`)}});var or=D(()=>{Xe()});var ir,ar=D(()=>{ir="1.17.0"});var sr,be,gt=D(()=>{ar();sr="warning",be={wasm:{},webgl:{},webgpu:{},versions:{common:ir},set logLevel(o){if(o!==void 0){if(typeof o!="string"||["verbose","info","warning","error","fatal"].indexOf(o)===-1)throw new Error(`Unsupported logging level: ${o}`);sr=o}},get logLevel(){return sr}};Object.defineProperty(be,"logLevel",{enumerable:!0})});var N,ur=D(()=>{gt();N=be});var fr,cr,lr=D(()=>{fr=(o,n)=>{let r=typeof document<"u"?document.createElement("canvas"):new OffscreenCanvas(1,1);r.width=o.dims[3],r.height=o.dims[2];let u=r.getContext("2d");if(u!=null){let a,l;n?.tensorLayout!==void 0&&n.tensorLayout==="NHWC"?(a=o.dims[2],l=o.dims[3]):(a=o.dims[3],l=o.dims[2]);let f=n?.format!==void 0?n.format:"RGB",p=n?.norm,y,m;p===void 0||p.mean===void 0?y=[255,255,255,255]:typeof p.mean=="number"?y=[p.mean,p.mean,p.mean,p.mean]:(y=[p.mean[0],p.mean[1],p.mean[2],0],p.mean[3]!==void 0&&(y[3]=p.mean[3])),p===void 0||p.bias===void 0?m=[0,0,0,0]:typeof p.bias=="number"?m=[p.bias,p.bias,p.bias,p.bias]:(m=[p.bias[0],p.bias[1],p.bias[2],0],p.bias[3]!==void 0&&(m[3]=p.bias[3]));let g=l*a,b=0,h=g,E=g*2,O=-1;f==="RGBA"?(b=0,h=g,E=g*2,O=g*3):f==="RGB"?(b=0,h=g,E=g*2):f==="RBG"&&(b=0,E=g,h=g*2);for(let I=0;I<l;I++)for(let L=0;L<a;L++){let B=(o.data[b++]-m[0])*y[0],C=(o.data[h++]-m[1])*y[1],H=(o.data[E++]-m[2])*y[2],z=O===-1?255:(o.data[O++]-m[3])*y[3];u.fillStyle="rgba("+B+","+C+","+H+","+z+")",u.fillRect(L,I,1,1)}if("toDataURL"in r)return r.toDataURL();throw new Error("toDataURL is not supported")}else throw new Error("Can not access image data")},cr=(o,n)=>{let r=typeof document<"u"?document.createElement("canvas").getContext("2d"):new OffscreenCanvas(1,1).getContext("2d"),u;if(r!=null){let a,l,f;n?.tensorLayout!==void 0&&n.tensorLayout==="NHWC"?(a=o.dims[2],l=o.dims[1],f=o.dims[3]):(a=o.dims[3],l=o.dims[2],f=o.dims[1]);let p=n!==void 0&&n.format!==void 0?n.format:"RGB",y=n?.norm,m,g;y===void 0||y.mean===void 0?m=[255,255,255,255]:typeof y.mean=="number"?m=[y.mean,y.mean,y.mean,y.mean]:(m=[y.mean[0],y.mean[1],y.mean[2],255],y.mean[3]!==void 0&&(m[3]=y.mean[3])),y===void 0||y.bias===void 0?g=[0,0,0,0]:typeof y.bias=="number"?g=[y.bias,y.bias,y.bias,y.bias]:(g=[y.bias[0],y.bias[1],y.bias[2],0],y.bias[3]!==void 0&&(g[3]=y.bias[3]));let b=l*a;if(n!==void 0&&(n.format!==void 0&&f===4&&n.format!=="RGBA"||f===3&&n.format!=="RGB"&&n.format!=="BGR"))throw new Error("Tensor format doesn't match input tensor dims");let h=4,E=0,O=1,I=2,L=3,B=0,C=b,H=b*2,z=-1;p==="RGBA"?(B=0,C=b,H=b*2,z=b*3):p==="RGB"?(B=0,C=b,H=b*2):p==="RBG"&&(B=0,H=b,C=b*2),u=r.createImageData(a,l);for(let M=0;M<l*a;E+=h,O+=h,I+=h,L+=h,M++)u.data[E]=(o.data[B++]-g[0])*m[0],u.data[O]=(o.data[C++]-g[1])*m[1],u.data[I]=(o.data[H++]-g[2])*m[2],u.data[L]=z===-1?255:(o.data[z++]-g[3])*m[3]}else throw new Error("Can not access image data");return u}});var wt,dr,pr,mr,hr,yr=D(()=>{Je();wt=(o,n)=>{if(o===void 0)throw new Error("Image buffer must be defined");if(n.height===void 0||n.width===void 0)throw new Error("Image height and width must be defined");if(n.tensorLayout==="NHWC")throw new Error("NHWC Tensor layout is not supported yet");let{height:r,width:u}=n,a=n.norm??{mean:255,bias:0},l,f;typeof a.mean=="number"?l=[a.mean,a.mean,a.mean,a.mean]:l=[a.mean[0],a.mean[1],a.mean[2],a.mean[3]??255],typeof a.bias=="number"?f=[a.bias,a.bias,a.bias,a.bias]:f=[a.bias[0],a.bias[1],a.bias[2],a.bias[3]??0];let p=n.format!==void 0?n.format:"RGBA",y=n.tensorFormat!==void 0&&n.tensorFormat!==void 0?n.tensorFormat:"RGB",m=r*u,g=y==="RGBA"?new Float32Array(m*4):new Float32Array(m*3),b=4,h=0,E=1,O=2,I=3,L=0,B=m,C=m*2,H=-1;p==="RGB"&&(b=3,h=0,E=1,O=2,I=-1),y==="RGBA"?H=m*3:y==="RBG"?(L=0,C=m,B=m*2):y==="BGR"&&(C=0,B=m,L=m*2);for(let M=0;M<m;M++,h+=b,O+=b,E+=b,I+=b)g[L++]=(o[h]+f[0])/l[0],g[B++]=(o[E]+f[1])/l[1],g[C++]=(o[O]+f[2])/l[2],H!==-1&&I!==-1&&(g[H++]=(o[I]+f[3])/l[3]);return y==="RGBA"?new J("float32",g,[1,4,r,u]):new J("float32",g,[1,3,r,u])},dr=async(o,n)=>{let r=typeof HTMLImageElement<"u"&&o instanceof HTMLImageElement,u=typeof ImageData<"u"&&o instanceof ImageData,a=typeof ImageBitmap<"u"&&o instanceof ImageBitmap,l=typeof o=="string",f,p=n??{},y=()=>{if(typeof document<"u")return document.createElement("canvas");if(typeof OffscreenCanvas<"u")return new OffscreenCanvas(1,1);throw new Error("Canvas is not supported")},m=g=>g instanceof HTMLCanvasElement||g instanceof OffscreenCanvas?g.getContext("2d"):null;if(r){let g=y();g.width=o.width,g.height=o.height;let b=m(g);if(b!=null){let h=o.height,E=o.width;if(n!==void 0&&n.resizedHeight!==void 0&&n.resizedWidth!==void 0&&(h=n.resizedHeight,E=n.resizedWidth),n!==void 0){if(p=n,n.tensorFormat!==void 0)throw new Error("Image input config format must be RGBA for HTMLImageElement");p.tensorFormat="RGBA",p.height=h,p.width=E}else p.tensorFormat="RGBA",p.height=h,p.width=E;b.drawImage(o,0,0),f=b.getImageData(0,0,E,h).data}else throw new Error("Can not access image data")}else if(u){let g,b;if(n!==void 0&&n.resizedWidth!==void 0&&n.resizedHeight!==void 0?(g=n.resizedHeight,b=n.resizedWidth):(g=o.height,b=o.width),n!==void 0&&(p=n),p.format="RGBA",p.height=g,p.width=b,n!==void 0){let h=y();h.width=b,h.height=g;let E=m(h);if(E!=null)E.putImageData(o,0,0),f=E.getImageData(0,0,b,g).data;else throw new Error("Can not access image data")}else f=o.data}else if(a){if(n===void 0)throw new Error("Please provide image config with format for Imagebitmap");let g=y();g.width=o.width,g.height=o.height;let b=m(g);if(b!=null){let h=o.height,E=o.width;return b.drawImage(o,0,0,E,h),f=b.getImageData(0,0,E,h).data,p.height=h,p.width=E,wt(f,p)}else throw new Error("Can not access image data")}else{if(l)return new Promise((g,b)=>{let h=y(),E=m(h);if(!o||!E)return b();let O=new Image;O.crossOrigin="Anonymous",O.src=o,O.onload=()=>{h.width=O.width,h.height=O.height,E.drawImage(O,0,0,h.width,h.height);let I=E.getImageData(0,0,h.width,h.height);p.height=h.height,p.width=h.width,g(wt(I.data,p))}});throw new Error("Input data provided is not supported - aborted tensor creation")}if(f!==void 0)return wt(f,p);throw new Error("Input data provided is not supported - aborted tensor creation")},pr=(o,n)=>{let{width:r,height:u,download:a,dispose:l}=n,f=[1,u,r,4];return new J({location:"texture",type:"float32",texture:o,dims:f,download:a,dispose:l})},mr=(o,n)=>{let{dataType:r,dims:u,download:a,dispose:l}=n;return new J({location:"gpu-buffer",type:r??"float32",gpuBuffer:o,dims:u,download:a,dispose:l})},hr=(o,n,r)=>new J({location:"cpu-pinned",type:o,data:n,dims:r??[n.length]})});var De,Ze,gr,wr,br=D(()=>{De=new Map([["float32",Float32Array],["uint8",Uint8Array],["int8",Int8Array],["uint16",Uint16Array],["float16",Uint16Array],["int16",Int16Array],["int32",Int32Array],["bool",Uint8Array],["float64",Float64Array],["uint32",Uint32Array]]),Ze=new Map([[Float32Array,"float32"],[Uint8Array,"uint8"],[Int8Array,"int8"],[Uint16Array,"uint16"],[Int16Array,"int16"],[Int32Array,"int32"],[Float64Array,"float64"],[Uint32Array,"uint32"]]),gr=!1,wr=()=>{if(!gr){gr=!0;let o=typeof BigInt64Array<"u"&&typeof BigInt64Array.from=="function",n=typeof BigUint64Array<"u"&&typeof BigUint64Array.from=="function";o&&(De.set("int64",BigInt64Array),Ze.set(BigInt64Array,"int64")),n&&(De.set("uint64",BigUint64Array),Ze.set(BigUint64Array,"uint64"))}}});var Er,vr,Tr=D(()=>{Je();Er=o=>{let n=1;for(let r=0;r<o.length;r++){let u=o[r];if(typeof u!="number"||!Number.isSafeInteger(u))throw new TypeError(`dims[${r}] must be an integer, got: ${u}`);if(u<0)throw new RangeError(`dims[${r}] must be a non-negative integer, got: ${u}`);n*=u}return n},vr=(o,n)=>{switch(o.location){case"cpu":return new J(o.type,o.data,n);case"cpu-pinned":return new J({location:"cpu-pinned",data:o.data,type:o.type,dims:n});case"texture":return new J({location:"texture",texture:o.texture,type:o.type,dims:n});case"gpu-buffer":return new J({location:"gpu-buffer",gpuBuffer:o.gpuBuffer,type:o.type,dims:n});default:throw new Error(`tensorReshape: tensor location ${o.location} is not supported`)}}});var J,Je=D(()=>{lr();yr();br();Tr();J=class{constructor(n,r,u){wr();let a,l;if(typeof n=="object"&&"location"in n)switch(this.dataLocation=n.location,a=n.type,l=n.dims,n.location){case"cpu-pinned":{let p=De.get(a);if(!p)throw new TypeError(`unsupported type "${a}" to create tensor from pinned buffer`);if(!(n.data instanceof p))throw new TypeError(`buffer should be of type ${p.name}`);this.cpuData=n.data;break}case"texture":{if(a!=="float32")throw new TypeError(`unsupported type "${a}" to create tensor from texture`);this.gpuTextureData=n.texture,this.downloader=n.download,this.disposer=n.dispose;break}case"gpu-buffer":{if(a!=="float32"&&a!=="float16"&&a!=="int32"&&a!=="int64"&&a!=="uint32"&&a!=="bool")throw new TypeError(`unsupported type "${a}" to create tensor from gpu buffer`);this.gpuBufferData=n.gpuBuffer,this.downloader=n.download,this.disposer=n.dispose;break}default:throw new Error(`Tensor constructor: unsupported location '${this.dataLocation}'`)}else{let p,y;if(typeof n=="string")if(a=n,y=u,n==="string"){if(!Array.isArray(r))throw new TypeError("A string tensor's data must be a string array.");p=r}else{let m=De.get(n);if(m===void 0)throw new TypeError(`Unsupported tensor type: ${n}.`);if(Array.isArray(r)){if(n==="float16")throw new TypeError("Creating a float16 tensor from number array is not supported. Please use Uint16Array as data.");n==="uint64"||n==="int64"?p=m.from(r,BigInt):p=m.from(r)}else if(r instanceof m)p=r;else throw new TypeError(`A ${a} tensor's data must be type of ${m}`)}else if(y=r,Array.isArray(n)){if(n.length===0)throw new TypeError("Tensor type cannot be inferred from an empty array.");let m=typeof n[0];if(m==="string")a="string",p=n;else if(m==="boolean")a="bool",p=Uint8Array.from(n);else throw new TypeError(`Invalid element type of data array: ${m}.`)}else{let m=Ze.get(n.constructor);if(m===void 0)throw new TypeError(`Unsupported type for tensor data: ${n.constructor}.`);a=m,p=n}if(y===void 0)y=[p.length];else if(!Array.isArray(y))throw new TypeError("A tensor's dims must be a number array");l=y,this.cpuData=p,this.dataLocation="cpu"}let f=Er(l);if(this.cpuData&&f!==this.cpuData.length)throw new Error(`Tensor's size(${f}) does not match data length(${this.cpuData.length}).`);this.type=a,this.dims=l,this.size=f}static async fromImage(n,r){return dr(n,r)}static fromTexture(n,r){return pr(n,r)}static fromGpuBuffer(n,r){return mr(n,r)}static fromPinnedBuffer(n,r,u){return hr(n,r,u)}toDataURL(n){return fr(this,n)}toImageData(n){return cr(this,n)}get data(){if(this.ensureValid(),!this.cpuData)throw new Error("The data is not on CPU. Use `getData()` to download GPU data to CPU, or use `texture` or `gpuBuffer` property to access the GPU data directly.");return this.cpuData}get location(){return this.dataLocation}get texture(){if(this.ensureValid(),!this.gpuTextureData)throw new Error("The data is not stored as a WebGL texture.");return this.gpuTextureData}get gpuBuffer(){if(this.ensureValid(),!this.gpuBufferData)throw new Error("The data is not stored as a WebGPU buffer.");return this.gpuBufferData}async getData(n){switch(this.ensureValid(),this.dataLocation){case"cpu":case"cpu-pinned":return this.data;case"texture":case"gpu-buffer":{if(!this.downloader)throw new Error("The current tensor is not created with a specified data downloader.");if(this.isDownloading)throw new Error("The current tensor is being downloaded.");try{this.isDownloading=!0;let r=await this.downloader();return this.downloader=void 0,this.dataLocation="cpu",this.cpuData=r,n&&this.disposer&&(this.disposer(),this.disposer=void 0),r}finally{this.isDownloading=!1}}default:throw new Error(`cannot get data from location: ${this.dataLocation}`)}}dispose(){if(this.isDownloading)throw new Error("The current tensor is being downloaded.");this.disposer&&(this.disposer(),this.disposer=void 0),this.cpuData=void 0,this.gpuTextureData=void 0,this.gpuBufferData=void 0,this.downloader=void 0,this.isDownloading=void 0,this.dataLocation="none"}ensureValid(){if(this.dataLocation==="none")throw new Error("The tensor is disposed.")}reshape(n){if(this.ensureValid(),this.downloader||this.disposer)throw new Error("Cannot reshape a tensor that owns GPU resource.");return vr(this,n)}}});var Y,Ke=D(()=>{Je();Y=J});var Ar,Sr,Ee,ve,bt=D(()=>{gt();Ar=(o,n)=>{be.wasm.trace&&console.timeStamp(`${o}::ORT::${n}`)},Sr=(o,n)=>{let r=new Error().stack?.split(/\r\n|\r|\n/g)||[],u=!1;for(let a=0;a<r.length;a++){if(u&&!r[a].includes("TRACE_FUNC")){let l=`FUNC_${o}::${r[a].trim().split(" ")[1]}`;n&&(l+=`::${n}`),Ar("CPU",l);return}r[a].includes("TRACE_FUNC")&&(u=!0)}},Ee=o=>{be.wasm.trace&&Sr("BEGIN",o)},ve=o=>{be.wasm.trace&&Sr("END",o)}});var Qe,Or=D(()=>{Xe();Ke();bt();Qe=class o{constructor(n){this.handler=n}async run(n,r,u){Ee();let a={},l={};if(typeof n!="object"||n===null||n instanceof Y||Array.isArray(n))throw new TypeError("'feeds' must be an object that use input names as keys and OnnxValue as corresponding values.");let f=!0;if(typeof r=="object"){if(r===null)throw new TypeError("Unexpected argument[1]: cannot be null.");if(r instanceof Y)throw new TypeError("'fetches' cannot be a Tensor");if(Array.isArray(r)){if(r.length===0)throw new TypeError("'fetches' cannot be an empty array.");f=!1;for(let m of r){if(typeof m!="string")throw new TypeError("'fetches' must be a string array or an object.");if(this.outputNames.indexOf(m)===-1)throw new RangeError(`'fetches' contains invalid output name: ${m}.`);a[m]=null}if(typeof u=="object"&&u!==null)l=u;else if(typeof u<"u")throw new TypeError("'options' must be an object.")}else{let m=!1,g=Object.getOwnPropertyNames(r);for(let b of this.outputNames)if(g.indexOf(b)!==-1){let h=r[b];(h===null||h instanceof Y)&&(m=!0,f=!1,a[b]=h)}if(m){if(typeof u=="object"&&u!==null)l=u;else if(typeof u<"u")throw new TypeError("'options' must be an object.")}else l=r}}else if(typeof r<"u")throw new TypeError("Unexpected argument[1]: must be 'fetches' or 'options'.");for(let m of this.inputNames)if(typeof n[m]>"u")throw new Error(`input '${m}' is missing in 'feeds'.`);if(f)for(let m of this.outputNames)a[m]=null;let p=await this.handler.run(n,a,l),y={};for(let m in p)if(Object.hasOwnProperty.call(p,m)){let g=p[m];g instanceof Y?y[m]=g:y[m]=new Y(g.type,g.data,g.dims)}return ve(),y}async release(){return this.handler.dispose()}static async create(n,r,u,a){Ee();let l,f={};if(typeof n=="string"){if(l=n,typeof r=="object"&&r!==null)f=r;else if(typeof r<"u")throw new TypeError("'options' must be an object.")}else if(n instanceof Uint8Array){if(l=n,typeof r=="object"&&r!==null)f=r;else if(typeof r<"u")throw new TypeError("'options' must be an object.")}else if(n instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&n instanceof SharedArrayBuffer){let b=n,h=0,E=n.byteLength;if(typeof r=="object"&&r!==null)f=r;else if(typeof r=="number"){if(h=r,!Number.isSafeInteger(h))throw new RangeError("'byteOffset' must be an integer.");if(h<0||h>=b.byteLength)throw new RangeError(`'byteOffset' is out of range [0, ${b.byteLength}).`);if(E=n.byteLength-h,typeof u=="number"){if(E=u,!Number.isSafeInteger(E))throw new RangeError("'byteLength' must be an integer.");if(E<=0||h+E>b.byteLength)throw new RangeError(`'byteLength' is out of range (0, ${b.byteLength-h}].`);if(typeof a=="object"&&a!==null)f=a;else if(typeof a<"u")throw new TypeError("'options' must be an object.")}else if(typeof u<"u")throw new TypeError("'byteLength' must be a number.")}else if(typeof r<"u")throw new TypeError("'options' must be an object.");l=new Uint8Array(b,h,E)}else throw new TypeError("Unexpected argument[0]: must be 'path' or 'buffer'.");let y=(f.executionProviders||[]).map(b=>typeof b=="string"?b:b.name),g=await(await qe(y)).createInferenceSessionHandler(l,f);return ve(),new o(g)}startProfiling(){this.handler.startProfiling()}endProfiling(){this.handler.endProfiling()}get inputNames(){return this.handler.inputNames}get outputNames(){return this.handler.outputNames}}});var $n,xr=D(()=>{Or();$n=Qe});var Pr=D(()=>{});var jn,et,Ir=D(()=>{Xe();Ke();jn="Training backend could not be resolved. Make sure you're using the correct configuration & WebAssembly files.",et=class o{constructor(n,r,u){this.handler=n,this.hasOptimizerModel=r,this.hasEvalModel=u}get trainingInputNames(){return this.handler.inputNames}get trainingOutputNames(){return this.handler.outputNames}get evalInputNames(){if(this.hasEvalModel)return this.handler.evalInputNames;throw new Error("This training session has no evalModel loaded.")}get evalOutputNames(){if(this.hasEvalModel)return this.handler.evalOutputNames;throw new Error("This training session has no evalModel loaded.")}static async create(n,r){let u=n.evalModel||"",a=n.optimizerModel||"",l=r||{},p=(l.executionProviders||[]).map(m=>typeof m=="string"?m:m.name),y=await qe(p);if(y.createTrainingSessionHandler){let m=await y.createTrainingSessionHandler(n.checkpointState,n.trainModel,u,a,l);return new o(m,!!n.optimizerModel,!!n.evalModel)}else throw new Error(jn)}typeNarrowingForRunStep(n,r,u,a,l){let f={},p={};if(typeof u!="object"||u===null||u instanceof Y||Array.isArray(u))throw new TypeError("'feeds' must be an object that use input names as keys and OnnxValue as corresponding values.");let y=!0;if(typeof a=="object"){if(a===null)throw new TypeError("Unexpected argument[1]: cannot be null.");if(a instanceof Y)throw new TypeError("'fetches' cannot be a Tensor");if(Array.isArray(a)){if(a.length===0)throw new TypeError("'fetches' cannot be an empty array.");y=!1;for(let m of a){if(typeof m!="string")throw new TypeError("'fetches' must be a string array or an object.");if(r.indexOf(m)===-1)throw new RangeError(`'fetches' contains invalid output name: ${m}.`);f[m]=null}if(typeof l=="object"&&l!==null)p=l;else if(typeof l<"u")throw new TypeError("'options' must be an object.")}else{let m=!1,g=Object.getOwnPropertyNames(a);for(let b of r)if(g.indexOf(b)!==-1){let h=a[b];(h===null||h instanceof Y)&&(m=!0,y=!1,f[b]=h)}if(m){if(typeof l=="object"&&l!==null)p=l;else if(typeof l<"u")throw new TypeError("'options' must be an object.")}else p=a}}else if(typeof a<"u")throw new TypeError("Unexpected argument[1]: must be 'fetches' or 'options'.");for(let m of n)if(typeof u[m]>"u")throw new Error(`input '${m}' is missing in 'feeds'.`);if(y)for(let m of r)f[m]=null;return[f,p]}convertHandlerReturnTypeToMapOfTensors(n){let r={};for(let u in n)if(Object.hasOwnProperty.call(n,u)){let a=n[u];a instanceof Y?r[u]=a:r[u]=new Y(a.type,a.data,a.dims)}return r}async lazyResetGrad(){await this.handler.lazyResetGrad()}async runTrainStep(n,r,u){let[a,l]=this.typeNarrowingForRunStep(this.trainingInputNames,this.trainingOutputNames,n,r,u),f=await this.handler.runTrainStep(n,a,l);return this.convertHandlerReturnTypeToMapOfTensors(f)}async runOptimizerStep(n){if(this.hasOptimizerModel)await this.handler.runOptimizerStep(n||{});else throw new Error("This TrainingSession has no OptimizerModel loaded.")}async runEvalStep(n,r,u){if(this.hasEvalModel){let[a,l]=this.typeNarrowingForRunStep(this.evalInputNames,this.evalOutputNames,n,r,u),f=await this.handler.runEvalStep(n,a,l);return this.convertHandlerReturnTypeToMapOfTensors(f)}else throw new Error("This TrainingSession has no EvalModel loaded.")}async getParametersSize(n=!0){return this.handler.getParametersSize(n)}async loadParametersBuffer(n,r=!0){let u=await this.getParametersSize(r);if(n.length!==4*u)throw new Error("Size of the buffer passed into loadParametersBuffer must match the number of parameters in the model. Please use getParametersSize method to check.");return this.handler.loadParametersBuffer(n,r)}async getContiguousParameters(n=!0){return this.handler.getContiguousParameters(n)}async release(){return this.handler.dispose()}}});var Hn,Br=D(()=>{Ir();Hn=et});var Et={};Ye(Et,{InferenceSession:()=>$n,TRACE:()=>Ar,TRACE_FUNC_BEGIN:()=>Ee,TRACE_FUNC_END:()=>ve,Tensor:()=>Y,TrainingSession:()=>Hn,env:()=>N,registerBackend:()=>Ue});var Te=D(()=>{or();ur();xr();Ke();bt();Pr();Br()});var Ur={};Ye(Ur,{createReadStream:()=>_r,readFile:()=>zn,readFileSync:()=>Gn});var zn,Gn,_r,Dr=D(()=>{zn=void 0,Gn=void 0,_r=void 0});var Rr={};Ye(Rr,{join:()=>Yn});var Yn,Lr=D(()=>{Yn=void 0});var kr=Wn((Fr,vt)=>{"use strict";var Mr=(()=>{var o=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return typeof __filename<"u"&&(o=o||__filename),function(n={}){var r=n,u,a;r.ready=new Promise((e,t)=>{u=e,a=t});var l=Object.assign({},r),f="./this.program",p=typeof window=="object",y=typeof importScripts=="function",m=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",g="",b,h,E;if(m){var O=(Dr(),yt(Ur)),I=(Lr(),yt(Rr));g=y?I.dirname(g)+"/":__dirname+"/",b=(e,t)=>(e=he(e)?new URL(e):I.normalize(e),O.readFileSync(e,t?void 0:"utf8")),E=e=>(e=b(e,!0),e.buffer||(e=new Uint8Array(e)),e),h=(e,t,i,s=!0)=>{e=he(e)?new URL(e):I.normalize(e),O.readFile(e,s?void 0:"utf8",(c,w)=>{c?i(c):t(s?w.buffer:w)})},!r.thisProgram&&1<process.argv.length&&(f=process.argv[1].replace(/\\/g,"/")),process.argv.slice(2),r.inspect=()=>"[Emscripten Module object]"}else(p||y)&&(y?g=self.location.href:typeof document<"u"&&document.currentScript&&(g=document.currentScript.src),o&&(g=o),g.indexOf("blob:")!==0?g=g.substr(0,g.replace(/[?#].*/,"").lastIndexOf("/")+1):g="",b=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},y&&(E=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),h=(e,t,i)=>{var s=new XMLHttpRequest;s.open("GET",e,!0),s.responseType="arraybuffer",s.onload=()=>{s.status==200||s.status==0&&s.response?t(s.response):i()},s.onerror=i,s.send(null)});var L=console.log.bind(console),B=console.error.bind(console);Object.assign(r,l),l=null,typeof WebAssembly!="object"&&ke("no native wasm support detected");var C,H=!1,z,M,oe,pe,v,R,Fe,xe,Pe,ie;function _(){var e=C.buffer;r.HEAP8=z=new Int8Array(e),r.HEAP16=oe=new Int16Array(e),r.HEAPU8=M=new Uint8Array(e),r.HEAPU16=pe=new Uint16Array(e),r.HEAP32=v=new Int32Array(e),r.HEAPU32=R=new Uint32Array(e),r.HEAPF32=Fe=new Float32Array(e),r.HEAPF64=ie=new Float64Array(e),r.HEAP64=xe=new BigInt64Array(e),r.HEAPU64=Pe=new BigUint64Array(e)}var ae=[],Ae=[],te=[],re=0,G=null,V=null;function ke(e){throw e="Aborted("+e+")",B(e),H=!0,e=new WebAssembly.RuntimeError(e+". Build with -sASSERTIONS for more info."),a(e),e}var me=e=>e.startsWith("data:application/octet-stream;base64,"),he=e=>e.startsWith("file://"),ce;if(ce="ort-wasm.wasm",!me(ce)){var We=ce;ce=r.locateFile?r.locateFile(We,g):g+We}function le(e){if(E)return E(e);throw"both async and sync fetching of the wasm failed"}function ye(e){if(p||y){if(typeof fetch=="function"&&!he(e))return fetch(e,{credentials:"same-origin"}).then(t=>{if(!t.ok)throw"failed to load wasm binary file at '"+e+"'";return t.arrayBuffer()}).catch(()=>le(e));if(h)return new Promise((t,i)=>{h(e,s=>t(new Uint8Array(s)),i)})}return Promise.resolve().then(()=>le(e))}function Ie(e,t,i){return ye(e).then(s=>WebAssembly.instantiate(s,t)).then(s=>s).then(i,s=>{B(`failed to asynchronously prepare wasm: ${s}`),ke(s)})}function q(e,t){var i=ce;return typeof WebAssembly.instantiateStreaming!="function"||me(i)||he(i)||m||typeof fetch!="function"?Ie(i,e,t):fetch(i,{credentials:"same-origin"}).then(s=>WebAssembly.instantiateStreaming(s,e).then(t,function(c){return B(`wasm streaming compile failed: ${c}`),B("falling back to ArrayBuffer instantiation"),Ie(i,e,t)}))}var X={1358152:(e,t,i,s)=>{if(typeof r>"u"||!r.cb)return 1;if(e=_e(e>>>0),e.startsWith("./")&&(e=e.substring(2)),e=r.cb.get(e),!e)return 2;if(t>>>=0,i>>>=0,t+i>e.byteLength)return 3;try{return M.set(e.subarray(t,t+i),s>>>0>>>0),0}catch{return 4}}};function Be(e){this.Ua=e-24,this.fb=function(t){R[this.Ua+4>>>2>>>0]=t},this.eb=function(t){R[this.Ua+8>>>2>>>0]=t},this.Ya=function(t,i){this.Za(),this.fb(t),this.eb(i)},this.Za=function(){R[this.Ua+16>>>2>>>0]=0}}var Ce=0,at=0,Ut=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,Dt=(e,t,i)=>{t>>>=0;var s=t+i;for(i=t;e[i]&&!(i>=s);)++i;if(16<i-t&&e.buffer&&Ut)return Ut.decode(e.subarray(t,i));for(s="";t<i;){var c=e[t++];if(c&128){var w=e[t++]&63;if((c&224)==192)s+=String.fromCharCode((c&31)<<6|w);else{var T=e[t++]&63;c=(c&240)==224?(c&15)<<12|w<<6|T:(c&7)<<18|w<<12|T<<6|e[t++]&63,65536>c?s+=String.fromCharCode(c):(c-=65536,s+=String.fromCharCode(55296|c>>10,56320|c&1023))}}else s+=String.fromCharCode(c)}return s},_e=(e,t)=>(e>>>=0)?Dt(M,e,t):"",Ne=e=>{for(var t=0,i=0;i<e.length;++i){var s=e.charCodeAt(i);127>=s?t++:2047>=s?t+=2:55296<=s&&57343>=s?(t+=4,++i):t+=3}return t},$e=(e,t,i,s)=>{if(i>>>=0,!(0<s))return 0;var c=i;s=i+s-1;for(var w=0;w<e.length;++w){var T=e.charCodeAt(w);if(55296<=T&&57343>=T){var A=e.charCodeAt(++w);T=65536+((T&1023)<<10)|A&1023}if(127>=T){if(i>=s)break;t[i++>>>0]=T}else{if(2047>=T){if(i+1>=s)break;t[i++>>>0]=192|T>>6}else{if(65535>=T){if(i+2>=s)break;t[i++>>>0]=224|T>>12}else{if(i+3>=s)break;t[i++>>>0]=240|T>>18,t[i++>>>0]=128|T>>12&63}t[i++>>>0]=128|T>>6&63}t[i++>>>0]=128|T&63}}return t[i>>>0]=0,i-c},Rt=e=>{if(e===null)return"null";var t=typeof e;return t==="object"||t==="array"||t==="function"?e.toString():""+e},Lt,ee=e=>{for(var t="";M[e>>>0];)t+=Lt[M[e++>>>0]];return t},st={},ut={},wn={},de;function bn(e,t,i={}){var s=t.name;if(!e)throw new de(`type "${s}" must have a positive integer typeid pointer`);if(ut.hasOwnProperty(e)){if(i.gb)return;throw new de(`Cannot register type '${s}' twice`)}ut[e]=t,delete wn[e],st.hasOwnProperty(e)&&(t=st[e],delete st[e],t.forEach(c=>c()))}function se(e,t,i={}){if(!("argPackAdvance"in t))throw new TypeError("registerType registeredInstance requires argPackAdvance");bn(e,t,i)}var Mt=(e,t,i)=>{switch(t){case 1:return i?s=>z[s>>>0>>>0]:s=>M[s>>>0>>>0];case 2:return i?s=>oe[s>>>1>>>0]:s=>pe[s>>>1>>>0];case 4:return i?s=>v[s>>>2>>>0]:s=>R[s>>>2>>>0];case 8:return i?s=>xe[s>>>3]:s=>Pe[s>>>3];default:throw new TypeError(`invalid integer width (${t}): ${e}`)}};function Ft(){this.Ra=[void 0],this.ab=[]}var Q=new Ft;function ft(e){e>>>=0,e>=Q.Ua&&--Q.get(e).bb===0&&Q.Za(e)}var Z=e=>{if(!e)throw new de("Cannot use deleted val. handle = "+e);return Q.get(e).value},ne=e=>{switch(e){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:return Q.Ya({bb:1,value:e})}};function kt(e){return this.fromWireType(v[e>>>2>>>0])}var En=(e,t)=>{switch(t){case 4:return function(i){return this.fromWireType(Fe[i>>>2>>>0])};case 8:return function(i){return this.fromWireType(ie[i>>>3>>>0])};default:throw new TypeError(`invalid float width (${t}): ${e}`)}};function vn(e){return this.fromWireType(R[e>>>2>>>0])}var Wt=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0,Tn=(e,t)=>{for(var i=e>>1,s=i+t/2;!(i>=s)&&pe[i>>>0];)++i;if(i<<=1,32<i-e&&Wt)return Wt.decode(M.subarray(e>>>0,i>>>0));for(i="",s=0;!(s>=t/2);++s){var c=oe[e+2*s>>>1>>>0];if(c==0)break;i+=String.fromCharCode(c)}return i},An=(e,t,i)=>{if(i??=2147483647,2>i)return 0;i-=2;var s=t;i=i<2*e.length?i/2:e.length;for(var c=0;c<i;++c)oe[t>>>1>>>0]=e.charCodeAt(c),t+=2;return oe[t>>>1>>>0]=0,t-s},Sn=e=>2*e.length,On=(e,t)=>{for(var i=0,s="";!(i>=t/4);){var c=v[e+4*i>>>2>>>0];if(c==0)break;++i,65536<=c?(c-=65536,s+=String.fromCharCode(55296|c>>10,56320|c&1023)):s+=String.fromCharCode(c)}return s},xn=(e,t,i)=>{if(t>>>=0,i??=2147483647,4>i)return 0;var s=t;i=s+i-4;for(var c=0;c<e.length;++c){var w=e.charCodeAt(c);if(55296<=w&&57343>=w){var T=e.charCodeAt(++c);w=65536+((w&1023)<<10)|T&1023}if(v[t>>>2>>>0]=w,t+=4,t+4>i)break}return v[t>>>2>>>0]=0,t-s},Pn=e=>{for(var t=0,i=0;i<e.length;++i){var s=e.charCodeAt(i);55296<=s&&57343>=s&&++i,t+=4}return t},ct=(e,t)=>{var i=ut[e];if(i===void 0)throw e=Kt(e),i=ee(e),ue(e),new de(t+" has unknown type "+i);return i},Nt=(e,t,i)=>{var s=[];return e=e.toWireType(s,i),s.length&&(R[t>>>2>>>0]=ne(s)),e},je=[],In={},lt=e=>{var t=In[e];return t===void 0?ee(e):t},$t=()=>typeof globalThis=="object"?globalThis:Function("return this")(),Bn=e=>{var t=je.length;return je.push(e),t},Cn=(e,t)=>{for(var i=Array(e),s=0;s<e;++s)i[s]=ct(R[t+4*s>>>2>>>0],"parameter "+s);return i},jt=(e,t)=>Object.defineProperty(t,"name",{value:e});function _n(e){var t=Function;if(!(t instanceof Function))throw new TypeError(`new_ called with constructor type ${typeof t} which is not a function`);var i=jt(t.name||"unknownFunctionName",function(){});return i.prototype=t.prototype,i=new i,e=t.apply(i,e),e instanceof Object?e:i}var Se=e=>e%4===0&&(e%100!==0||e%400===0),Ht=[0,31,60,91,121,152,182,213,244,274,305,335],zt=[0,31,59,90,120,151,181,212,243,273,304,334],Gt=e=>{var t=Ne(e)+1,i=ze(t);return i&&$e(e,M,i,t),i},dt=[],pt={},Yt=()=>{if(!mt){var e={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:f||"./this.program"},t;for(t in pt)pt[t]===void 0?delete e[t]:e[t]=pt[t];var i=[];for(t in e)i.push(`${t}=${e[t]}`);mt=i}return mt},mt,Un=[null,[],[]],Vt=[31,29,31,30,31,30,31,31,30,31,30,31],qt=[31,28,31,30,31,30,31,31,30,31,30,31];function Dn(e){var t=Array(Ne(e)+1);return $e(e,t,0,t.length),t}function Xt(e,t,i,s){function c(d,U,k){for(d=typeof d=="number"?d.toString():d||"";d.length<U;)d=k[0]+d;return d}function w(d,U){return c(d,U,"0")}function T(d,U){function k(nr){return 0>nr?-1:0<nr?1:0}var ge;return(ge=k(d.getFullYear()-U.getFullYear()))===0&&(ge=k(d.getMonth()-U.getMonth()))===0&&(ge=k(d.getDate()-U.getDate())),ge}function A(d){switch(d.getDay()){case 0:return new Date(d.getFullYear()-1,11,29);case 1:return d;case 2:return new Date(d.getFullYear(),0,3);case 3:return new Date(d.getFullYear(),0,2);case 4:return new Date(d.getFullYear(),0,1);case 5:return new Date(d.getFullYear()-1,11,31);case 6:return new Date(d.getFullYear()-1,11,30)}}function P(d){var U=d.Sa;for(d=new Date(new Date(d.Ta+1900,0,1).getTime());0<U;){var k=d.getMonth(),ge=(Se(d.getFullYear())?Vt:qt)[k];if(U>ge-d.getDate())U-=ge-d.getDate()+1,d.setDate(1),11>k?d.setMonth(k+1):(d.setMonth(0),d.setFullYear(d.getFullYear()+1));else{d.setDate(d.getDate()+U);break}}return k=new Date(d.getFullYear()+1,0,4),U=A(new Date(d.getFullYear(),0,4)),k=A(k),0>=T(U,d)?0>=T(k,d)?d.getFullYear()+1:d.getFullYear():d.getFullYear()-1}e>>>=0,t>>>=0,i>>>=0,s>>>=0;var S=R[s+40>>>2>>>0];s={kb:v[s>>>2>>>0],jb:v[s+4>>>2>>>0],Wa:v[s+8>>>2>>>0],$a:v[s+12>>>2>>>0],Xa:v[s+16>>>2>>>0],Ta:v[s+20>>>2>>>0],Na:v[s+24>>>2>>>0],Sa:v[s+28>>>2>>>0],mb:v[s+32>>>2>>>0],ib:v[s+36>>>2>>>0],lb:S?_e(S):""},i=_e(i),S={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"};for(var F in S)i=i.replace(new RegExp(F,"g"),S[F]);var K="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),fe="January February March April May June July August September October November December".split(" ");S={"%a":d=>K[d.Na].substring(0,3),"%A":d=>K[d.Na],"%b":d=>fe[d.Xa].substring(0,3),"%B":d=>fe[d.Xa],"%C":d=>w((d.Ta+1900)/100|0,2),"%d":d=>w(d.$a,2),"%e":d=>c(d.$a,2," "),"%g":d=>P(d).toString().substring(2),"%G":d=>P(d),"%H":d=>w(d.Wa,2),"%I":d=>(d=d.Wa,d==0?d=12:12<d&&(d-=12),w(d,2)),"%j":d=>{for(var U=0,k=0;k<=d.Xa-1;U+=(Se(d.Ta+1900)?Vt:qt)[k++]);return w(d.$a+U,3)},"%m":d=>w(d.Xa+1,2),"%M":d=>w(d.jb,2),"%n":()=>`
`,"%p":d=>0<=d.Wa&&12>d.Wa?"AM":"PM","%S":d=>w(d.kb,2),"%t":()=>"	","%u":d=>d.Na||7,"%U":d=>w(Math.floor((d.Sa+7-d.Na)/7),2),"%V":d=>{var U=Math.floor((d.Sa+7-(d.Na+6)%7)/7);if(2>=(d.Na+371-d.Sa-2)%7&&U++,U)U==53&&(k=(d.Na+371-d.Sa)%7,k==4||k==3&&Se(d.Ta)||(U=1));else{U=52;var k=(d.Na+7-d.Sa-1)%7;(k==4||k==5&&Se(d.Ta%400-1))&&U++}return w(U,2)},"%w":d=>d.Na,"%W":d=>w(Math.floor((d.Sa+7-(d.Na+6)%7)/7),2),"%y":d=>(d.Ta+1900).toString().substring(2),"%Y":d=>d.Ta+1900,"%z":d=>{d=d.ib;var U=0<=d;return d=Math.abs(d)/60,(U?"+":"-")+("0000"+(d/60*100+d%60)).slice(-4)},"%Z":d=>d.lb,"%%":()=>"%"},i=i.replace(/%%/g,"\0\0");for(F in S)i.includes(F)&&(i=i.replace(new RegExp(F,"g"),S[F](s)));return i=i.replace(/\0\0/g,"%"),F=Dn(i),F.length>t?0:(z.set(F,e>>>0),F.length-1)}for(var Jt=Array(256),He=0;256>He;++He)Jt[He]=String.fromCharCode(He);Lt=Jt,de=r.BindingError=class extends Error{constructor(e){super(e),this.name="BindingError"}},r.InternalError=class extends Error{constructor(e){super(e),this.name="InternalError"}},Object.assign(Ft.prototype,{get(e){return this.Ra[e]},has(e){return this.Ra[e]!==void 0},Ya(e){var t=this.ab.pop()||this.Ra.length;return this.Ra[t]=e,t},Za(e){this.Ra[e]=void 0,this.ab.push(e)}}),Q.Ra.push({value:void 0},{value:null},{value:!0},{value:!1}),Q.Ua=Q.Ra.length,r.count_emval_handles=()=>{for(var e=0,t=Q.Ua;t<Q.Ra.length;++t)Q.Ra[t]!==void 0&&++e;return e};var Rn={a:function(e,t,i){throw e>>>=0,new Be(e).Ya(t>>>0,i>>>0),Ce=e,at++,Ce},t:function(){return 0},$:function(){},M:function(){},O:function(){},G:function(){return 0},Z:function(){},U:function(){},Y:function(){},B:function(){},N:function(){},K:function(){},_:function(){},L:function(){},E:function(e,t,i,s,c){t>>>=0,t=ee(t);var w=t.indexOf("u")!=-1;w&&(c=(1n<<64n)-1n),se(e>>>0,{name:t,fromWireType:T=>T,toWireType:function(T,A){if(typeof A!="bigint"&&typeof A!="number")throw new TypeError(`Cannot convert "${Rt(A)}" to ${this.name}`);if(A<s||A>c)throw new TypeError(`Passing a number "${Rt(A)}" from JS side to C/C++ side to an argument of type "${t}", which is outside the valid range [${s}, ${c}]!`);return A},argPackAdvance:8,readValueFromPointer:Mt(t,i>>>0,!w),Va:null})},da:function(e,t,i,s){t=ee(t>>>0),se(e>>>0,{name:t,fromWireType:function(c){return!!c},toWireType:function(c,w){return w?i:s},argPackAdvance:8,readValueFromPointer:function(c){return this.fromWireType(M[c>>>0])},Va:null})},ca:function(e,t){t=ee(t>>>0),se(e>>>0,{name:t,fromWireType:i=>{var s=Z(i);return ft(i),s},toWireType:(i,s)=>ne(s),argPackAdvance:8,readValueFromPointer:kt,Va:null})},D:function(e,t,i){t=ee(t>>>0),se(e>>>0,{name:t,fromWireType:s=>s,toWireType:(s,c)=>c,argPackAdvance:8,readValueFromPointer:En(t,i>>>0),Va:null})},q:function(e,t,i,s,c){if(e>>>=0,i>>>=0,t=ee(t>>>0),c===-1&&(c=4294967295),c=A=>A,s===0){var w=32-8*i;c=A=>A<<w>>>w}var T=t.includes("unsigned")?function(A,P){return P>>>0}:function(A,P){return P};se(e,{name:t,fromWireType:c,toWireType:T,argPackAdvance:8,readValueFromPointer:Mt(t,i,s!==0),Va:null})},l:function(e,t,i){function s(w){return new c(z.buffer,R[w+4>>>2>>>0],R[w>>>2>>>0])}var c=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array,BigInt64Array,BigUint64Array][t];i=ee(i>>>0),se(e>>>0,{name:i,fromWireType:s,argPackAdvance:8,readValueFromPointer:s},{gb:!0})},F:function(e,t){t=ee(t>>>0);var i=t==="std::string";se(e>>>0,{name:t,fromWireType:function(s){var c=R[s>>>2>>>0],w=s+4;if(i)for(var T=w,A=0;A<=c;++A){var P=w+A;if(A==c||M[P>>>0]==0){if(T=_e(T,P-T),S===void 0)var S=T;else S+=String.fromCharCode(0),S+=T;T=P+1}}else{for(S=Array(c),A=0;A<c;++A)S[A]=String.fromCharCode(M[w+A>>>0]);S=S.join("")}return ue(s),S},toWireType:function(s,c){c instanceof ArrayBuffer&&(c=new Uint8Array(c));var w=typeof c=="string";if(!(w||c instanceof Uint8Array||c instanceof Uint8ClampedArray||c instanceof Int8Array))throw new de("Cannot pass non-string to std::string");var T=i&&w?Ne(c):c.length,A=ze(4+T+1),P=A+4;if(R[A>>>2>>>0]=T,i&&w)$e(c,M,P,T+1);else if(w)for(w=0;w<T;++w){var S=c.charCodeAt(w);if(255<S)throw ue(P),new de("String has UTF-16 code units that do not fit in 8 bits");M[P+w>>>0]=S}else for(w=0;w<T;++w)M[P+w>>>0]=c[w];return s!==null&&s.push(ue,A),A},argPackAdvance:8,readValueFromPointer:vn,Va(s){ue(s)}})},v:function(e,t,i){if(t>>>=0,i>>>=0,i=ee(i),t===2)var s=Tn,c=An,w=Sn,T=()=>pe,A=1;else t===4&&(s=On,c=xn,w=Pn,T=()=>R,A=2);se(e>>>0,{name:i,fromWireType:P=>{for(var S=R[P>>>2>>>0],F=T(),K,fe=P+4,d=0;d<=S;++d){var U=P+4+d*t;(d==S||F[U>>>A]==0)&&(fe=s(fe,U-fe),K===void 0?K=fe:(K+=String.fromCharCode(0),K+=fe),fe=U+t)}return ue(P),K},toWireType:(P,S)=>{if(typeof S!="string")throw new de(`Cannot pass non-string to C++ string type ${i}`);var F=w(S),K=ze(4+F+t);return R[K>>>2]=F>>A,c(S,K+4,F+t),P!==null&&P.push(ue,K),K},argPackAdvance:8,readValueFromPointer:kt,Va(P){ue(P)}})},ea:function(e,t){t=ee(t>>>0),se(e>>>0,{hb:!0,name:t,argPackAdvance:0,fromWireType:()=>{},toWireType:()=>{}})},aa:()=>1,o:function(e,t,i){return t>>>=0,i>>>=0,e=Z(e>>>0),t=ct(t,"emval::as"),Nt(t,i,e)},x:function(e,t,i,s){return i>>>=0,s>>>=0,e=je[e>>>0],t=Z(t>>>0),e(null,t,i,s)},j:function(e,t,i,s,c){return i>>>=0,s>>>=0,c>>>=0,e=je[e>>>0],t=Z(t>>>0),i=lt(i),e(t,t[i],s,c)},b:ft,w:function(e,t){return t>>>=0,e=Z(e>>>0),t=Z(t),e==t},s:function(e){return e>>>=0,e===0?ne($t()):(e=lt(e),ne($t()[e]))},i:function(e,t,i){t=Cn(e,t>>>0);var s=t.shift();e--;var c=`return function (obj, func, destructorsRef, args) {
`,w=0,T=[];i===0&&T.push("obj");for(var A=["retType"],P=[s],S=0;S<e;++S)T.push("arg"+S),A.push("argType"+S),P.push(t[S]),c+=`  var arg${S} = argType${S}.readValueFromPointer(args${w?"+"+w:""});
`,w+=t[S].argPackAdvance;for(c+=`  var rv = ${i===1?"new func":"func.call"}(${T.join(", ")});
`,S=0;S<e;++S)t[S].deleteObject&&(c+=`  argType${S}.deleteObject(arg${S});
`);return s.hb||(A.push("emval_returnValue"),P.push(Nt),c+=`  return emval_returnValue(retType, destructorsRef, rv);
`),A.push(c+`};
`),e=_n(A).apply(null,P),i=`methodCaller<(${t.map(F=>F.name).join(", ")}) => ${s.name}>`,Bn(jt(i,e))},p:function(e,t){return t>>>=0,e=Z(e>>>0),t=Z(t),ne(e[t])},c:function(e){e>>>=0,4<e&&(Q.get(e).bb+=1)},r:function(){return ne([])},k:function(e){e=Z(e>>>0);for(var t=Array(e.length),i=0;i<e.length;i++)t[i]=e[i];return ne(t)},d:function(e){return ne(lt(e>>>0))},h:function(){return ne({})},g:function(e){e>>>=0;for(var t=Z(e);t.length;){var i=t.pop();t.pop()(i)}ft(e)},f:function(e,t,i){t>>>=0,i>>>=0,e=Z(e>>>0),t=Z(t),i=Z(i),e[t]=i},e:function(e,t){return t>>>=0,e=ct(e>>>0,"_emval_take_value"),e=e.readValueFromPointer(t),ne(e)},R:function(e,t){e=-9007199254740992>e||9007199254740992<e?NaN:Number(e),t>>>=0,e=new Date(1e3*e),v[t>>>2>>>0]=e.getUTCSeconds(),v[t+4>>>2>>>0]=e.getUTCMinutes(),v[t+8>>>2>>>0]=e.getUTCHours(),v[t+12>>>2>>>0]=e.getUTCDate(),v[t+16>>>2>>>0]=e.getUTCMonth(),v[t+20>>>2>>>0]=e.getUTCFullYear()-1900,v[t+24>>>2>>>0]=e.getUTCDay(),v[t+28>>>2>>>0]=(e.getTime()-Date.UTC(e.getUTCFullYear(),0,1,0,0,0,0))/864e5|0},S:function(e,t){e=-9007199254740992>e||9007199254740992<e?NaN:Number(e),t>>>=0,e=new Date(1e3*e),v[t>>>2>>>0]=e.getSeconds(),v[t+4>>>2>>>0]=e.getMinutes(),v[t+8>>>2>>>0]=e.getHours(),v[t+12>>>2>>>0]=e.getDate(),v[t+16>>>2>>>0]=e.getMonth(),v[t+20>>>2>>>0]=e.getFullYear()-1900,v[t+24>>>2>>>0]=e.getDay(),v[t+28>>>2>>>0]=(Se(e.getFullYear())?Ht:zt)[e.getMonth()]+e.getDate()-1|0,v[t+36>>>2>>>0]=-(60*e.getTimezoneOffset());var i=new Date(e.getFullYear(),6,1).getTimezoneOffset(),s=new Date(e.getFullYear(),0,1).getTimezoneOffset();v[t+32>>>2>>>0]=(i!=s&&e.getTimezoneOffset()==Math.min(s,i))|0},T:function(e){e>>>=0;var t=new Date(v[e+20>>>2>>>0]+1900,v[e+16>>>2>>>0],v[e+12>>>2>>>0],v[e+8>>>2>>>0],v[e+4>>>2>>>0],v[e>>>2>>>0],0),i=v[e+32>>>2>>>0],s=t.getTimezoneOffset(),c=new Date(t.getFullYear(),6,1).getTimezoneOffset(),w=new Date(t.getFullYear(),0,1).getTimezoneOffset(),T=Math.min(w,c);return 0>i?v[e+32>>>2>>>0]=+(c!=w&&T==s):0<i!=(T==s)&&(c=Math.max(w,c),t.setTime(t.getTime()+6e4*((0<i?T:c)-s))),v[e+24>>>2>>>0]=t.getDay(),v[e+28>>>2>>>0]=(Se(t.getFullYear())?Ht:zt)[t.getMonth()]+t.getDate()-1|0,v[e>>>2>>>0]=t.getSeconds(),v[e+4>>>2>>>0]=t.getMinutes(),v[e+8>>>2>>>0]=t.getHours(),v[e+12>>>2>>>0]=t.getDate(),v[e+16>>>2>>>0]=t.getMonth(),v[e+20>>>2>>>0]=t.getYear(),e=t.getTime(),isNaN(e)?(v[Zt()>>>2>>>0]=61,e=-1):e/=1e3,BigInt(e)},P:function(){return-52},Q:function(){},I:function(e,t,i){function s(P){return(P=P.toTimeString().match(/\(([A-Za-z ]+)\)$/))?P[1]:"GMT"}i>>>=0;var c=new Date().getFullYear(),w=new Date(c,0,1),T=new Date(c,6,1);c=w.getTimezoneOffset();var A=T.getTimezoneOffset();R[e>>>0>>>2>>>0]=60*Math.max(c,A),v[t>>>0>>>2>>>0]=+(c!=A),e=s(w),t=s(T),e=Gt(e),t=Gt(t),A<c?(R[i>>>2>>>0]=e,R[i+4>>>2>>>0]=t):(R[i>>>2>>>0]=t,R[i+4>>>2>>>0]=e)},y:()=>{ke("")},fa:function(e,t,i){e>>>=0,t>>>=0,i>>>=0,dt.length=0;for(var s;s=M[t++>>>0];){var c=s!=105;c&=s!=112,i+=c&&i%8?4:0,dt.push(s==112?R[i>>>2>>>0]:s==106?xe[i>>>3]:s==105?v[i>>>2>>>0]:ie[i>>>3>>>0]),i+=c?8:4}return X[e].apply(null,dt)},C:()=>Date.now(),J:function(){return 4294901760},n:()=>performance.now(),H:function(e){e>>>=0;var t=M.length;if(4294901760<e)return!1;for(var i=1;4>=i;i*=2){var s=t*(1+.2/i);s=Math.min(s,e+100663296);var c=Math;s=Math.max(e,s);e:{c=(c.min.call(c,4294901760,s+(65536-s%65536)%65536)-C.buffer.byteLength+65535)/65536;try{C.grow(c),_();var w=1;break e}catch{}w=void 0}if(w)return!0}return!1},W:function(e,t){e>>>=0,t>>>=0;var i=0;return Yt().forEach((s,c)=>{var w=t+i;for(c=R[e+4*c>>>2>>>0]=w,w=0;w<s.length;++w)z[c++>>>0>>>0]=s.charCodeAt(w);z[c>>>0>>>0]=0,i+=s.length+1}),0},X:function(e,t){e>>>=0,t>>>=0;var i=Yt();R[e>>>2>>>0]=i.length;var s=0;return i.forEach(c=>s+=c.length+1),R[t>>>2>>>0]=s,0},u:()=>52,A:function(){return 52},V:function(){return 70},z:function(e,t,i,s){t>>>=0,i>>>=0,s>>>=0;for(var c=0,w=0;w<i;w++){var T=R[t>>>2>>>0],A=R[t+4>>>2>>>0];t+=8;for(var P=0;P<A;P++){var S=M[T+P>>>0],F=Un[e];S===0||S===10?((e===1?L:B)(Dt(F,0)),F.length=0):F.push(S)}c+=A}return R[s>>>2>>>0]=c,0},ba:Xt,m:function(e,t,i,s){return Xt(e>>>0,t>>>0,i>>>0,s>>>0)}},x=function(){function e(i){return x=i.exports,x=Ln(),C=x.ga,_(),Ae.unshift(x.ha),re--,re==0&&(G!==null&&(clearInterval(G),G=null),V&&(i=V,V=null,i())),x}var t={a:Rn};if(re++,r.instantiateWasm)try{return r.instantiateWasm(t,e)}catch(i){B(`Module.instantiateWasm callback failed with error: ${i}`),a(i)}return q(t,function(i){e(i.instance)}).catch(a),{}}();r._OrtInit=(e,t)=>(r._OrtInit=x.ia)(e,t),r._OrtGetLastError=(e,t)=>(r._OrtGetLastError=x.ja)(e,t),r._OrtCreateSessionOptions=(e,t,i,s,c,w,T,A,P,S)=>(r._OrtCreateSessionOptions=x.ka)(e,t,i,s,c,w,T,A,P,S),r._OrtAppendExecutionProvider=(e,t)=>(r._OrtAppendExecutionProvider=x.la)(e,t),r._OrtAddFreeDimensionOverride=(e,t,i)=>(r._OrtAddFreeDimensionOverride=x.ma)(e,t,i),r._OrtAddSessionConfigEntry=(e,t,i)=>(r._OrtAddSessionConfigEntry=x.na)(e,t,i),r._OrtReleaseSessionOptions=e=>(r._OrtReleaseSessionOptions=x.oa)(e),r._OrtCreateSession=(e,t,i)=>(r._OrtCreateSession=x.pa)(e,t,i),r._OrtReleaseSession=e=>(r._OrtReleaseSession=x.qa)(e),r._OrtGetInputOutputCount=(e,t,i)=>(r._OrtGetInputOutputCount=x.ra)(e,t,i),r._OrtGetInputName=(e,t)=>(r._OrtGetInputName=x.sa)(e,t),r._OrtGetOutputName=(e,t)=>(r._OrtGetOutputName=x.ta)(e,t),r._OrtFree=e=>(r._OrtFree=x.ua)(e),r._OrtCreateTensor=(e,t,i,s,c,w)=>(r._OrtCreateTensor=x.va)(e,t,i,s,c,w),r._OrtGetTensorData=(e,t,i,s,c)=>(r._OrtGetTensorData=x.wa)(e,t,i,s,c),r._OrtReleaseTensor=e=>(r._OrtReleaseTensor=x.xa)(e),r._OrtCreateRunOptions=(e,t,i,s)=>(r._OrtCreateRunOptions=x.ya)(e,t,i,s),r._OrtAddRunConfigEntry=(e,t,i)=>(r._OrtAddRunConfigEntry=x.za)(e,t,i),r._OrtReleaseRunOptions=e=>(r._OrtReleaseRunOptions=x.Aa)(e),r._OrtCreateBinding=e=>(r._OrtCreateBinding=x.Ba)(e),r._OrtBindInput=(e,t,i)=>(r._OrtBindInput=x.Ca)(e,t,i),r._OrtBindOutput=(e,t,i,s)=>(r._OrtBindOutput=x.Da)(e,t,i,s),r._OrtClearBoundOutputs=e=>(r._OrtClearBoundOutputs=x.Ea)(e),r._OrtReleaseBinding=e=>(r._OrtReleaseBinding=x.Fa)(e),r._OrtRunWithBinding=(e,t,i,s,c)=>(r._OrtRunWithBinding=x.Ga)(e,t,i,s,c),r._OrtRun=(e,t,i,s,c,w,T,A)=>(r._OrtRun=x.Ha)(e,t,i,s,c,w,T,A),r._OrtEndProfiling=e=>(r._OrtEndProfiling=x.Ia)(e);var Zt=()=>(Zt=x.Ja)(),ze=r._malloc=e=>(ze=r._malloc=x.Ka)(e),ue=r._free=e=>(ue=r._free=x.La)(e),Kt=e=>(Kt=x.Ma)(e),Qt=()=>(Qt=x.Oa)(),er=e=>(er=x.Pa)(e),tr=e=>(tr=x.Qa)(e);function Ln(){var e=x;e=Object.assign({},e);var t=s=>()=>s()>>>0,i=s=>c=>s(c)>>>0;return e.Ja=t(e.Ja),e.Ka=i(e.Ka),e.Ma=i(e.Ma),e.Oa=t(e.Oa),e.Qa=i(e.Qa),e}r.stackAlloc=tr,r.stackSave=Qt,r.stackRestore=er,r.UTF8ToString=_e,r.stringToUTF8=(e,t,i)=>$e(e,M,t,i),r.lengthBytesUTF8=Ne;var Ge;V=function e(){Ge||rr(),Ge||(V=e)};function rr(){if(!(0<re)){if(r.preRun)for(typeof r.preRun=="function"&&(r.preRun=[r.preRun]);r.preRun.length;){var e=r.preRun.shift();ae.unshift(e)}for(;0<ae.length;)ae.shift()(r);if(!(0<re||Ge||(Ge=!0,r.calledRun=!0,H))){for(;0<Ae.length;)Ae.shift()(r);for(u(r);0<te.length;)te.shift()(r)}}}return rr(),n.ready}})();typeof Fr=="object"&&typeof vt=="object"?vt.exports=Mr:typeof define=="function"&&define.amd&&define([],()=>Mr)});var St,Vn,Tt,At,tt,Wr,qn,Xn,Jn,Nr,$,Oe=D(()=>{"use strict";St=kr();Vn=St,At=!1,tt=!1,Wr=!1,qn=()=>{try{return typeof SharedArrayBuffer>"u"?!1:(typeof MessageChannel<"u"&&new MessageChannel().port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11])))}catch{return!1}},Xn=()=>{try{return WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,30,1,28,0,65,0,253,15,253,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,253,186,1,26,11]))}catch{return!1}},Jn=(o,n)=>o?n?"ort-wasm-simd-threaded.wasm":"ort-wasm-simd.wasm":n?"ort-wasm-threaded.wasm":"ort-wasm.wasm",Nr=async o=>{if(At)return Promise.resolve();if(tt)throw new Error("multiple calls to 'initializeWebAssembly()' detected.");if(Wr)throw new Error("previous call to 'initializeWebAssembly()' failed.");tt=!0;let n=o.initTimeout,r=o.numThreads,u=o.simd,a=r>1&&qn(),l=u&&Xn(),f=o.wasmPaths,p=typeof f=="string"?f:void 0,y=Jn(l,a),m=typeof f=="object"?f[y]:void 0,g=!1,b=[];if(n>0&&b.push(new Promise(h=>{setTimeout(()=>{g=!0,h()},n)})),b.push(new Promise((h,E)=>{(a?Vn:St)({locateFile:(L,B)=>L.endsWith(".wasm")?m||(p??B)+y:B+L}).then(L=>{tt=!1,At=!0,Tt=L,h()},L=>{tt=!1,Wr=!0,E(L)})})),await Promise.race(b),g)throw new Error(`WebAssembly backend initializing failed due to timeout: ${n}ms`)},$=()=>{if(At&&Tt)return Tt;throw new Error("WebAssembly is not initialized yet.")}});var j,Re,W,rt=D(()=>{"use strict";Oe();j=(o,n)=>{let r=$(),u=r.lengthBytesUTF8(o)+1,a=r._malloc(u);return r.stringToUTF8(o,a,u),n.push(a),a},Re=(o,n,r,u)=>{if(typeof o=="object"&&o!==null){if(r.has(o))throw new Error("Circular reference in options");r.add(o)}Object.entries(o).forEach(([a,l])=>{let f=n?n+a:a;if(typeof l=="object")Re(l,f+".",r,u);else if(typeof l=="string"||typeof l=="number")u(f,l.toString());else if(typeof l=="boolean")u(f,l?"1":"0");else throw new Error(`Can't handle extra config type: ${typeof l}`)})},W=o=>{let n=$(),r=n.stackSave();try{let u=n.stackAlloc(8);n._OrtGetLastError(u,u+4);let a=n.HEAP32[u/4],l=n.HEAPU32[u/4+1],f=l?n.UTF8ToString(l):"";throw new Error(`${o} ERROR_CODE: ${a}, ERROR_MESSAGE: ${f}`)}finally{n.stackRestore(r)}}});var $r,jr=D(()=>{"use strict";Oe();rt();$r=o=>{let n=$(),r=0,u=[],a=o||{};try{if(o?.logSeverityLevel===void 0)a.logSeverityLevel=2;else if(typeof o.logSeverityLevel!="number"||!Number.isInteger(o.logSeverityLevel)||o.logSeverityLevel<0||o.logSeverityLevel>4)throw new Error(`log serverity level is not valid: ${o.logSeverityLevel}`);if(o?.logVerbosityLevel===void 0)a.logVerbosityLevel=0;else if(typeof o.logVerbosityLevel!="number"||!Number.isInteger(o.logVerbosityLevel))throw new Error(`log verbosity level is not valid: ${o.logVerbosityLevel}`);o?.terminate===void 0&&(a.terminate=!1);let l=0;return o?.tag!==void 0&&(l=j(o.tag,u)),r=n._OrtCreateRunOptions(a.logSeverityLevel,a.logVerbosityLevel,!!a.terminate,l),r===0&&W("Can't create run options."),o?.extra!==void 0&&Re(o.extra,"",new WeakSet,(f,p)=>{let y=j(f,u),m=j(p,u);n._OrtAddRunConfigEntry(r,y,m)!==0&&W(`Can't set a run config entry: ${f} - ${p}.`)}),[r,u]}catch(l){throw r!==0&&n._OrtReleaseRunOptions(r),u.forEach(f=>n._free(f)),l}}});var Zn,Kn,Qn,eo,Hr,zr=D(()=>{"use strict";Oe();rt();Zn=o=>{switch(o){case"disabled":return 0;case"basic":return 1;case"extended":return 2;case"all":return 99;default:throw new Error(`unsupported graph optimization level: ${o}`)}},Kn=o=>{switch(o){case"sequential":return 0;case"parallel":return 1;default:throw new Error(`unsupported execution mode: ${o}`)}},Qn=o=>{o.extra||(o.extra={}),o.extra.session||(o.extra.session={});let n=o.extra.session;n.use_ort_model_bytes_directly||(n.use_ort_model_bytes_directly="1"),o.executionProviders&&o.executionProviders.some(r=>(typeof r=="string"?r:r.name)==="webgpu")&&(o.enableMemPattern=!1)},eo=(o,n,r)=>{for(let u of n){let a=typeof u=="string"?u:u.name;switch(a){case"webnn":if(a="WEBNN",typeof u!="string"){let f=u;if(f?.deviceType){let p=j("deviceType",r),y=j(f.deviceType,r);$()._OrtAddSessionConfigEntry(o,p,y)!==0&&W(`Can't set a session config entry: 'deviceType' - ${f.deviceType}.`)}if(f?.numThreads){let p=f.numThreads;(typeof p!="number"||!Number.isInteger(p)||p<0)&&(p=0);let y=j("numThreads",r),m=j(p.toString(),r);$()._OrtAddSessionConfigEntry(o,y,m)!==0&&W(`Can't set a session config entry: 'numThreads' - ${f.numThreads}.`)}if(f?.powerPreference){let p=j("powerPreference",r),y=j(f.powerPreference,r);$()._OrtAddSessionConfigEntry(o,p,y)!==0&&W(`Can't set a session config entry: 'powerPreference' - ${f.powerPreference}.`)}}break;case"webgpu":if(a="JS",typeof u!="string"){let f=u;if(f?.preferredLayout){if(f.preferredLayout!=="NCHW"&&f.preferredLayout!=="NHWC")throw new Error(`preferredLayout must be either 'NCHW' or 'NHWC': ${f.preferredLayout}`);let p=j("preferredLayout",r),y=j(f.preferredLayout,r);$()._OrtAddSessionConfigEntry(o,p,y)!==0&&W(`Can't set a session config entry: 'preferredLayout' - ${f.preferredLayout}.`)}}break;case"wasm":case"cpu":continue;default:throw new Error(`not supported execution provider: ${a}`)}let l=j(a,r);$()._OrtAppendExecutionProvider(o,l)!==0&&W(`Can't append execution provider: ${a}.`)}},Hr=o=>{let n=$(),r=0,u=[],a=o||{};Qn(a);try{let l=Zn(a.graphOptimizationLevel??"all"),f=Kn(a.executionMode??"sequential"),p=typeof a.logId=="string"?j(a.logId,u):0,y=a.logSeverityLevel??2;if(!Number.isInteger(y)||y<0||y>4)throw new Error(`log serverity level is not valid: ${y}`);let m=a.logVerbosityLevel??0;if(!Number.isInteger(m)||m<0||m>4)throw new Error(`log verbosity level is not valid: ${m}`);let g=typeof a.optimizedModelFilePath=="string"?j(a.optimizedModelFilePath,u):0;if(r=n._OrtCreateSessionOptions(l,!!a.enableCpuMemArena,!!a.enableMemPattern,f,!!a.enableProfiling,0,p,y,m,g),r===0&&W("Can't create session options."),a.executionProviders&&eo(r,a.executionProviders,u),a.freeDimensionOverrides)for(let[b,h]of Object.entries(a.freeDimensionOverrides)){if(typeof b!="string")throw new Error(`free dimension override name must be a string: ${b}`);if(typeof h!="number"||!Number.isInteger(h)||h<0)throw new Error(`free dimension override value must be a non-negative integer: ${h}`);let E=j(b,u);n._OrtAddFreeDimensionOverride(r,E,h)!==0&&W(`Can't set a free dimension override: ${b} - ${h}.`)}return a.extra!==void 0&&Re(a.extra,"",new WeakSet,(b,h)=>{let E=j(b,u),O=j(h,u);n._OrtAddSessionConfigEntry(r,E,O)!==0&&W(`Can't set a session config entry: ${b} - ${h}.`)}),[r,u]}catch(l){throw r!==0&&n._OrtReleaseSessionOptions(r),u.forEach(f=>n._free(f)),l}}});var Ot,Gr,xt,Yr,Vr,nt,qr,Pt=D(()=>{"use strict";Ot=o=>{switch(o){case"int8":return 3;case"uint8":return 2;case"bool":return 9;case"int16":return 5;case"uint16":return 4;case"int32":return 6;case"uint32":return 12;case"float16":return 10;case"float32":return 1;case"float64":return 11;case"string":return 8;case"int64":return 7;case"uint64":return 13;default:throw new Error(`unsupported data type: ${o}`)}},Gr=o=>{switch(o){case 3:return"int8";case 2:return"uint8";case 9:return"bool";case 5:return"int16";case 4:return"uint16";case 6:return"int32";case 12:return"uint32";case 10:return"float16";case 1:return"float32";case 11:return"float64";case 8:return"string";case 7:return"int64";case 13:return"uint64";default:throw new Error(`unsupported data type: ${o}`)}},xt=o=>[void 0,4,1,1,2,2,4,8,void 0,1,2,8,4,8,void 0,void 0,void 0][o],Yr=o=>{switch(o){case"float16":return Uint16Array;case"float32":return Float32Array;case"uint8":return Uint8Array;case"int8":return Int8Array;case"uint16":return Uint16Array;case"int16":return Int16Array;case"int32":return Int32Array;case"bool":return Uint8Array;case"float64":return Float64Array;case"uint32":return Uint32Array;case"int64":return BigInt64Array;case"uint64":return BigUint64Array;default:throw new Error(`unsupported type: ${o}`)}},Vr=o=>{switch(o){case"verbose":return 0;case"info":return 1;case"warning":return 2;case"error":return 3;case"fatal":return 4;default:throw new Error(`unsupported logging level: ${o}`)}},nt=o=>o==="float32"||o==="int32"||o==="int64"||o==="bool"||o==="float16"||o==="uint32",qr=o=>{switch(o){case"none":return 0;case"cpu":return 1;case"cpu-pinned":return 2;case"texture":return 3;case"gpu-buffer":return 4;default:throw new Error(`unsupported data location: ${o}`)}}});var Le,It=D(()=>{"use strict";Le=async o=>{if(typeof o=="string")if(typeof process<"u"&&process.versions&&process.versions.node)try{return new Uint8Array(await(void 0)(o))}catch(n){if(n.code==="ERR_FS_FILE_TOO_LARGE"){let r=(void 0)(o),u=[];for await(let a of r)u.push(a);return new Uint8Array(Buffer.concat(u))}throw n}else{let n=await fetch(o);if(!n.ok)throw new Error(`failed to load external data file: ${o}`);let r=n.headers.get("Content-Length"),u=r?parseInt(r,10):0;if(u<1073741824)return new Uint8Array(await n.arrayBuffer());{if(!n.body)throw new Error(`failed to load external data file: ${o}, no response body.`);let a=n.body.getReader(),l=Math.ceil(u/65536),f=new WebAssembly.Memory({initial:l,maximum:l}).buffer,p=0;for(;;){let{done:y,value:m}=await a.read();if(y)break;let g=m.byteLength;new Uint8Array(f,p,g).set(m),p+=g}return new Uint8Array(f,0,u)}}else return o instanceof Blob?new Uint8Array(await o.arrayBuffer()):o instanceof Uint8Array?o:new Uint8Array(o)}});var to,Jr,Zr,Me,ro,Bt,Kr,Qr,Xr,en,tn,rn=D(()=>{"use strict";jr();zr();Pt();Oe();rt();It();to=(o,n)=>{$()._OrtInit(o,n)!==0&&W("Can't initialize onnxruntime.")},Jr=async o=>{to(o.wasm.numThreads,Vr(o.logLevel))},Zr=async(o,n)=>{},Me=new Map,ro=o=>{let n=$(),r=n.stackSave();try{let u=n.stackAlloc(8);return n._OrtGetInputOutputCount(o,u,u+4)!==0&&W("Can't get session input/output count."),[n.HEAP32[u/4],n.HEAP32[u/4+1]]}finally{n.stackRestore(r)}},Bt=o=>{let n=$(),r=n._malloc(o.byteLength);if(r===0)throw new Error(`Can't create a session. failed to allocate a buffer of size ${o.byteLength}.`);return n.HEAPU8.set(o,r),[r,o.byteLength]},Kr=async(o,n)=>{let r,u,a=$();Array.isArray(o)?[r,u]=o:o.buffer===a.HEAPU8.buffer?[r,u]=[o.byteOffset,o.byteLength]:[r,u]=Bt(o);let l=0,f=0,p=0,y=[],m=[],g=[];try{if([f,y]=Hr(n),n?.externalData&&a.mountExternalData){let B=[];for(let C of n.externalData){let H=typeof C=="string"?C:C.path;B.push(Le(typeof C=="string"?C:C.data).then(z=>{a.mountExternalData(H,z)}))}await Promise.all(B)}l=a._OrtCreateSession(r,u,f),l===0&&W("Can't create a session.");let[b,h]=ro(l),E=[],O=[],I=[];for(let B=0;B<b;B++){let C=a._OrtGetInputName(l,B);C===0&&W("Can't get an input name."),m.push(C),E.push(a.UTF8ToString(C))}for(let B=0;B<h;B++){let C=a._OrtGetOutputName(l,B);C===0&&W("Can't get an output name."),g.push(C);let H=a.UTF8ToString(C);O.push(H)}let L=null;return Me.set(l,[l,m,g,L]),[l,E,O]}catch(b){throw m.forEach(h=>a._OrtFree(h)),g.forEach(h=>a._OrtFree(h)),p!==0&&a._OrtReleaseBinding(p),l!==0&&a._OrtReleaseSession(l),b}finally{a._free(r),f!==0&&a._OrtReleaseSessionOptions(f),y.forEach(b=>a._free(b)),a.unmountExternalData?.()}},Qr=o=>{let n=$(),r=Me.get(o);if(!r)throw new Error(`cannot release session. invalid session id: ${o}`);let[u,a,l,f]=r;f&&n._OrtReleaseBinding(f.handle),n.jsepUnregisterBuffers?.(o),a.forEach(p=>n._OrtFree(p)),l.forEach(p=>n._OrtFree(p)),n._OrtReleaseSession(u),Me.delete(o)},Xr=(o,n,r,u,a)=>{if(!o){n.push(0);return}let l=$(),f=o[0],p=o[1],y=o[3],m,g;if(f==="string"&&y==="gpu-buffer")throw new Error("String tensor is not supported on GPU.");if(y==="gpu-buffer"){let E=o[2].gpuBuffer,O=xt(Ot(f));g=p.reduce((I,L)=>I*L,1)*O,m=l.jsepRegisterBuffer(u,a,E,g)}else{let E=o[2];if(Array.isArray(E)){g=4*E.length,m=l._malloc(g),r.push(m);let O=m/4;for(let I=0;I<E.length;I++){if(typeof E[I]!="string")throw new TypeError(`tensor data at index ${I} is not a string`);l.HEAPU32[O++]=j(E[I],r)}}else g=E.byteLength,m=l._malloc(g),r.push(m),l.HEAPU8.set(new Uint8Array(E.buffer,E.byteOffset,g),m)}let b=l.stackSave(),h=l.stackAlloc(4*p.length);try{let E=h/4;p.forEach(I=>l.HEAP32[E++]=I);let O=l._OrtCreateTensor(Ot(f),m,g,h,p.length,qr(y));O===0&&W(`Can't create tensor for input/output. session=${u}, index=${a}.`),n.push(O)}finally{l.stackRestore(b)}},en=async(o,n,r,u,a,l)=>{let f=$(),p=Me.get(o);if(!p)throw new Error(`cannot run inference. invalid session id: ${o}`);let[y,m,g,b]=p,h=n.length,E=u.length,O=0,I=[],L=[],B=[],C=[],H=f.stackSave(),z=f.stackAlloc(h*4),M=f.stackAlloc(h*4),oe=f.stackAlloc(E*4),pe=f.stackAlloc(E*4);try{[O,I]=$r(l);for(let _=0;_<h;_++)Xr(r[_],L,C,o,n[_]);for(let _=0;_<E;_++)Xr(a[_],B,C,o,h+u[_]);let v=z/4,R=M/4,Fe=oe/4,xe=pe/4;for(let _=0;_<h;_++)f.HEAPU32[v++]=L[_],f.HEAPU32[R++]=m[n[_]];for(let _=0;_<E;_++)f.HEAPU32[Fe++]=B[_],f.HEAPU32[xe++]=g[u[_]];let Pe;Pe=await f._OrtRun(y,M,z,h,pe,E,oe,O),Pe!==0&&W("failed to call OrtRun().");let ie=[];for(let _=0;_<E;_++){let ae=f.HEAPU32[oe/4+_];if(ae===B[_]){ie.push(a[_]);continue}let Ae=f.stackSave(),te=f.stackAlloc(4*4),re=!1,G,V=0;try{f._OrtGetTensorData(ae,te,te+4,te+8,te+12)!==0&&W(`Can't access output tensor data on index ${_}.`);let me=te/4,he=f.HEAPU32[me++];V=f.HEAPU32[me++];let ce=f.HEAPU32[me++],We=f.HEAPU32[me++],le=[];for(let q=0;q<We;q++)le.push(f.HEAPU32[ce/4+q]);f._OrtFree(ce);let ye=le.reduce((q,X)=>q*X,1);G=Gr(he);let Ie=b?.outputPreferredLocations[u[_]];if(G==="string"){if(Ie==="gpu-buffer")throw new Error("String tensor is not supported on GPU.");let q=[],X=V/4;for(let Be=0;Be<ye;Be++){let Ce=f.HEAPU32[X++],at=Be===ye-1?void 0:f.HEAPU32[X]-Ce;q.push(f.UTF8ToString(Ce,at))}ie.push([G,le,q,"cpu"])}else if(Ie==="gpu-buffer"&&ye>0){let q=f.jsepGetBuffer(V),X=xt(he);if(X===void 0||!nt(G))throw new Error(`Unsupported data type: ${G}`);re=!0,ie.push([G,le,{gpuBuffer:q,download:f.jsepCreateDownloader(q,ye*X,G),dispose:()=>{f._OrtReleaseTensor(ae)}},"gpu-buffer"])}else{let q=Yr(G),X=new q(ye);new Uint8Array(X.buffer,X.byteOffset,X.byteLength).set(f.HEAPU8.subarray(V,V+X.byteLength)),ie.push([G,le,X,"cpu"])}}finally{f.stackRestore(Ae),G==="string"&&V&&f._free(V),re||f._OrtReleaseTensor(ae)}}return b&&f._OrtClearBoundOutputs(b.handle),ie}finally{f.stackRestore(H),L.forEach(v=>f._OrtReleaseTensor(v)),B.forEach(v=>f._OrtReleaseTensor(v)),C.forEach(v=>f._free(v)),O!==0&&f._OrtReleaseRunOptions(O),I.forEach(v=>f._free(v))}},tn=o=>{let n=$(),r=Me.get(o);if(!r)throw new Error("invalid session id");let u=r[0],a=n._OrtEndProfiling(u);a===0&&W("Can't get an profile file name."),n._OrtFree(a)}});var Ct,nn,on,vi,an,sn,un,fn,cn,ln,dn,_t=D(()=>{"use strict";Te();rn();Oe();Ct=!1,nn=!1,on=!1,vi=typeof document<"u"?document?.currentScript?.src:void 0,an=async()=>{if(!nn){if(Ct)throw new Error("multiple calls to 'initWasm()' detected.");if(on)throw new Error("previous call to 'initWasm()' failed.");Ct=!0;try{await Nr(N.wasm),await Jr(N),nn=!0}catch(o){throw on=!0,o}finally{Ct=!1}}},sn=async o=>{await Zr(N,o)},un=async o=>Bt(o),fn=async(o,n)=>Kr(o,n),cn=async o=>{Qr(o)},ln=async(o,n,r,u,a,l)=>en(o,n,r,u,a,l),dn=async o=>{tn(o)}});var pn,oo,ot,mn=D(()=>{"use strict";Te();_t();Pt();It();pn=(o,n)=>{switch(o.location){case"cpu":return[o.type,o.dims,o.data,"cpu"];case"gpu-buffer":return[o.type,o.dims,{gpuBuffer:o.gpuBuffer},"gpu-buffer"];default:throw new Error(`invalid data location: ${o.location} for ${n()}`)}},oo=o=>{switch(o[3]){case"cpu":return new Y(o[0],o[2],o[1]);case"gpu-buffer":{let n=o[0];if(!nt(n))throw new Error(`not supported data type: ${n} for deserializing GPU tensor`);let{gpuBuffer:r,download:u,dispose:a}=o[2];return Y.fromGpuBuffer(r,{dataType:n,dims:o[1],download:u,dispose:a})}default:throw new Error(`invalid data location: ${o[3]}`)}},ot=class{async fetchModelAndCopyToWasmMemory(n){return un(await Le(n))}async loadModel(n,r){Ee();let u;typeof n=="string"?typeof process<"u"&&process.versions&&process.versions.node?u=await Le(n):u=await this.fetchModelAndCopyToWasmMemory(n):u=n,[this.sessionId,this.inputNames,this.outputNames]=await fn(u,r),ve()}async dispose(){return cn(this.sessionId)}async run(n,r,u){Ee();let a=[],l=[];Object.entries(n).forEach(h=>{let E=h[0],O=h[1],I=this.inputNames.indexOf(E);if(I===-1)throw new Error(`invalid input '${E}'`);a.push(O),l.push(I)});let f=[],p=[];Object.entries(r).forEach(h=>{let E=h[0],O=h[1],I=this.outputNames.indexOf(E);if(I===-1)throw new Error(`invalid output '${E}'`);f.push(O),p.push(I)});let y=a.map((h,E)=>pn(h,()=>`input "${this.inputNames[l[E]]}"`)),m=f.map((h,E)=>h?pn(h,()=>`output "${this.outputNames[p[E]]}"`):null),g=await ln(this.sessionId,l,y,p,m,u),b={};for(let h=0;h<g.length;h++)b[this.outputNames[p[h]]]=f[h]??oo(g[h]);return ve(),b}startProfiling(){}endProfiling(){dn(this.sessionId)}}});var io,it,hn=D(()=>{"use strict";Te();_t();mn();io=()=>{if((typeof N.wasm.initTimeout!="number"||N.wasm.initTimeout<0)&&(N.wasm.initTimeout=0),typeof N.wasm.simd!="boolean"&&(N.wasm.simd=!0),typeof N.wasm.proxy!="boolean"&&(N.wasm.proxy=!1),typeof N.wasm.trace!="boolean"&&(N.wasm.trace=!1),typeof N.wasm.numThreads!="number"||!Number.isInteger(N.wasm.numThreads)||N.wasm.numThreads<=0){let o=typeof navigator>"u"?(void 0)().length:navigator.hardwareConcurrency;N.wasm.numThreads=Math.min(4,Math.ceil((o||1)/2))}},it=class{async init(n){io(),await an(),await sn(n)}async createInferenceSessionHandler(n,r){let u=new ot;return await u.loadModel(n,r),Promise.resolve(u)}}});var yn={};Ye(yn,{wasmBackend:()=>ao});var ao,gn=D(()=>{"use strict";hn();ao=new it});Te();Te();Te();var Cr="1.17.0";var Ni=Et;{let o=(gn(),yt(yn)).wasmBackend;Ue("cpu",o,10),Ue("wasm",o,10)}Object.defineProperty(N.versions,"web",{value:Cr,enumerable:!0});export{$n as InferenceSession,Ar as TRACE,Ee as TRACE_FUNC_BEGIN,ve as TRACE_FUNC_END,Y as Tensor,Hn as TrainingSession,Ni as default,N as env,Ue as registerBackend};
//# sourceMappingURL=ort.wasm-core.min.js.map
