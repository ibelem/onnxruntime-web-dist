/*!
 * ONNX Runtime Web v1.18.0
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */
"use strict";var ort=(()=>{var yt=Object.defineProperty;var kn=Object.getOwnPropertyDescriptor;var Wn=Object.getOwnPropertyNames;var Nn=Object.prototype.hasOwnProperty;var D=(o,r)=>()=>(o&&(r=o(o=0)),r);var $n=(o,r)=>()=>(r||o((r={exports:{}}).exports,r),r.exports),De=(o,r)=>{for(var n in r)yt(o,n,{get:r[n],enumerable:!0})},jn=(o,r,n,u)=>{if(r&&typeof r=="object"||typeof r=="function")for(let s of Wn(r))!Nn.call(o,s)&&s!==n&&yt(o,s,{get:()=>r[s],enumerable:!(u=kn(r,s))||u.enumerable});return o};var Ve=o=>jn(yt({},"__esModule",{value:!0}),o);var qe,Ee,Oe,Xe,Je=D(()=>{qe=new Map,Ee=[],Oe=(o,r,n)=>{if(r&&typeof r.init=="function"&&typeof r.createInferenceSessionHandler=="function"){let u=qe.get(o);if(u===void 0)qe.set(o,{backend:r,priority:n});else{if(u.priority>n)return;if(u.priority===n&&u.backend!==r)throw new Error(`cannot register backend "${o}" using priority ${n}`)}if(n>=0){let s=Ee.indexOf(o);s!==-1&&Ee.splice(s,1);for(let l=0;l<Ee.length;l++)if(qe.get(Ee[l]).priority<=n){Ee.splice(l,0,o);return}Ee.push(o)}return}throw new TypeError("not a valid backend")},Xe=async o=>{let r=o.length===0?Ee:o,n=[];for(let u of r){let s=qe.get(u);if(s){if(s.initialized)return s.backend;if(s.aborted)continue;let l=!!s.initPromise;try{return l||(s.initPromise=s.backend.init(u)),await s.initPromise,s.initialized=!0,s.backend}catch(f){l||n.push({name:u,err:f}),s.aborted=!0}finally{delete s.initPromise}}}throw new Error(`no available backend found. ERR: ${n.map(u=>`[${u.name}] ${u.err}`).join(", ")}`)}});var ir=D(()=>{Je()});var sr,ar=D(()=>{sr="1.18.0"});var ur,ve,gt=D(()=>{ar();ur="warning",ve={wasm:{},webgl:{},webgpu:{},versions:{common:sr},set logLevel(o){if(o!==void 0){if(typeof o!="string"||["verbose","info","warning","error","fatal"].indexOf(o)===-1)throw new Error(`Unsupported logging level: ${o}`);ur=o}},get logLevel(){return ur}};Object.defineProperty(ve,"logLevel",{enumerable:!0})});var F,fr=D(()=>{gt();F=ve});var cr,lr,dr=D(()=>{cr=(o,r)=>{let n=typeof document<"u"?document.createElement("canvas"):new OffscreenCanvas(1,1);n.width=o.dims[3],n.height=o.dims[2];let u=n.getContext("2d");if(u!=null){let s,l;r?.tensorLayout!==void 0&&r.tensorLayout==="NHWC"?(s=o.dims[2],l=o.dims[3]):(s=o.dims[3],l=o.dims[2]);let f=r?.format!==void 0?r.format:"RGB",p=r?.norm,h,m;p===void 0||p.mean===void 0?h=[255,255,255,255]:typeof p.mean=="number"?h=[p.mean,p.mean,p.mean,p.mean]:(h=[p.mean[0],p.mean[1],p.mean[2],0],p.mean[3]!==void 0&&(h[3]=p.mean[3])),p===void 0||p.bias===void 0?m=[0,0,0,0]:typeof p.bias=="number"?m=[p.bias,p.bias,p.bias,p.bias]:(m=[p.bias[0],p.bias[1],p.bias[2],0],p.bias[3]!==void 0&&(m[3]=p.bias[3]));let g=l*s,b=0,y=g,E=g*2,O=-1;f==="RGBA"?(b=0,y=g,E=g*2,O=g*3):f==="RGB"?(b=0,y=g,E=g*2):f==="RBG"&&(b=0,E=g,y=g*2);for(let P=0;P<l;P++)for(let L=0;L<s;L++){let B=(o.data[b++]-m[0])*h[0],C=(o.data[y++]-m[1])*h[1],H=(o.data[E++]-m[2])*h[2],z=O===-1?255:(o.data[O++]-m[3])*h[3];u.fillStyle="rgba("+B+","+C+","+H+","+z+")",u.fillRect(L,P,1,1)}if("toDataURL"in n)return n.toDataURL();throw new Error("toDataURL is not supported")}else throw new Error("Can not access image data")},lr=(o,r)=>{let n=typeof document<"u"?document.createElement("canvas").getContext("2d"):new OffscreenCanvas(1,1).getContext("2d"),u;if(n!=null){let s,l,f;r?.tensorLayout!==void 0&&r.tensorLayout==="NHWC"?(s=o.dims[2],l=o.dims[1],f=o.dims[3]):(s=o.dims[3],l=o.dims[2],f=o.dims[1]);let p=r!==void 0&&r.format!==void 0?r.format:"RGB",h=r?.norm,m,g;h===void 0||h.mean===void 0?m=[255,255,255,255]:typeof h.mean=="number"?m=[h.mean,h.mean,h.mean,h.mean]:(m=[h.mean[0],h.mean[1],h.mean[2],255],h.mean[3]!==void 0&&(m[3]=h.mean[3])),h===void 0||h.bias===void 0?g=[0,0,0,0]:typeof h.bias=="number"?g=[h.bias,h.bias,h.bias,h.bias]:(g=[h.bias[0],h.bias[1],h.bias[2],0],h.bias[3]!==void 0&&(g[3]=h.bias[3]));let b=l*s;if(r!==void 0&&(r.format!==void 0&&f===4&&r.format!=="RGBA"||f===3&&r.format!=="RGB"&&r.format!=="BGR"))throw new Error("Tensor format doesn't match input tensor dims");let y=4,E=0,O=1,P=2,L=3,B=0,C=b,H=b*2,z=-1;p==="RGBA"?(B=0,C=b,H=b*2,z=b*3):p==="RGB"?(B=0,C=b,H=b*2):p==="RBG"&&(B=0,H=b,C=b*2),u=n.createImageData(s,l);for(let M=0;M<l*s;E+=y,O+=y,P+=y,L+=y,M++)u.data[E]=(o.data[B++]-g[0])*m[0],u.data[O]=(o.data[C++]-g[1])*m[1],u.data[P]=(o.data[H++]-g[2])*m[2],u.data[L]=z===-1?255:(o.data[z++]-g[3])*m[3]}else throw new Error("Can not access image data");return u}});var wt,pr,mr,hr,yr,gr=D(()=>{Ze();wt=(o,r)=>{if(o===void 0)throw new Error("Image buffer must be defined");if(r.height===void 0||r.width===void 0)throw new Error("Image height and width must be defined");if(r.tensorLayout==="NHWC")throw new Error("NHWC Tensor layout is not supported yet");let{height:n,width:u}=r,s=r.norm??{mean:255,bias:0},l,f;typeof s.mean=="number"?l=[s.mean,s.mean,s.mean,s.mean]:l=[s.mean[0],s.mean[1],s.mean[2],s.mean[3]??255],typeof s.bias=="number"?f=[s.bias,s.bias,s.bias,s.bias]:f=[s.bias[0],s.bias[1],s.bias[2],s.bias[3]??0];let p=r.format!==void 0?r.format:"RGBA",h=r.tensorFormat!==void 0&&r.tensorFormat!==void 0?r.tensorFormat:"RGB",m=n*u,g=h==="RGBA"?new Float32Array(m*4):new Float32Array(m*3),b=4,y=0,E=1,O=2,P=3,L=0,B=m,C=m*2,H=-1;p==="RGB"&&(b=3,y=0,E=1,O=2,P=-1),h==="RGBA"?H=m*3:h==="RBG"?(L=0,C=m,B=m*2):h==="BGR"&&(C=0,B=m,L=m*2);for(let M=0;M<m;M++,y+=b,O+=b,E+=b,P+=b)g[L++]=(o[y]+f[0])/l[0],g[B++]=(o[E]+f[1])/l[1],g[C++]=(o[O]+f[2])/l[2],H!==-1&&P!==-1&&(g[H++]=(o[P]+f[3])/l[3]);return h==="RGBA"?new J("float32",g,[1,4,n,u]):new J("float32",g,[1,3,n,u])},pr=async(o,r)=>{let n=typeof HTMLImageElement<"u"&&o instanceof HTMLImageElement,u=typeof ImageData<"u"&&o instanceof ImageData,s=typeof ImageBitmap<"u"&&o instanceof ImageBitmap,l=typeof o=="string",f,p=r??{},h=()=>{if(typeof document<"u")return document.createElement("canvas");if(typeof OffscreenCanvas<"u")return new OffscreenCanvas(1,1);throw new Error("Canvas is not supported")},m=g=>g instanceof HTMLCanvasElement||g instanceof OffscreenCanvas?g.getContext("2d"):null;if(n){let g=h();g.width=o.width,g.height=o.height;let b=m(g);if(b!=null){let y=o.height,E=o.width;if(r!==void 0&&r.resizedHeight!==void 0&&r.resizedWidth!==void 0&&(y=r.resizedHeight,E=r.resizedWidth),r!==void 0){if(p=r,r.tensorFormat!==void 0)throw new Error("Image input config format must be RGBA for HTMLImageElement");p.tensorFormat="RGBA",p.height=y,p.width=E}else p.tensorFormat="RGBA",p.height=y,p.width=E;b.drawImage(o,0,0),f=b.getImageData(0,0,E,y).data}else throw new Error("Can not access image data")}else if(u){let g,b;if(r!==void 0&&r.resizedWidth!==void 0&&r.resizedHeight!==void 0?(g=r.resizedHeight,b=r.resizedWidth):(g=o.height,b=o.width),r!==void 0&&(p=r),p.format="RGBA",p.height=g,p.width=b,r!==void 0){let y=h();y.width=b,y.height=g;let E=m(y);if(E!=null)E.putImageData(o,0,0),f=E.getImageData(0,0,b,g).data;else throw new Error("Can not access image data")}else f=o.data}else if(s){if(r===void 0)throw new Error("Please provide image config with format for Imagebitmap");let g=h();g.width=o.width,g.height=o.height;let b=m(g);if(b!=null){let y=o.height,E=o.width;return b.drawImage(o,0,0,E,y),f=b.getImageData(0,0,E,y).data,p.height=y,p.width=E,wt(f,p)}else throw new Error("Can not access image data")}else{if(l)return new Promise((g,b)=>{let y=h(),E=m(y);if(!o||!E)return b();let O=new Image;O.crossOrigin="Anonymous",O.src=o,O.onload=()=>{y.width=O.width,y.height=O.height,E.drawImage(O,0,0,y.width,y.height);let P=E.getImageData(0,0,y.width,y.height);p.height=y.height,p.width=y.width,g(wt(P.data,p))}});throw new Error("Input data provided is not supported - aborted tensor creation")}if(f!==void 0)return wt(f,p);throw new Error("Input data provided is not supported - aborted tensor creation")},mr=(o,r)=>{let{width:n,height:u,download:s,dispose:l}=r,f=[1,u,n,4];return new J({location:"texture",type:"float32",texture:o,dims:f,download:s,dispose:l})},hr=(o,r)=>{let{dataType:n,dims:u,download:s,dispose:l}=r;return new J({location:"gpu-buffer",type:n??"float32",gpuBuffer:o,dims:u,download:s,dispose:l})},yr=(o,r,n)=>new J({location:"cpu-pinned",type:o,data:r,dims:n??[r.length]})});var Re,Ke,wr,br,Er=D(()=>{Re=new Map([["float32",Float32Array],["uint8",Uint8Array],["int8",Int8Array],["uint16",Uint16Array],["float16",Uint16Array],["int16",Int16Array],["int32",Int32Array],["bool",Uint8Array],["float64",Float64Array],["uint32",Uint32Array]]),Ke=new Map([[Float32Array,"float32"],[Uint8Array,"uint8"],[Int8Array,"int8"],[Uint16Array,"uint16"],[Int16Array,"int16"],[Int32Array,"int32"],[Float64Array,"float64"],[Uint32Array,"uint32"]]),wr=!1,br=()=>{if(!wr){wr=!0;let o=typeof BigInt64Array<"u"&&typeof BigInt64Array.from=="function",r=typeof BigUint64Array<"u"&&typeof BigUint64Array.from=="function";o&&(Re.set("int64",BigInt64Array),Ke.set(BigInt64Array,"int64")),r&&(Re.set("uint64",BigUint64Array),Ke.set(BigUint64Array,"uint64"))}}});var vr,Tr,Ar=D(()=>{Ze();vr=o=>{let r=1;for(let n=0;n<o.length;n++){let u=o[n];if(typeof u!="number"||!Number.isSafeInteger(u))throw new TypeError(`dims[${n}] must be an integer, got: ${u}`);if(u<0)throw new RangeError(`dims[${n}] must be a non-negative integer, got: ${u}`);r*=u}return r},Tr=(o,r)=>{switch(o.location){case"cpu":return new J(o.type,o.data,r);case"cpu-pinned":return new J({location:"cpu-pinned",data:o.data,type:o.type,dims:r});case"texture":return new J({location:"texture",texture:o.texture,type:o.type,dims:r});case"gpu-buffer":return new J({location:"gpu-buffer",gpuBuffer:o.gpuBuffer,type:o.type,dims:r});default:throw new Error(`tensorReshape: tensor location ${o.location} is not supported`)}}});var J,Ze=D(()=>{dr();gr();Er();Ar();J=class{constructor(r,n,u){br();let s,l;if(typeof r=="object"&&"location"in r)switch(this.dataLocation=r.location,s=r.type,l=r.dims,r.location){case"cpu-pinned":{let p=Re.get(s);if(!p)throw new TypeError(`unsupported type "${s}" to create tensor from pinned buffer`);if(!(r.data instanceof p))throw new TypeError(`buffer should be of type ${p.name}`);this.cpuData=r.data;break}case"texture":{if(s!=="float32")throw new TypeError(`unsupported type "${s}" to create tensor from texture`);this.gpuTextureData=r.texture,this.downloader=r.download,this.disposer=r.dispose;break}case"gpu-buffer":{if(s!=="float32"&&s!=="float16"&&s!=="int32"&&s!=="int64"&&s!=="uint32"&&s!=="bool")throw new TypeError(`unsupported type "${s}" to create tensor from gpu buffer`);this.gpuBufferData=r.gpuBuffer,this.downloader=r.download,this.disposer=r.dispose;break}default:throw new Error(`Tensor constructor: unsupported location '${this.dataLocation}'`)}else{let p,h;if(typeof r=="string")if(s=r,h=u,r==="string"){if(!Array.isArray(n))throw new TypeError("A string tensor's data must be a string array.");p=n}else{let m=Re.get(r);if(m===void 0)throw new TypeError(`Unsupported tensor type: ${r}.`);if(Array.isArray(n)){if(r==="float16")throw new TypeError("Creating a float16 tensor from number array is not supported. Please use Uint16Array as data.");r==="uint64"||r==="int64"?p=m.from(n,BigInt):p=m.from(n)}else if(n instanceof m)p=n;else throw new TypeError(`A ${s} tensor's data must be type of ${m}`)}else if(h=n,Array.isArray(r)){if(r.length===0)throw new TypeError("Tensor type cannot be inferred from an empty array.");let m=typeof r[0];if(m==="string")s="string",p=r;else if(m==="boolean")s="bool",p=Uint8Array.from(r);else throw new TypeError(`Invalid element type of data array: ${m}.`)}else{let m=Ke.get(r.constructor);if(m===void 0)throw new TypeError(`Unsupported type for tensor data: ${r.constructor}.`);s=m,p=r}if(h===void 0)h=[p.length];else if(!Array.isArray(h))throw new TypeError("A tensor's dims must be a number array");l=h,this.cpuData=p,this.dataLocation="cpu"}let f=vr(l);if(this.cpuData&&f!==this.cpuData.length)throw new Error(`Tensor's size(${f}) does not match data length(${this.cpuData.length}).`);this.type=s,this.dims=l,this.size=f}static async fromImage(r,n){return pr(r,n)}static fromTexture(r,n){return mr(r,n)}static fromGpuBuffer(r,n){return hr(r,n)}static fromPinnedBuffer(r,n,u){return yr(r,n,u)}toDataURL(r){return cr(this,r)}toImageData(r){return lr(this,r)}get data(){if(this.ensureValid(),!this.cpuData)throw new Error("The data is not on CPU. Use `getData()` to download GPU data to CPU, or use `texture` or `gpuBuffer` property to access the GPU data directly.");return this.cpuData}get location(){return this.dataLocation}get texture(){if(this.ensureValid(),!this.gpuTextureData)throw new Error("The data is not stored as a WebGL texture.");return this.gpuTextureData}get gpuBuffer(){if(this.ensureValid(),!this.gpuBufferData)throw new Error("The data is not stored as a WebGPU buffer.");return this.gpuBufferData}async getData(r){switch(this.ensureValid(),this.dataLocation){case"cpu":case"cpu-pinned":return this.data;case"texture":case"gpu-buffer":{if(!this.downloader)throw new Error("The current tensor is not created with a specified data downloader.");if(this.isDownloading)throw new Error("The current tensor is being downloaded.");try{this.isDownloading=!0;let n=await this.downloader();return this.downloader=void 0,this.dataLocation="cpu",this.cpuData=n,r&&this.disposer&&(this.disposer(),this.disposer=void 0),n}finally{this.isDownloading=!1}}default:throw new Error(`cannot get data from location: ${this.dataLocation}`)}}dispose(){if(this.isDownloading)throw new Error("The current tensor is being downloaded.");this.disposer&&(this.disposer(),this.disposer=void 0),this.cpuData=void 0,this.gpuTextureData=void 0,this.gpuBufferData=void 0,this.downloader=void 0,this.isDownloading=void 0,this.dataLocation="none"}ensureValid(){if(this.dataLocation==="none")throw new Error("The tensor is disposed.")}reshape(r){if(this.ensureValid(),this.downloader||this.disposer)throw new Error("Cannot reshape a tensor that owns GPU resource.");return Tr(this,r)}}});var G,Qe=D(()=>{Ze();G=J});var bt,Sr,pe,me,Et=D(()=>{gt();bt=(o,r)=>{ve.wasm.trace&&console.timeStamp(`${o}::ORT::${r}`)},Sr=(o,r)=>{let n=new Error().stack?.split(/\r\n|\r|\n/g)||[],u=!1;for(let s=0;s<n.length;s++){if(u&&!n[s].includes("TRACE_FUNC")){let l=`FUNC_${o}::${n[s].trim().split(" ")[1]}`;r&&(l+=`::${r}`),bt("CPU",l);return}n[s].includes("TRACE_FUNC")&&(u=!0)}},pe=o=>{ve.wasm.trace&&Sr("BEGIN",o)},me=o=>{ve.wasm.trace&&Sr("END",o)}});var et,Or=D(()=>{Je();Qe();Et();et=class o{constructor(r){this.handler=r}async run(r,n,u){pe();let s={},l={};if(typeof r!="object"||r===null||r instanceof G||Array.isArray(r))throw new TypeError("'feeds' must be an object that use input names as keys and OnnxValue as corresponding values.");let f=!0;if(typeof n=="object"){if(n===null)throw new TypeError("Unexpected argument[1]: cannot be null.");if(n instanceof G)throw new TypeError("'fetches' cannot be a Tensor");if(Array.isArray(n)){if(n.length===0)throw new TypeError("'fetches' cannot be an empty array.");f=!1;for(let m of n){if(typeof m!="string")throw new TypeError("'fetches' must be a string array or an object.");if(this.outputNames.indexOf(m)===-1)throw new RangeError(`'fetches' contains invalid output name: ${m}.`);s[m]=null}if(typeof u=="object"&&u!==null)l=u;else if(typeof u<"u")throw new TypeError("'options' must be an object.")}else{let m=!1,g=Object.getOwnPropertyNames(n);for(let b of this.outputNames)if(g.indexOf(b)!==-1){let y=n[b];(y===null||y instanceof G)&&(m=!0,f=!1,s[b]=y)}if(m){if(typeof u=="object"&&u!==null)l=u;else if(typeof u<"u")throw new TypeError("'options' must be an object.")}else l=n}}else if(typeof n<"u")throw new TypeError("Unexpected argument[1]: must be 'fetches' or 'options'.");for(let m of this.inputNames)if(typeof r[m]>"u")throw new Error(`input '${m}' is missing in 'feeds'.`);if(f)for(let m of this.outputNames)s[m]=null;let p=await this.handler.run(r,s,l),h={};for(let m in p)if(Object.hasOwnProperty.call(p,m)){let g=p[m];g instanceof G?h[m]=g:h[m]=new G(g.type,g.data,g.dims)}return me(),h}async release(){return this.handler.dispose()}static async create(r,n,u,s){pe();let l,f={};if(typeof r=="string"){if(l=r,typeof n=="object"&&n!==null)f=n;else if(typeof n<"u")throw new TypeError("'options' must be an object.")}else if(r instanceof Uint8Array){if(l=r,typeof n=="object"&&n!==null)f=n;else if(typeof n<"u")throw new TypeError("'options' must be an object.")}else if(r instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&r instanceof SharedArrayBuffer){let b=r,y=0,E=r.byteLength;if(typeof n=="object"&&n!==null)f=n;else if(typeof n=="number"){if(y=n,!Number.isSafeInteger(y))throw new RangeError("'byteOffset' must be an integer.");if(y<0||y>=b.byteLength)throw new RangeError(`'byteOffset' is out of range [0, ${b.byteLength}).`);if(E=r.byteLength-y,typeof u=="number"){if(E=u,!Number.isSafeInteger(E))throw new RangeError("'byteLength' must be an integer.");if(E<=0||y+E>b.byteLength)throw new RangeError(`'byteLength' is out of range (0, ${b.byteLength-y}].`);if(typeof s=="object"&&s!==null)f=s;else if(typeof s<"u")throw new TypeError("'options' must be an object.")}else if(typeof u<"u")throw new TypeError("'byteLength' must be a number.")}else if(typeof n<"u")throw new TypeError("'options' must be an object.");l=new Uint8Array(b,y,E)}else throw new TypeError("Unexpected argument[0]: must be 'path' or 'buffer'.");let h=(f.executionProviders||[]).map(b=>typeof b=="string"?b:b.name),g=await(await Xe(h)).createInferenceSessionHandler(l,f);return me(),new o(g)}startProfiling(){this.handler.startProfiling()}endProfiling(){this.handler.endProfiling()}get inputNames(){return this.handler.inputNames}get outputNames(){return this.handler.outputNames}}});var xr,Ir=D(()=>{Or();xr=et});var Pr=D(()=>{});var Hn,tt,Br=D(()=>{Je();Qe();Hn="Training backend could not be resolved. Make sure you're using the correct configuration & WebAssembly files.",tt=class o{constructor(r,n,u){this.handler=r,this.hasOptimizerModel=n,this.hasEvalModel=u}get trainingInputNames(){return this.handler.inputNames}get trainingOutputNames(){return this.handler.outputNames}get evalInputNames(){if(this.hasEvalModel)return this.handler.evalInputNames;throw new Error("This training session has no evalModel loaded.")}get evalOutputNames(){if(this.hasEvalModel)return this.handler.evalOutputNames;throw new Error("This training session has no evalModel loaded.")}static async create(r,n){let u=r.evalModel||"",s=r.optimizerModel||"",l=n||{},p=(l.executionProviders||[]).map(m=>typeof m=="string"?m:m.name),h=await Xe(p);if(h.createTrainingSessionHandler){let m=await h.createTrainingSessionHandler(r.checkpointState,r.trainModel,u,s,l);return new o(m,!!r.optimizerModel,!!r.evalModel)}else throw new Error(Hn)}typeNarrowingForRunStep(r,n,u,s,l){let f={},p={};if(typeof u!="object"||u===null||u instanceof G||Array.isArray(u))throw new TypeError("'feeds' must be an object that use input names as keys and OnnxValue as corresponding values.");let h=!0;if(typeof s=="object"){if(s===null)throw new TypeError("Unexpected argument[1]: cannot be null.");if(s instanceof G)throw new TypeError("'fetches' cannot be a Tensor");if(Array.isArray(s)){if(s.length===0)throw new TypeError("'fetches' cannot be an empty array.");h=!1;for(let m of s){if(typeof m!="string")throw new TypeError("'fetches' must be a string array or an object.");if(n.indexOf(m)===-1)throw new RangeError(`'fetches' contains invalid output name: ${m}.`);f[m]=null}if(typeof l=="object"&&l!==null)p=l;else if(typeof l<"u")throw new TypeError("'options' must be an object.")}else{let m=!1,g=Object.getOwnPropertyNames(s);for(let b of n)if(g.indexOf(b)!==-1){let y=s[b];(y===null||y instanceof G)&&(m=!0,h=!1,f[b]=y)}if(m){if(typeof l=="object"&&l!==null)p=l;else if(typeof l<"u")throw new TypeError("'options' must be an object.")}else p=s}}else if(typeof s<"u")throw new TypeError("Unexpected argument[1]: must be 'fetches' or 'options'.");for(let m of r)if(typeof u[m]>"u")throw new Error(`input '${m}' is missing in 'feeds'.`);if(h)for(let m of n)f[m]=null;return[f,p]}convertHandlerReturnTypeToMapOfTensors(r){let n={};for(let u in r)if(Object.hasOwnProperty.call(r,u)){let s=r[u];s instanceof G?n[u]=s:n[u]=new G(s.type,s.data,s.dims)}return n}async lazyResetGrad(){await this.handler.lazyResetGrad()}async runTrainStep(r,n,u){let[s,l]=this.typeNarrowingForRunStep(this.trainingInputNames,this.trainingOutputNames,r,n,u),f=await this.handler.runTrainStep(r,s,l);return this.convertHandlerReturnTypeToMapOfTensors(f)}async runOptimizerStep(r){if(this.hasOptimizerModel)await this.handler.runOptimizerStep(r||{});else throw new Error("This TrainingSession has no OptimizerModel loaded.")}async runEvalStep(r,n,u){if(this.hasEvalModel){let[s,l]=this.typeNarrowingForRunStep(this.evalInputNames,this.evalOutputNames,r,n,u),f=await this.handler.runEvalStep(r,s,l);return this.convertHandlerReturnTypeToMapOfTensors(f)}else throw new Error("This TrainingSession has no EvalModel loaded.")}async getParametersSize(r=!0){return this.handler.getParametersSize(r)}async loadParametersBuffer(r,n=!0){let u=await this.getParametersSize(n);if(r.length!==4*u)throw new Error("Size of the buffer passed into loadParametersBuffer must match the number of parameters in the model. Please use getParametersSize method to check.");return this.handler.loadParametersBuffer(r,n)}async getContiguousParameters(r=!0){return this.handler.getContiguousParameters(r)}async release(){return this.handler.dispose()}}});var Cr,_r=D(()=>{Br();Cr=tt});var vt={};De(vt,{InferenceSession:()=>xr,TRACE:()=>bt,TRACE_FUNC_BEGIN:()=>pe,TRACE_FUNC_END:()=>me,Tensor:()=>G,TrainingSession:()=>Cr,env:()=>F,registerBackend:()=>Oe});var Te=D(()=>{ir();fr();Ir();Qe();Et();Pr();_r()});var Rr={};De(Rr,{createReadStream:()=>Dr,readFile:()=>zn,readFileSync:()=>Gn});var zn,Gn,Dr,Lr=D(()=>{zn=void 0,Gn=void 0,Dr=void 0});var Mr={};De(Mr,{join:()=>Yn});var Yn,Fr=D(()=>{Yn=void 0});var Nr=$n((Wr,Tt)=>{"use strict";var kr=(()=>{var o=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return typeof __filename<"u"&&(o=o||__filename),function(r={}){var n=r,u,s;n.ready=new Promise((e,t)=>{u=e,s=t});var l=Object.assign({},n),f="./this.program",p=typeof window=="object",h=typeof importScripts=="function",m=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",g="",b,y,E;if(m){var O=(Lr(),Ve(Rr)),P=(Fr(),Ve(Mr));g=h?P.dirname(g)+"/":__dirname+"/",b=(e,t)=>(e=ge(e)?new URL(e):P.normalize(e),O.readFileSync(e,t?void 0:"utf8")),E=e=>(e=b(e,!0),e.buffer||(e=new Uint8Array(e)),e),y=(e,t,i,a=!0)=>{e=ge(e)?new URL(e):P.normalize(e),O.readFile(e,a?void 0:"utf8",(c,w)=>{c?i(c):t(a?w.buffer:w)})},!n.thisProgram&&1<process.argv.length&&(f=process.argv[1].replace(/\\/g,"/")),process.argv.slice(2),n.inspect=()=>"[Emscripten Module object]"}else(p||h)&&(h?g=self.location.href:typeof document<"u"&&document.currentScript&&(g=document.currentScript.src),o&&(g=o),g.indexOf("blob:")!==0?g=g.substr(0,g.replace(/[?#].*/,"").lastIndexOf("/")+1):g="",b=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},h&&(E=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),y=(e,t,i)=>{var a=new XMLHttpRequest;a.open("GET",e,!0),a.responseType="arraybuffer",a.onload=()=>{a.status==200||a.status==0&&a.response?t(a.response):i()},a.onerror=i,a.send(null)});var L=console.log.bind(console),B=console.error.bind(console);Object.assign(n,l),l=null,typeof WebAssembly!="object"&&We("no native wasm support detected");var C,H=!1,z,M,oe,he,v,R,ke,Ie,Pe,ie;function _(){var e=C.buffer;n.HEAP8=z=new Int8Array(e),n.HEAP16=oe=new Int16Array(e),n.HEAPU8=M=new Uint8Array(e),n.HEAPU16=he=new Uint16Array(e),n.HEAP32=v=new Int32Array(e),n.HEAPU32=R=new Uint32Array(e),n.HEAPF32=ke=new Float32Array(e),n.HEAPF64=ie=new Float64Array(e),n.HEAP64=Ie=new BigInt64Array(e),n.HEAPU64=Pe=new BigUint64Array(e)}var se=[],Ae=[],te=[],re=0,Y=null,V=null;function We(e){throw e="Aborted("+e+")",B(e),H=!0,e=new WebAssembly.RuntimeError(e+". Build with -sASSERTIONS for more info."),s(e),e}var ye=e=>e.startsWith("data:application/octet-stream;base64,"),ge=e=>e.startsWith("file://"),ce;if(ce="ort-wasm.wasm",!ye(ce)){var Ne=ce;ce=n.locateFile?n.locateFile(Ne,g):g+Ne}function le(e){if(E)return E(e);throw"both async and sync fetching of the wasm failed"}function we(e){if(p||h){if(typeof fetch=="function"&&!ge(e))return fetch(e,{credentials:"same-origin"}).then(t=>{if(!t.ok)throw"failed to load wasm binary file at '"+e+"'";return t.arrayBuffer()}).catch(()=>le(e));if(y)return new Promise((t,i)=>{y(e,a=>t(new Uint8Array(a)),i)})}return Promise.resolve().then(()=>le(e))}function Be(e,t,i){return we(e).then(a=>WebAssembly.instantiate(a,t)).then(a=>a).then(i,a=>{B(`failed to asynchronously prepare wasm: ${a}`),We(a)})}function q(e,t){var i=ce;return typeof WebAssembly.instantiateStreaming!="function"||ye(i)||ge(i)||m||typeof fetch!="function"?Be(i,e,t):fetch(i,{credentials:"same-origin"}).then(a=>WebAssembly.instantiateStreaming(a,e).then(t,function(c){return B(`wasm streaming compile failed: ${c}`),B("falling back to ArrayBuffer instantiation"),Be(i,e,t)}))}var X={1358424:(e,t,i,a)=>{if(typeof n>"u"||!n.cb)return 1;if(e=Ue(e>>>0),e.startsWith("./")&&(e=e.substring(2)),e=n.cb.get(e),!e)return 2;if(t>>>=0,i>>>=0,t+i>e.byteLength)return 3;try{return M.set(e.subarray(t,t+i),a>>>0>>>0),0}catch{return 4}}};function Ce(e){this.Ua=e-24,this.fb=function(t){R[this.Ua+4>>>2>>>0]=t},this.eb=function(t){R[this.Ua+8>>>2>>>0]=t},this.Ya=function(t,i){this.Za(),this.fb(t),this.eb(i)},this.Za=function(){R[this.Ua+16>>>2>>>0]=0}}var _e=0,at=0,Dt=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,Rt=(e,t,i)=>{t>>>=0;var a=t+i;for(i=t;e[i]&&!(i>=a);)++i;if(16<i-t&&e.buffer&&Dt)return Dt.decode(e.subarray(t,i));for(a="";t<i;){var c=e[t++];if(c&128){var w=e[t++]&63;if((c&224)==192)a+=String.fromCharCode((c&31)<<6|w);else{var T=e[t++]&63;c=(c&240)==224?(c&15)<<12|w<<6|T:(c&7)<<18|w<<12|T<<6|e[t++]&63,65536>c?a+=String.fromCharCode(c):(c-=65536,a+=String.fromCharCode(55296|c>>10,56320|c&1023))}}else a+=String.fromCharCode(c)}return a},Ue=(e,t)=>(e>>>=0)?Rt(M,e,t):"",$e=e=>{for(var t=0,i=0;i<e.length;++i){var a=e.charCodeAt(i);127>=a?t++:2047>=a?t+=2:55296<=a&&57343>=a?(t+=4,++i):t+=3}return t},je=(e,t,i,a)=>{if(i>>>=0,!(0<a))return 0;var c=i;a=i+a-1;for(var w=0;w<e.length;++w){var T=e.charCodeAt(w);if(55296<=T&&57343>=T){var A=e.charCodeAt(++w);T=65536+((T&1023)<<10)|A&1023}if(127>=T){if(i>=a)break;t[i++>>>0]=T}else{if(2047>=T){if(i+1>=a)break;t[i++>>>0]=192|T>>6}else{if(65535>=T){if(i+2>=a)break;t[i++>>>0]=224|T>>12}else{if(i+3>=a)break;t[i++>>>0]=240|T>>18,t[i++>>>0]=128|T>>12&63}t[i++>>>0]=128|T>>6&63}t[i++>>>0]=128|T&63}}return t[i>>>0]=0,i-c},Lt=e=>{if(e===null)return"null";var t=typeof e;return t==="object"||t==="array"||t==="function"?e.toString():""+e},Mt,ee=e=>{for(var t="";M[e>>>0];)t+=Mt[M[e++>>>0]];return t},ut={},ft={},En={},de;function vn(e,t,i={}){var a=t.name;if(!e)throw new de(`type "${a}" must have a positive integer typeid pointer`);if(ft.hasOwnProperty(e)){if(i.gb)return;throw new de(`Cannot register type '${a}' twice`)}ft[e]=t,delete En[e],ut.hasOwnProperty(e)&&(t=ut[e],delete ut[e],t.forEach(c=>c()))}function ae(e,t,i={}){if(!("argPackAdvance"in t))throw new TypeError("registerType registeredInstance requires argPackAdvance");vn(e,t,i)}var Ft=(e,t,i)=>{switch(t){case 1:return i?a=>z[a>>>0>>>0]:a=>M[a>>>0>>>0];case 2:return i?a=>oe[a>>>1>>>0]:a=>he[a>>>1>>>0];case 4:return i?a=>v[a>>>2>>>0]:a=>R[a>>>2>>>0];case 8:return i?a=>Ie[a>>>3]:a=>Pe[a>>>3];default:throw new TypeError(`invalid integer width (${t}): ${e}`)}};function kt(){this.Ra=[void 0],this.ab=[]}var Q=new kt;function ct(e){e>>>=0,e>=Q.Ua&&--Q.get(e).bb===0&&Q.Za(e)}var Z=e=>{if(!e)throw new de("Cannot use deleted val. handle = "+e);return Q.get(e).value},ne=e=>{switch(e){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:return Q.Ya({bb:1,value:e})}};function Wt(e){return this.fromWireType(v[e>>>2>>>0])}var Tn=(e,t)=>{switch(t){case 4:return function(i){return this.fromWireType(ke[i>>>2>>>0])};case 8:return function(i){return this.fromWireType(ie[i>>>3>>>0])};default:throw new TypeError(`invalid float width (${t}): ${e}`)}};function An(e){return this.fromWireType(R[e>>>2>>>0])}var Nt=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0,Sn=(e,t)=>{for(var i=e>>1,a=i+t/2;!(i>=a)&&he[i>>>0];)++i;if(i<<=1,32<i-e&&Nt)return Nt.decode(M.subarray(e>>>0,i>>>0));for(i="",a=0;!(a>=t/2);++a){var c=oe[e+2*a>>>1>>>0];if(c==0)break;i+=String.fromCharCode(c)}return i},On=(e,t,i)=>{if(i??=2147483647,2>i)return 0;i-=2;var a=t;i=i<2*e.length?i/2:e.length;for(var c=0;c<i;++c)oe[t>>>1>>>0]=e.charCodeAt(c),t+=2;return oe[t>>>1>>>0]=0,t-a},xn=e=>2*e.length,In=(e,t)=>{for(var i=0,a="";!(i>=t/4);){var c=v[e+4*i>>>2>>>0];if(c==0)break;++i,65536<=c?(c-=65536,a+=String.fromCharCode(55296|c>>10,56320|c&1023)):a+=String.fromCharCode(c)}return a},Pn=(e,t,i)=>{if(t>>>=0,i??=2147483647,4>i)return 0;var a=t;i=a+i-4;for(var c=0;c<e.length;++c){var w=e.charCodeAt(c);if(55296<=w&&57343>=w){var T=e.charCodeAt(++c);w=65536+((w&1023)<<10)|T&1023}if(v[t>>>2>>>0]=w,t+=4,t+4>i)break}return v[t>>>2>>>0]=0,t-a},Bn=e=>{for(var t=0,i=0;i<e.length;++i){var a=e.charCodeAt(i);55296<=a&&57343>=a&&++i,t+=4}return t},lt=(e,t)=>{var i=ft[e];if(i===void 0)throw e=Qt(e),i=ee(e),ue(e),new de(t+" has unknown type "+i);return i},$t=(e,t,i)=>{var a=[];return e=e.toWireType(a,i),a.length&&(R[t>>>2>>>0]=ne(a)),e},He=[],Cn={},dt=e=>{var t=Cn[e];return t===void 0?ee(e):t},jt=()=>typeof globalThis=="object"?globalThis:Function("return this")(),_n=e=>{var t=He.length;return He.push(e),t},Un=(e,t)=>{for(var i=Array(e),a=0;a<e;++a)i[a]=lt(R[t+4*a>>>2>>>0],"parameter "+a);return i},Ht=(e,t)=>Object.defineProperty(t,"name",{value:e});function Dn(e){var t=Function;if(!(t instanceof Function))throw new TypeError(`new_ called with constructor type ${typeof t} which is not a function`);var i=Ht(t.name||"unknownFunctionName",function(){});return i.prototype=t.prototype,i=new i,e=t.apply(i,e),e instanceof Object?e:i}var Se=e=>e%4===0&&(e%100!==0||e%400===0),zt=[0,31,60,91,121,152,182,213,244,274,305,335],Gt=[0,31,59,90,120,151,181,212,243,273,304,334],Yt=e=>{var t=$e(e)+1,i=Ge(t);return i&&je(e,M,i,t),i},pt=[],mt={},Vt=()=>{if(!ht){var e={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:f||"./this.program"},t;for(t in mt)mt[t]===void 0?delete e[t]:e[t]=mt[t];var i=[];for(t in e)i.push(`${t}=${e[t]}`);ht=i}return ht},ht,Rn=[null,[],[]],qt=[31,29,31,30,31,30,31,31,30,31,30,31],Xt=[31,28,31,30,31,30,31,31,30,31,30,31];function Ln(e){var t=Array($e(e)+1);return je(e,t,0,t.length),t}function Jt(e,t,i,a){function c(d,U,W){for(d=typeof d=="number"?d.toString():d||"";d.length<U;)d=W[0]+d;return d}function w(d,U){return c(d,U,"0")}function T(d,U){function W(or){return 0>or?-1:0<or?1:0}var be;return(be=W(d.getFullYear()-U.getFullYear()))===0&&(be=W(d.getMonth()-U.getMonth()))===0&&(be=W(d.getDate()-U.getDate())),be}function A(d){switch(d.getDay()){case 0:return new Date(d.getFullYear()-1,11,29);case 1:return d;case 2:return new Date(d.getFullYear(),0,3);case 3:return new Date(d.getFullYear(),0,2);case 4:return new Date(d.getFullYear(),0,1);case 5:return new Date(d.getFullYear()-1,11,31);case 6:return new Date(d.getFullYear()-1,11,30)}}function I(d){var U=d.Sa;for(d=new Date(new Date(d.Ta+1900,0,1).getTime());0<U;){var W=d.getMonth(),be=(Se(d.getFullYear())?qt:Xt)[W];if(U>be-d.getDate())U-=be-d.getDate()+1,d.setDate(1),11>W?d.setMonth(W+1):(d.setMonth(0),d.setFullYear(d.getFullYear()+1));else{d.setDate(d.getDate()+U);break}}return W=new Date(d.getFullYear()+1,0,4),U=A(new Date(d.getFullYear(),0,4)),W=A(W),0>=T(U,d)?0>=T(W,d)?d.getFullYear()+1:d.getFullYear():d.getFullYear()-1}e>>>=0,t>>>=0,i>>>=0,a>>>=0;var S=R[a+40>>>2>>>0];a={kb:v[a>>>2>>>0],jb:v[a+4>>>2>>>0],Wa:v[a+8>>>2>>>0],$a:v[a+12>>>2>>>0],Xa:v[a+16>>>2>>>0],Ta:v[a+20>>>2>>>0],Na:v[a+24>>>2>>>0],Sa:v[a+28>>>2>>>0],mb:v[a+32>>>2>>>0],ib:v[a+36>>>2>>>0],lb:S?Ue(S):""},i=Ue(i),S={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"};for(var k in S)i=i.replace(new RegExp(k,"g"),S[k]);var K="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),fe="January February March April May June July August September October November December".split(" ");S={"%a":d=>K[d.Na].substring(0,3),"%A":d=>K[d.Na],"%b":d=>fe[d.Xa].substring(0,3),"%B":d=>fe[d.Xa],"%C":d=>w((d.Ta+1900)/100|0,2),"%d":d=>w(d.$a,2),"%e":d=>c(d.$a,2," "),"%g":d=>I(d).toString().substring(2),"%G":d=>I(d),"%H":d=>w(d.Wa,2),"%I":d=>(d=d.Wa,d==0?d=12:12<d&&(d-=12),w(d,2)),"%j":d=>{for(var U=0,W=0;W<=d.Xa-1;U+=(Se(d.Ta+1900)?qt:Xt)[W++]);return w(d.$a+U,3)},"%m":d=>w(d.Xa+1,2),"%M":d=>w(d.jb,2),"%n":()=>`
`,"%p":d=>0<=d.Wa&&12>d.Wa?"AM":"PM","%S":d=>w(d.kb,2),"%t":()=>"	","%u":d=>d.Na||7,"%U":d=>w(Math.floor((d.Sa+7-d.Na)/7),2),"%V":d=>{var U=Math.floor((d.Sa+7-(d.Na+6)%7)/7);if(2>=(d.Na+371-d.Sa-2)%7&&U++,U)U==53&&(W=(d.Na+371-d.Sa)%7,W==4||W==3&&Se(d.Ta)||(U=1));else{U=52;var W=(d.Na+7-d.Sa-1)%7;(W==4||W==5&&Se(d.Ta%400-1))&&U++}return w(U,2)},"%w":d=>d.Na,"%W":d=>w(Math.floor((d.Sa+7-(d.Na+6)%7)/7),2),"%y":d=>(d.Ta+1900).toString().substring(2),"%Y":d=>d.Ta+1900,"%z":d=>{d=d.ib;var U=0<=d;return d=Math.abs(d)/60,(U?"+":"-")+("0000"+(d/60*100+d%60)).slice(-4)},"%Z":d=>d.lb,"%%":()=>"%"},i=i.replace(/%%/g,"\0\0");for(k in S)i.includes(k)&&(i=i.replace(new RegExp(k,"g"),S[k](a)));return i=i.replace(/\0\0/g,"%"),k=Ln(i),k.length>t?0:(z.set(k,e>>>0),k.length-1)}for(var Zt=Array(256),ze=0;256>ze;++ze)Zt[ze]=String.fromCharCode(ze);Mt=Zt,de=n.BindingError=class extends Error{constructor(e){super(e),this.name="BindingError"}},n.InternalError=class extends Error{constructor(e){super(e),this.name="InternalError"}},Object.assign(kt.prototype,{get(e){return this.Ra[e]},has(e){return this.Ra[e]!==void 0},Ya(e){var t=this.ab.pop()||this.Ra.length;return this.Ra[t]=e,t},Za(e){this.Ra[e]=void 0,this.ab.push(e)}}),Q.Ra.push({value:void 0},{value:null},{value:!0},{value:!1}),Q.Ua=Q.Ra.length,n.count_emval_handles=()=>{for(var e=0,t=Q.Ua;t<Q.Ra.length;++t)Q.Ra[t]!==void 0&&++e;return e};var Mn={a:function(e,t,i){throw e>>>=0,new Ce(e).Ya(t>>>0,i>>>0),_e=e,at++,_e},t:function(){return 0},$:function(){},M:function(){},O:function(){},G:function(){return 0},Z:function(){},U:function(){},Y:function(){},B:function(){},N:function(){},K:function(){},_:function(){},L:function(){},E:function(e,t,i,a,c){t>>>=0,t=ee(t);var w=t.indexOf("u")!=-1;w&&(c=(1n<<64n)-1n),ae(e>>>0,{name:t,fromWireType:T=>T,toWireType:function(T,A){if(typeof A!="bigint"&&typeof A!="number")throw new TypeError(`Cannot convert "${Lt(A)}" to ${this.name}`);if(A<a||A>c)throw new TypeError(`Passing a number "${Lt(A)}" from JS side to C/C++ side to an argument of type "${t}", which is outside the valid range [${a}, ${c}]!`);return A},argPackAdvance:8,readValueFromPointer:Ft(t,i>>>0,!w),Va:null})},da:function(e,t,i,a){t=ee(t>>>0),ae(e>>>0,{name:t,fromWireType:function(c){return!!c},toWireType:function(c,w){return w?i:a},argPackAdvance:8,readValueFromPointer:function(c){return this.fromWireType(M[c>>>0])},Va:null})},ca:function(e,t){t=ee(t>>>0),ae(e>>>0,{name:t,fromWireType:i=>{var a=Z(i);return ct(i),a},toWireType:(i,a)=>ne(a),argPackAdvance:8,readValueFromPointer:Wt,Va:null})},D:function(e,t,i){t=ee(t>>>0),ae(e>>>0,{name:t,fromWireType:a=>a,toWireType:(a,c)=>c,argPackAdvance:8,readValueFromPointer:Tn(t,i>>>0),Va:null})},q:function(e,t,i,a,c){if(e>>>=0,i>>>=0,t=ee(t>>>0),c===-1&&(c=4294967295),c=A=>A,a===0){var w=32-8*i;c=A=>A<<w>>>w}var T=t.includes("unsigned")?function(A,I){return I>>>0}:function(A,I){return I};ae(e,{name:t,fromWireType:c,toWireType:T,argPackAdvance:8,readValueFromPointer:Ft(t,i,a!==0),Va:null})},l:function(e,t,i){function a(w){return new c(z.buffer,R[w+4>>>2>>>0],R[w>>>2>>>0])}var c=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array,BigInt64Array,BigUint64Array][t];i=ee(i>>>0),ae(e>>>0,{name:i,fromWireType:a,argPackAdvance:8,readValueFromPointer:a},{gb:!0})},F:function(e,t){t=ee(t>>>0);var i=t==="std::string";ae(e>>>0,{name:t,fromWireType:function(a){var c=R[a>>>2>>>0],w=a+4;if(i)for(var T=w,A=0;A<=c;++A){var I=w+A;if(A==c||M[I>>>0]==0){if(T=Ue(T,I-T),S===void 0)var S=T;else S+=String.fromCharCode(0),S+=T;T=I+1}}else{for(S=Array(c),A=0;A<c;++A)S[A]=String.fromCharCode(M[w+A>>>0]);S=S.join("")}return ue(a),S},toWireType:function(a,c){c instanceof ArrayBuffer&&(c=new Uint8Array(c));var w=typeof c=="string";if(!(w||c instanceof Uint8Array||c instanceof Uint8ClampedArray||c instanceof Int8Array))throw new de("Cannot pass non-string to std::string");var T=i&&w?$e(c):c.length,A=Ge(4+T+1),I=A+4;if(R[A>>>2>>>0]=T,i&&w)je(c,M,I,T+1);else if(w)for(w=0;w<T;++w){var S=c.charCodeAt(w);if(255<S)throw ue(I),new de("String has UTF-16 code units that do not fit in 8 bits");M[I+w>>>0]=S}else for(w=0;w<T;++w)M[I+w>>>0]=c[w];return a!==null&&a.push(ue,A),A},argPackAdvance:8,readValueFromPointer:An,Va(a){ue(a)}})},v:function(e,t,i){if(t>>>=0,i>>>=0,i=ee(i),t===2)var a=Sn,c=On,w=xn,T=()=>he,A=1;else t===4&&(a=In,c=Pn,w=Bn,T=()=>R,A=2);ae(e>>>0,{name:i,fromWireType:I=>{for(var S=R[I>>>2>>>0],k=T(),K,fe=I+4,d=0;d<=S;++d){var U=I+4+d*t;(d==S||k[U>>>A]==0)&&(fe=a(fe,U-fe),K===void 0?K=fe:(K+=String.fromCharCode(0),K+=fe),fe=U+t)}return ue(I),K},toWireType:(I,S)=>{if(typeof S!="string")throw new de(`Cannot pass non-string to C++ string type ${i}`);var k=w(S),K=Ge(4+k+t);return R[K>>>2]=k>>A,c(S,K+4,k+t),I!==null&&I.push(ue,K),K},argPackAdvance:8,readValueFromPointer:Wt,Va(I){ue(I)}})},ea:function(e,t){t=ee(t>>>0),ae(e>>>0,{hb:!0,name:t,argPackAdvance:0,fromWireType:()=>{},toWireType:()=>{}})},aa:()=>1,o:function(e,t,i){return t>>>=0,i>>>=0,e=Z(e>>>0),t=lt(t,"emval::as"),$t(t,i,e)},x:function(e,t,i,a){return i>>>=0,a>>>=0,e=He[e>>>0],t=Z(t>>>0),e(null,t,i,a)},j:function(e,t,i,a,c){return i>>>=0,a>>>=0,c>>>=0,e=He[e>>>0],t=Z(t>>>0),i=dt(i),e(t,t[i],a,c)},b:ct,w:function(e,t){return t>>>=0,e=Z(e>>>0),t=Z(t),e==t},s:function(e){return e>>>=0,e===0?ne(jt()):(e=dt(e),ne(jt()[e]))},i:function(e,t,i){t=Un(e,t>>>0);var a=t.shift();e--;var c=`return function (obj, func, destructorsRef, args) {
`,w=0,T=[];i===0&&T.push("obj");for(var A=["retType"],I=[a],S=0;S<e;++S)T.push("arg"+S),A.push("argType"+S),I.push(t[S]),c+=`  var arg${S} = argType${S}.readValueFromPointer(args${w?"+"+w:""});
`,w+=t[S].argPackAdvance;for(c+=`  var rv = ${i===1?"new func":"func.call"}(${T.join(", ")});
`,S=0;S<e;++S)t[S].deleteObject&&(c+=`  argType${S}.deleteObject(arg${S});
`);return a.hb||(A.push("emval_returnValue"),I.push($t),c+=`  return emval_returnValue(retType, destructorsRef, rv);
`),A.push(c+`};
`),e=Dn(A).apply(null,I),i=`methodCaller<(${t.map(k=>k.name).join(", ")}) => ${a.name}>`,_n(Ht(i,e))},p:function(e,t){return t>>>=0,e=Z(e>>>0),t=Z(t),ne(e[t])},c:function(e){e>>>=0,4<e&&(Q.get(e).bb+=1)},r:function(){return ne([])},k:function(e){e=Z(e>>>0);for(var t=Array(e.length),i=0;i<e.length;i++)t[i]=e[i];return ne(t)},d:function(e){return ne(dt(e>>>0))},h:function(){return ne({})},g:function(e){e>>>=0;for(var t=Z(e);t.length;){var i=t.pop();t.pop()(i)}ct(e)},f:function(e,t,i){t>>>=0,i>>>=0,e=Z(e>>>0),t=Z(t),i=Z(i),e[t]=i},e:function(e,t){return t>>>=0,e=lt(e>>>0,"_emval_take_value"),e=e.readValueFromPointer(t),ne(e)},R:function(e,t){e=-9007199254740992>e||9007199254740992<e?NaN:Number(e),t>>>=0,e=new Date(1e3*e),v[t>>>2>>>0]=e.getUTCSeconds(),v[t+4>>>2>>>0]=e.getUTCMinutes(),v[t+8>>>2>>>0]=e.getUTCHours(),v[t+12>>>2>>>0]=e.getUTCDate(),v[t+16>>>2>>>0]=e.getUTCMonth(),v[t+20>>>2>>>0]=e.getUTCFullYear()-1900,v[t+24>>>2>>>0]=e.getUTCDay(),v[t+28>>>2>>>0]=(e.getTime()-Date.UTC(e.getUTCFullYear(),0,1,0,0,0,0))/864e5|0},S:function(e,t){e=-9007199254740992>e||9007199254740992<e?NaN:Number(e),t>>>=0,e=new Date(1e3*e),v[t>>>2>>>0]=e.getSeconds(),v[t+4>>>2>>>0]=e.getMinutes(),v[t+8>>>2>>>0]=e.getHours(),v[t+12>>>2>>>0]=e.getDate(),v[t+16>>>2>>>0]=e.getMonth(),v[t+20>>>2>>>0]=e.getFullYear()-1900,v[t+24>>>2>>>0]=e.getDay(),v[t+28>>>2>>>0]=(Se(e.getFullYear())?zt:Gt)[e.getMonth()]+e.getDate()-1|0,v[t+36>>>2>>>0]=-(60*e.getTimezoneOffset());var i=new Date(e.getFullYear(),6,1).getTimezoneOffset(),a=new Date(e.getFullYear(),0,1).getTimezoneOffset();v[t+32>>>2>>>0]=(i!=a&&e.getTimezoneOffset()==Math.min(a,i))|0},T:function(e){e>>>=0;var t=new Date(v[e+20>>>2>>>0]+1900,v[e+16>>>2>>>0],v[e+12>>>2>>>0],v[e+8>>>2>>>0],v[e+4>>>2>>>0],v[e>>>2>>>0],0),i=v[e+32>>>2>>>0],a=t.getTimezoneOffset(),c=new Date(t.getFullYear(),6,1).getTimezoneOffset(),w=new Date(t.getFullYear(),0,1).getTimezoneOffset(),T=Math.min(w,c);return 0>i?v[e+32>>>2>>>0]=+(c!=w&&T==a):0<i!=(T==a)&&(c=Math.max(w,c),t.setTime(t.getTime()+6e4*((0<i?T:c)-a))),v[e+24>>>2>>>0]=t.getDay(),v[e+28>>>2>>>0]=(Se(t.getFullYear())?zt:Gt)[t.getMonth()]+t.getDate()-1|0,v[e>>>2>>>0]=t.getSeconds(),v[e+4>>>2>>>0]=t.getMinutes(),v[e+8>>>2>>>0]=t.getHours(),v[e+12>>>2>>>0]=t.getDate(),v[e+16>>>2>>>0]=t.getMonth(),v[e+20>>>2>>>0]=t.getYear(),e=t.getTime(),isNaN(e)?(v[Kt()>>>2>>>0]=61,e=-1):e/=1e3,BigInt(e)},P:function(){return-52},Q:function(){},I:function(e,t,i){function a(I){return(I=I.toTimeString().match(/\(([A-Za-z ]+)\)$/))?I[1]:"GMT"}i>>>=0;var c=new Date().getFullYear(),w=new Date(c,0,1),T=new Date(c,6,1);c=w.getTimezoneOffset();var A=T.getTimezoneOffset();R[e>>>0>>>2>>>0]=60*Math.max(c,A),v[t>>>0>>>2>>>0]=+(c!=A),e=a(w),t=a(T),e=Yt(e),t=Yt(t),A<c?(R[i>>>2>>>0]=e,R[i+4>>>2>>>0]=t):(R[i>>>2>>>0]=t,R[i+4>>>2>>>0]=e)},y:()=>{We("")},fa:function(e,t,i){e>>>=0,t>>>=0,i>>>=0,pt.length=0;for(var a;a=M[t++>>>0];){var c=a!=105;c&=a!=112,i+=c&&i%8?4:0,pt.push(a==112?R[i>>>2>>>0]:a==106?Ie[i>>>3]:a==105?v[i>>>2>>>0]:ie[i>>>3>>>0]),i+=c?8:4}return X[e].apply(null,pt)},C:()=>Date.now(),J:function(){return 4294901760},n:()=>performance.now(),H:function(e){e>>>=0;var t=M.length;if(4294901760<e)return!1;for(var i=1;4>=i;i*=2){var a=t*(1+.2/i);a=Math.min(a,e+100663296);var c=Math;a=Math.max(e,a);e:{c=(c.min.call(c,4294901760,a+(65536-a%65536)%65536)-C.buffer.byteLength+65535)/65536;try{C.grow(c),_();var w=1;break e}catch{}w=void 0}if(w)return!0}return!1},W:function(e,t){e>>>=0,t>>>=0;var i=0;return Vt().forEach((a,c)=>{var w=t+i;for(c=R[e+4*c>>>2>>>0]=w,w=0;w<a.length;++w)z[c++>>>0>>>0]=a.charCodeAt(w);z[c>>>0>>>0]=0,i+=a.length+1}),0},X:function(e,t){e>>>=0,t>>>=0;var i=Vt();R[e>>>2>>>0]=i.length;var a=0;return i.forEach(c=>a+=c.length+1),R[t>>>2>>>0]=a,0},u:()=>52,A:function(){return 52},V:function(){return 70},z:function(e,t,i,a){t>>>=0,i>>>=0,a>>>=0;for(var c=0,w=0;w<i;w++){var T=R[t>>>2>>>0],A=R[t+4>>>2>>>0];t+=8;for(var I=0;I<A;I++){var S=M[T+I>>>0],k=Rn[e];S===0||S===10?((e===1?L:B)(Rt(k,0)),k.length=0):k.push(S)}c+=A}return R[a>>>2>>>0]=c,0},ba:Jt,m:function(e,t,i,a){return Jt(e>>>0,t>>>0,i>>>0,a>>>0)}},x=function(){function e(i){return x=i.exports,x=Fn(),C=x.ga,_(),Ae.unshift(x.ha),re--,re==0&&(Y!==null&&(clearInterval(Y),Y=null),V&&(i=V,V=null,i())),x}var t={a:Mn};if(re++,n.instantiateWasm)try{return n.instantiateWasm(t,e)}catch(i){B(`Module.instantiateWasm callback failed with error: ${i}`),s(i)}return q(t,function(i){e(i.instance)}).catch(s),{}}();n._OrtInit=(e,t)=>(n._OrtInit=x.ia)(e,t),n._OrtGetLastError=(e,t)=>(n._OrtGetLastError=x.ja)(e,t),n._OrtCreateSessionOptions=(e,t,i,a,c,w,T,A,I,S)=>(n._OrtCreateSessionOptions=x.ka)(e,t,i,a,c,w,T,A,I,S),n._OrtAppendExecutionProvider=(e,t)=>(n._OrtAppendExecutionProvider=x.la)(e,t),n._OrtAddFreeDimensionOverride=(e,t,i)=>(n._OrtAddFreeDimensionOverride=x.ma)(e,t,i),n._OrtAddSessionConfigEntry=(e,t,i)=>(n._OrtAddSessionConfigEntry=x.na)(e,t,i),n._OrtReleaseSessionOptions=e=>(n._OrtReleaseSessionOptions=x.oa)(e),n._OrtCreateSession=(e,t,i)=>(n._OrtCreateSession=x.pa)(e,t,i),n._OrtReleaseSession=e=>(n._OrtReleaseSession=x.qa)(e),n._OrtGetInputOutputCount=(e,t,i)=>(n._OrtGetInputOutputCount=x.ra)(e,t,i),n._OrtGetInputName=(e,t)=>(n._OrtGetInputName=x.sa)(e,t),n._OrtGetOutputName=(e,t)=>(n._OrtGetOutputName=x.ta)(e,t),n._OrtFree=e=>(n._OrtFree=x.ua)(e),n._OrtCreateTensor=(e,t,i,a,c,w)=>(n._OrtCreateTensor=x.va)(e,t,i,a,c,w),n._OrtGetTensorData=(e,t,i,a,c)=>(n._OrtGetTensorData=x.wa)(e,t,i,a,c),n._OrtReleaseTensor=e=>(n._OrtReleaseTensor=x.xa)(e),n._OrtCreateRunOptions=(e,t,i,a)=>(n._OrtCreateRunOptions=x.ya)(e,t,i,a),n._OrtAddRunConfigEntry=(e,t,i)=>(n._OrtAddRunConfigEntry=x.za)(e,t,i),n._OrtReleaseRunOptions=e=>(n._OrtReleaseRunOptions=x.Aa)(e),n._OrtCreateBinding=e=>(n._OrtCreateBinding=x.Ba)(e),n._OrtBindInput=(e,t,i)=>(n._OrtBindInput=x.Ca)(e,t,i),n._OrtBindOutput=(e,t,i,a)=>(n._OrtBindOutput=x.Da)(e,t,i,a),n._OrtClearBoundOutputs=e=>(n._OrtClearBoundOutputs=x.Ea)(e),n._OrtReleaseBinding=e=>(n._OrtReleaseBinding=x.Fa)(e),n._OrtRunWithBinding=(e,t,i,a,c)=>(n._OrtRunWithBinding=x.Ga)(e,t,i,a,c),n._OrtRun=(e,t,i,a,c,w,T,A)=>(n._OrtRun=x.Ha)(e,t,i,a,c,w,T,A),n._OrtEndProfiling=e=>(n._OrtEndProfiling=x.Ia)(e);var Kt=()=>(Kt=x.Ja)(),Ge=n._malloc=e=>(Ge=n._malloc=x.Ka)(e),ue=n._free=e=>(ue=n._free=x.La)(e),Qt=e=>(Qt=x.Ma)(e),er=()=>(er=x.Oa)(),tr=e=>(tr=x.Pa)(e),rr=e=>(rr=x.Qa)(e);function Fn(){var e=x;e=Object.assign({},e);var t=a=>()=>a()>>>0,i=a=>c=>a(c)>>>0;return e.Ja=t(e.Ja),e.Ka=i(e.Ka),e.Ma=i(e.Ma),e.Oa=t(e.Oa),e.Qa=i(e.Qa),e}n.stackAlloc=rr,n.stackSave=er,n.stackRestore=tr,n.UTF8ToString=Ue,n.stringToUTF8=(e,t,i)=>je(e,M,t,i),n.lengthBytesUTF8=$e;var Ye;V=function e(){Ye||nr(),Ye||(V=e)};function nr(){if(!(0<re)){if(n.preRun)for(typeof n.preRun=="function"&&(n.preRun=[n.preRun]);n.preRun.length;){var e=n.preRun.shift();se.unshift(e)}for(;0<se.length;)se.shift()(n);if(!(0<re||Ye||(Ye=!0,n.calledRun=!0,H))){for(;0<Ae.length;)Ae.shift()(n);for(u(n);0<te.length;)te.shift()(n)}}}return nr(),r.ready}})();typeof Wr=="object"&&typeof Tt=="object"?Tt.exports=kr:typeof define=="function"&&define.amd&&define([],()=>kr)});var Ot,Vn,At,St,rt,$r,qn,Xn,Jn,jr,$,xe=D(()=>{"use strict";Ot=Nr();Vn=Ot,St=!1,rt=!1,$r=!1,qn=o=>{if(o===1)return!1;if(typeof SharedArrayBuffer>"u")return typeof self<"u"&&!self.crossOriginIsolated&&console.warn("env.wasm.numThreads is set to "+o+", but this will not work unless you enable crossOriginIsolated mode. See https://web.dev/cross-origin-isolation-guide/ for more info."),!1;typeof process<"u"&&process.versions&&process.versions.node&&console.warn("env.wasm.numThreads is set to "+o+", however, currently onnxruntime-web does not support multi-threads in Node.js. Please consider using onnxruntime-node for performance critical scenarios.");try{return typeof MessageChannel<"u"&&new MessageChannel().port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11]))}catch{return!1}},Xn=()=>{try{return WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,30,1,28,0,65,0,253,15,253,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,253,186,1,26,11]))}catch{return!1}},Jn=(o,r)=>o?r?"ort-wasm-simd-threaded.wasm":"ort-wasm-simd.wasm":r?"ort-wasm-threaded.wasm":"ort-wasm.wasm",jr=async o=>{if(St)return Promise.resolve();if(rt)throw new Error("multiple calls to 'initializeWebAssembly()' detected.");if($r)throw new Error("previous call to 'initializeWebAssembly()' failed.");rt=!0;let r=o.initTimeout,n=o.numThreads,u=o.simd,s=qn(n),l=u&&Xn(),f=o.wasmPaths,p=typeof f=="string"?f:void 0,h=Jn(l,s),m=typeof f=="object"?f[h]:void 0,g=!1,b=[];if(r>0&&b.push(new Promise(y=>{setTimeout(()=>{g=!0,y()},r)})),b.push(new Promise((y,E)=>{(s?Vn:Ot)({locateFile:(L,B)=>L.endsWith(".wasm")?m||(p??B)+h:B+L}).then(L=>{rt=!1,St=!0,At=L,y()},L=>{rt=!1,$r=!0,E(L)})})),await Promise.race(b),g)throw new Error(`WebAssembly backend initializing failed due to timeout: ${r}ms`)},$=()=>{if(St&&At)return At;throw new Error("WebAssembly is not initialized yet.")}});var j,Le,N,nt=D(()=>{"use strict";xe();j=(o,r)=>{let n=$(),u=n.lengthBytesUTF8(o)+1,s=n._malloc(u);return n.stringToUTF8(o,s,u),r.push(s),s},Le=(o,r,n,u)=>{if(typeof o=="object"&&o!==null){if(n.has(o))throw new Error("Circular reference in options");n.add(o)}Object.entries(o).forEach(([s,l])=>{let f=r?r+s:s;if(typeof l=="object")Le(l,f+".",n,u);else if(typeof l=="string"||typeof l=="number")u(f,l.toString());else if(typeof l=="boolean")u(f,l?"1":"0");else throw new Error(`Can't handle extra config type: ${typeof l}`)})},N=o=>{let r=$(),n=r.stackSave();try{let u=r.stackAlloc(8);r._OrtGetLastError(u,u+4);let s=r.HEAP32[u/4],l=r.HEAPU32[u/4+1],f=l?r.UTF8ToString(l):"";throw new Error(`${o} ERROR_CODE: ${s}, ERROR_MESSAGE: ${f}`)}finally{r.stackRestore(n)}}});var Hr,zr=D(()=>{"use strict";xe();nt();Hr=o=>{let r=$(),n=0,u=[],s=o||{};try{if(o?.logSeverityLevel===void 0)s.logSeverityLevel=2;else if(typeof o.logSeverityLevel!="number"||!Number.isInteger(o.logSeverityLevel)||o.logSeverityLevel<0||o.logSeverityLevel>4)throw new Error(`log serverity level is not valid: ${o.logSeverityLevel}`);if(o?.logVerbosityLevel===void 0)s.logVerbosityLevel=0;else if(typeof o.logVerbosityLevel!="number"||!Number.isInteger(o.logVerbosityLevel))throw new Error(`log verbosity level is not valid: ${o.logVerbosityLevel}`);o?.terminate===void 0&&(s.terminate=!1);let l=0;return o?.tag!==void 0&&(l=j(o.tag,u)),n=r._OrtCreateRunOptions(s.logSeverityLevel,s.logVerbosityLevel,!!s.terminate,l),n===0&&N("Can't create run options."),o?.extra!==void 0&&Le(o.extra,"",new WeakSet,(f,p)=>{let h=j(f,u),m=j(p,u);r._OrtAddRunConfigEntry(n,h,m)!==0&&N(`Can't set a run config entry: ${f} - ${p}.`)}),[n,u]}catch(l){throw n!==0&&r._OrtReleaseRunOptions(n),u.forEach(f=>r._free(f)),l}}});var Zn,Kn,Qn,eo,Gr,Yr=D(()=>{"use strict";xe();nt();Zn=o=>{switch(o){case"disabled":return 0;case"basic":return 1;case"extended":return 2;case"all":return 99;default:throw new Error(`unsupported graph optimization level: ${o}`)}},Kn=o=>{switch(o){case"sequential":return 0;case"parallel":return 1;default:throw new Error(`unsupported execution mode: ${o}`)}},Qn=o=>{o.extra||(o.extra={}),o.extra.session||(o.extra.session={});let r=o.extra.session;r.use_ort_model_bytes_directly||(r.use_ort_model_bytes_directly="1"),o.executionProviders&&o.executionProviders.some(n=>(typeof n=="string"?n:n.name)==="webgpu")&&(o.enableMemPattern=!1)},eo=(o,r,n)=>{for(let u of r){let s=typeof u=="string"?u:u.name;switch(s){case"webnn":if(s="WEBNN",typeof u!="string"){let f=u;if(f?.deviceType){let p=j("deviceType",n),h=j(f.deviceType,n);$()._OrtAddSessionConfigEntry(o,p,h)!==0&&N(`Can't set a session config entry: 'deviceType' - ${f.deviceType}.`)}if(f?.numThreads){let p=f.numThreads;(typeof p!="number"||!Number.isInteger(p)||p<0)&&(p=0);let h=j("numThreads",n),m=j(p.toString(),n);$()._OrtAddSessionConfigEntry(o,h,m)!==0&&N(`Can't set a session config entry: 'numThreads' - ${f.numThreads}.`)}if(f?.powerPreference){let p=j("powerPreference",n),h=j(f.powerPreference,n);$()._OrtAddSessionConfigEntry(o,p,h)!==0&&N(`Can't set a session config entry: 'powerPreference' - ${f.powerPreference}.`)}}break;case"webgpu":if(s="JS",typeof u!="string"){let f=u;if(f?.preferredLayout){if(f.preferredLayout!=="NCHW"&&f.preferredLayout!=="NHWC")throw new Error(`preferredLayout must be either 'NCHW' or 'NHWC': ${f.preferredLayout}`);let p=j("preferredLayout",n),h=j(f.preferredLayout,n);$()._OrtAddSessionConfigEntry(o,p,h)!==0&&N(`Can't set a session config entry: 'preferredLayout' - ${f.preferredLayout}.`)}}break;case"wasm":case"cpu":continue;default:throw new Error(`not supported execution provider: ${s}`)}let l=j(s,n);$()._OrtAppendExecutionProvider(o,l)!==0&&N(`Can't append execution provider: ${s}.`)}},Gr=o=>{let r=$(),n=0,u=[],s=o||{};Qn(s);try{let l=Zn(s.graphOptimizationLevel??"all"),f=Kn(s.executionMode??"sequential"),p=typeof s.logId=="string"?j(s.logId,u):0,h=s.logSeverityLevel??2;if(!Number.isInteger(h)||h<0||h>4)throw new Error(`log serverity level is not valid: ${h}`);let m=s.logVerbosityLevel??0;if(!Number.isInteger(m)||m<0||m>4)throw new Error(`log verbosity level is not valid: ${m}`);let g=typeof s.optimizedModelFilePath=="string"?j(s.optimizedModelFilePath,u):0;if(n=r._OrtCreateSessionOptions(l,!!s.enableCpuMemArena,!!s.enableMemPattern,f,!!s.enableProfiling,0,p,h,m,g),n===0&&N("Can't create session options."),s.executionProviders&&eo(n,s.executionProviders,u),s.freeDimensionOverrides)for(let[b,y]of Object.entries(s.freeDimensionOverrides)){if(typeof b!="string")throw new Error(`free dimension override name must be a string: ${b}`);if(typeof y!="number"||!Number.isInteger(y)||y<0)throw new Error(`free dimension override value must be a non-negative integer: ${y}`);let E=j(b,u);r._OrtAddFreeDimensionOverride(n,E,y)!==0&&N(`Can't set a free dimension override: ${b} - ${y}.`)}return s.extra!==void 0&&Le(s.extra,"",new WeakSet,(b,y)=>{let E=j(b,u),O=j(y,u);r._OrtAddSessionConfigEntry(n,E,O)!==0&&N(`Can't set a session config entry: ${b} - ${y}.`)}),[n,u]}catch(l){throw n!==0&&r._OrtReleaseSessionOptions(n),u.forEach(f=>r._free(f)),l}}});var xt,Vr,It,qr,Xr,ot,Jr,Pt=D(()=>{"use strict";xt=o=>{switch(o){case"int8":return 3;case"uint8":return 2;case"bool":return 9;case"int16":return 5;case"uint16":return 4;case"int32":return 6;case"uint32":return 12;case"float16":return 10;case"float32":return 1;case"float64":return 11;case"string":return 8;case"int64":return 7;case"uint64":return 13;default:throw new Error(`unsupported data type: ${o}`)}},Vr=o=>{switch(o){case 3:return"int8";case 2:return"uint8";case 9:return"bool";case 5:return"int16";case 4:return"uint16";case 6:return"int32";case 12:return"uint32";case 10:return"float16";case 1:return"float32";case 11:return"float64";case 8:return"string";case 7:return"int64";case 13:return"uint64";default:throw new Error(`unsupported data type: ${o}`)}},It=o=>[void 0,4,1,1,2,2,4,8,void 0,1,2,8,4,8,void 0,void 0,void 0][o],qr=o=>{switch(o){case"float16":return Uint16Array;case"float32":return Float32Array;case"uint8":return Uint8Array;case"int8":return Int8Array;case"uint16":return Uint16Array;case"int16":return Int16Array;case"int32":return Int32Array;case"bool":return Uint8Array;case"float64":return Float64Array;case"uint32":return Uint32Array;case"int64":return BigInt64Array;case"uint64":return BigUint64Array;default:throw new Error(`unsupported type: ${o}`)}},Xr=o=>{switch(o){case"verbose":return 0;case"info":return 1;case"warning":return 2;case"error":return 3;case"fatal":return 4;default:throw new Error(`unsupported logging level: ${o}`)}},ot=o=>o==="float32"||o==="int32"||o==="int64"||o==="bool"||o==="float16"||o==="uint32",Jr=o=>{switch(o){case"none":return 0;case"cpu":return 1;case"cpu-pinned":return 2;case"texture":return 3;case"gpu-buffer":return 4;default:throw new Error(`unsupported data location: ${o}`)}}});var Me,Bt=D(()=>{"use strict";Me=async o=>{if(typeof o=="string")if(typeof process<"u"&&process.versions&&process.versions.node)try{return new Uint8Array(await(void 0)(o))}catch(r){if(r.code==="ERR_FS_FILE_TOO_LARGE"){let n=(void 0)(o),u=[];for await(let s of n)u.push(s);return new Uint8Array(Buffer.concat(u))}throw r}else{let r=await fetch(o);if(!r.ok)throw new Error(`failed to load external data file: ${o}`);let n=r.headers.get("Content-Length"),u=n?parseInt(n,10):0;if(u<1073741824)return new Uint8Array(await r.arrayBuffer());{if(!r.body)throw new Error(`failed to load external data file: ${o}, no response body.`);let s=r.body.getReader(),l;try{l=new ArrayBuffer(u)}catch(p){if(p instanceof RangeError){let h=Math.ceil(u/65536);l=new WebAssembly.Memory({initial:h,maximum:h}).buffer}else throw p}let f=0;for(;;){let{done:p,value:h}=await s.read();if(p)break;let m=h.byteLength;new Uint8Array(l,f,m).set(h),f+=m}return new Uint8Array(l,0,u)}}else return o instanceof Blob?new Uint8Array(await o.arrayBuffer()):o instanceof Uint8Array?o:new Uint8Array(o)}});var to,Kr,Qr,Fe,ro,Ct,en,tn,Zr,rn,nn,on=D(()=>{"use strict";zr();Yr();Pt();xe();nt();Bt();to=(o,r)=>{$()._OrtInit(o,r)!==0&&N("Can't initialize onnxruntime.")},Kr=async o=>{to(o.wasm.numThreads,Xr(o.logLevel))},Qr=async(o,r)=>{},Fe=new Map,ro=o=>{let r=$(),n=r.stackSave();try{let u=r.stackAlloc(8);return r._OrtGetInputOutputCount(o,u,u+4)!==0&&N("Can't get session input/output count."),[r.HEAP32[u/4],r.HEAP32[u/4+1]]}finally{r.stackRestore(n)}},Ct=o=>{let r=$(),n=r._malloc(o.byteLength);if(n===0)throw new Error(`Can't create a session. failed to allocate a buffer of size ${o.byteLength}.`);return r.HEAPU8.set(o,n),[n,o.byteLength]},en=async(o,r)=>{let n,u,s=$();Array.isArray(o)?[n,u]=o:o.buffer===s.HEAPU8.buffer?[n,u]=[o.byteOffset,o.byteLength]:[n,u]=Ct(o);let l=0,f=0,p=0,h=[],m=[],g=[];try{if([f,h]=Gr(r),r?.externalData&&s.mountExternalData){let B=[];for(let C of r.externalData){let H=typeof C=="string"?C:C.path;B.push(Me(typeof C=="string"?C:C.data).then(z=>{s.mountExternalData(H,z)}))}await Promise.all(B)}l=s._OrtCreateSession(n,u,f),l===0&&N("Can't create a session.");let[b,y]=ro(l),E=[],O=[],P=[];for(let B=0;B<b;B++){let C=s._OrtGetInputName(l,B);C===0&&N("Can't get an input name."),m.push(C),E.push(s.UTF8ToString(C))}for(let B=0;B<y;B++){let C=s._OrtGetOutputName(l,B);C===0&&N("Can't get an output name."),g.push(C);let H=s.UTF8ToString(C);O.push(H)}let L=null;return Fe.set(l,[l,m,g,L]),[l,E,O]}catch(b){throw m.forEach(y=>s._OrtFree(y)),g.forEach(y=>s._OrtFree(y)),p!==0&&s._OrtReleaseBinding(p),l!==0&&s._OrtReleaseSession(l),b}finally{s._free(n),f!==0&&s._OrtReleaseSessionOptions(f),h.forEach(b=>s._free(b)),s.unmountExternalData?.()}},tn=o=>{let r=$(),n=Fe.get(o);if(!n)throw new Error(`cannot release session. invalid session id: ${o}`);let[u,s,l,f]=n;f&&r._OrtReleaseBinding(f.handle),r.jsepUnregisterBuffers?.(o),s.forEach(p=>r._OrtFree(p)),l.forEach(p=>r._OrtFree(p)),r._OrtReleaseSession(u),Fe.delete(o)},Zr=(o,r,n,u,s)=>{if(!o){r.push(0);return}let l=$(),f=o[0],p=o[1],h=o[3],m,g;if(f==="string"&&h==="gpu-buffer")throw new Error("String tensor is not supported on GPU.");if(h==="gpu-buffer"){let E=o[2].gpuBuffer,O=It(xt(f));g=p.reduce((P,L)=>P*L,1)*O,m=l.jsepRegisterBuffer(u,s,E,g)}else{let E=o[2];if(Array.isArray(E)){g=4*E.length,m=l._malloc(g),n.push(m);let O=m/4;for(let P=0;P<E.length;P++){if(typeof E[P]!="string")throw new TypeError(`tensor data at index ${P} is not a string`);l.HEAPU32[O++]=j(E[P],n)}}else g=E.byteLength,m=l._malloc(g),n.push(m),l.HEAPU8.set(new Uint8Array(E.buffer,E.byteOffset,g),m)}let b=l.stackSave(),y=l.stackAlloc(4*p.length);try{let E=y/4;p.forEach(P=>l.HEAP32[E++]=P);let O=l._OrtCreateTensor(xt(f),m,g,y,p.length,Jr(h));O===0&&N(`Can't create tensor for input/output. session=${u}, index=${s}.`),r.push(O)}finally{l.stackRestore(b)}},rn=async(o,r,n,u,s,l)=>{let f=$(),p=Fe.get(o);if(!p)throw new Error(`cannot run inference. invalid session id: ${o}`);let[h,m,g,b]=p,y=r.length,E=u.length,O=0,P=[],L=[],B=[],C=[],H=f.stackSave(),z=f.stackAlloc(y*4),M=f.stackAlloc(y*4),oe=f.stackAlloc(E*4),he=f.stackAlloc(E*4);try{[O,P]=Hr(l);for(let _=0;_<y;_++)Zr(n[_],L,C,o,r[_]);for(let _=0;_<E;_++)Zr(s[_],B,C,o,y+u[_]);let v=z/4,R=M/4,ke=oe/4,Ie=he/4;for(let _=0;_<y;_++)f.HEAPU32[v++]=L[_],f.HEAPU32[R++]=m[r[_]];for(let _=0;_<E;_++)f.HEAPU32[ke++]=B[_],f.HEAPU32[Ie++]=g[u[_]];let Pe;Pe=await f._OrtRun(h,M,z,y,he,E,oe,O),Pe!==0&&N("failed to call OrtRun().");let ie=[];for(let _=0;_<E;_++){let se=f.HEAPU32[oe/4+_];if(se===B[_]){ie.push(s[_]);continue}let Ae=f.stackSave(),te=f.stackAlloc(4*4),re=!1,Y,V=0;try{f._OrtGetTensorData(se,te,te+4,te+8,te+12)!==0&&N(`Can't access output tensor data on index ${_}.`);let ye=te/4,ge=f.HEAPU32[ye++];V=f.HEAPU32[ye++];let ce=f.HEAPU32[ye++],Ne=f.HEAPU32[ye++],le=[];for(let q=0;q<Ne;q++)le.push(f.HEAPU32[ce/4+q]);f._OrtFree(ce);let we=le.reduce((q,X)=>q*X,1);Y=Vr(ge);let Be=b?.outputPreferredLocations[u[_]];if(Y==="string"){if(Be==="gpu-buffer")throw new Error("String tensor is not supported on GPU.");let q=[],X=V/4;for(let Ce=0;Ce<we;Ce++){let _e=f.HEAPU32[X++],at=Ce===we-1?void 0:f.HEAPU32[X]-_e;q.push(f.UTF8ToString(_e,at))}ie.push([Y,le,q,"cpu"])}else if(Be==="gpu-buffer"&&we>0){let q=f.jsepGetBuffer(V),X=It(ge);if(X===void 0||!ot(Y))throw new Error(`Unsupported data type: ${Y}`);re=!0,ie.push([Y,le,{gpuBuffer:q,download:f.jsepCreateDownloader(q,we*X,Y),dispose:()=>{f._OrtReleaseTensor(se)}},"gpu-buffer"])}else{let q=qr(Y),X=new q(we);new Uint8Array(X.buffer,X.byteOffset,X.byteLength).set(f.HEAPU8.subarray(V,V+X.byteLength)),ie.push([Y,le,X,"cpu"])}}finally{f.stackRestore(Ae),Y==="string"&&V&&f._free(V),re||f._OrtReleaseTensor(se)}}return b&&f._OrtClearBoundOutputs(b.handle),ie}finally{f.stackRestore(H),L.forEach(v=>f._OrtReleaseTensor(v)),B.forEach(v=>f._OrtReleaseTensor(v)),C.forEach(v=>f._free(v)),O!==0&&f._OrtReleaseRunOptions(O),P.forEach(v=>f._free(v))}},nn=o=>{let r=$(),n=Fe.get(o);if(!n)throw new Error("invalid session id");let u=n[0],s=r._OrtEndProfiling(u);s===0&&N("Can't get an profile file name."),r._OrtFree(s)}});var _t,sn,an,Ai,un,fn,cn,ln,dn,pn,mn,Ut=D(()=>{"use strict";Te();on();xe();_t=!1,sn=!1,an=!1,Ai=typeof document<"u"?document?.currentScript?.src:void 0,un=async()=>{if(!sn){if(_t)throw new Error("multiple calls to 'initWasm()' detected.");if(an)throw new Error("previous call to 'initWasm()' failed.");_t=!0;try{await jr(F.wasm),await Kr(F),sn=!0}catch(o){throw an=!0,o}finally{_t=!1}}},fn=async o=>{await Qr(F,o)},cn=async o=>Ct(o),ln=async(o,r)=>en(o,r),dn=async o=>{tn(o)},pn=async(o,r,n,u,s,l)=>rn(o,r,n,u,s,l),mn=async o=>{nn(o)}});var hn,oo,it,yn=D(()=>{"use strict";Te();Ut();Pt();Bt();hn=(o,r)=>{switch(o.location){case"cpu":return[o.type,o.dims,o.data,"cpu"];case"gpu-buffer":return[o.type,o.dims,{gpuBuffer:o.gpuBuffer},"gpu-buffer"];default:throw new Error(`invalid data location: ${o.location} for ${r()}`)}},oo=o=>{switch(o[3]){case"cpu":return new G(o[0],o[2],o[1]);case"gpu-buffer":{let r=o[0];if(!ot(r))throw new Error(`not supported data type: ${r} for deserializing GPU tensor`);let{gpuBuffer:n,download:u,dispose:s}=o[2];return G.fromGpuBuffer(n,{dataType:r,dims:o[1],download:u,dispose:s})}default:throw new Error(`invalid data location: ${o[3]}`)}},it=class{async fetchModelAndCopyToWasmMemory(r){return cn(await Me(r))}async loadModel(r,n){pe();let u;typeof r=="string"?typeof process<"u"&&process.versions&&process.versions.node?u=await Me(r):u=await this.fetchModelAndCopyToWasmMemory(r):u=r,[this.sessionId,this.inputNames,this.outputNames]=await ln(u,n),me()}async dispose(){return dn(this.sessionId)}async run(r,n,u){pe();let s=[],l=[];Object.entries(r).forEach(y=>{let E=y[0],O=y[1],P=this.inputNames.indexOf(E);if(P===-1)throw new Error(`invalid input '${E}'`);s.push(O),l.push(P)});let f=[],p=[];Object.entries(n).forEach(y=>{let E=y[0],O=y[1],P=this.outputNames.indexOf(E);if(P===-1)throw new Error(`invalid output '${E}'`);f.push(O),p.push(P)});let h=s.map((y,E)=>hn(y,()=>`input "${this.inputNames[l[E]]}"`)),m=f.map((y,E)=>y?hn(y,()=>`output "${this.outputNames[p[E]]}"`):null),g=await pn(this.sessionId,l,h,p,m,u),b={};for(let y=0;y<g.length;y++)b[this.outputNames[p[y]]]=f[y]??oo(g[y]);return me(),b}startProfiling(){}endProfiling(){mn(this.sessionId)}}});var io,st,gn=D(()=>{"use strict";Te();Ut();yn();io=()=>{if((typeof F.wasm.initTimeout!="number"||F.wasm.initTimeout<0)&&(F.wasm.initTimeout=0),typeof F.wasm.simd!="boolean"&&(F.wasm.simd=!0),typeof F.wasm.proxy!="boolean"&&(F.wasm.proxy=!1),typeof F.wasm.trace!="boolean"&&(F.wasm.trace=!1),typeof F.wasm.numThreads!="number"||!Number.isInteger(F.wasm.numThreads)||F.wasm.numThreads<=0){(typeof self<"u"&&!self.crossOriginIsolated||typeof process<"u"&&process.versions&&process.versions.node)&&(F.wasm.numThreads=1);let o=typeof navigator>"u"?(void 0)().length:navigator.hardwareConcurrency;F.wasm.numThreads=Math.min(4,Math.ceil((o||1)/2))}},st=class{async init(r){io(),await un(),await fn(r)}async createInferenceSessionHandler(r,n){let u=new it;return await u.loadModel(r,n),Promise.resolve(u)}}});var wn={};De(wn,{wasmBackend:()=>so});var so,bn=D(()=>{"use strict";gn();so=new st});var uo={};De(uo,{InferenceSession:()=>xr,TRACE:()=>bt,TRACE_FUNC_BEGIN:()=>pe,TRACE_FUNC_END:()=>me,Tensor:()=>G,TrainingSession:()=>Cr,default:()=>ao,env:()=>F,registerBackend:()=>Oe});Te();Te();Te();var Ur="1.18.0";var ao=vt;{let o=(bn(),Ve(wn)).wasmBackend;Oe("cpu",o,10),Oe("wasm",o,10)}Object.defineProperty(F.versions,"web",{value:Ur,enumerable:!0});return Ve(uo);})();
//# sourceMappingURL=ort.wasm-core.min.js.map
